{"version":3,"file":"vendors-node_modules_datadog_browser-logs_esm_entries_main_js-node_modules_launchdarkly-js-cl-243fa6.06dc96080028658d4f53.js","mappings":"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","sources":["webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/boot/init.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/browser/addEventListener.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/browser/cookie.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/browser/fetchObservable.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/browser/pageExitObservable.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/browser/xhrObservable.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/configuration/configuration.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/configuration/endpointBuilder.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/configuration/intakeSites.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/configuration/tags.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/configuration/transportConfiguration.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/console/consoleObservable.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/context/contextManager.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/context/heavyCustomerDataWarning.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/context/storedContextManager.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/error/error.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/error/error.types.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/error/trackRuntimeError.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/eventRateLimiter/createEventRateLimiter.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/report/reportObservable.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/oldCookiesMigration.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/sessionConstants.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/sessionManager.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/sessionState.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/sessionStore.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/sessionStoreOperations.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/storeStrategies/sessionInCookie.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/storeStrategies/sessionInLocalStorage.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/session/storeStrategies/sessionStoreStrategy.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/synthetics/syntheticsWorkerValues.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/telemetry/rawTelemetryEvent.types.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/telemetry/telemetry.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/tracekit/computeStackTrace.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/tracekit/tracekit.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/domain/user/user.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/abstractLifeCycle.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/boundedBuffer.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/catchUserErrors.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/display.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/experimentalFeatures.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/getGlobalObject.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/getZoneJsOriginalValue.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/instrumentMethod.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/mergeInto.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/monitor.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/observable.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/readBytesFromStream.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/sendToExtension.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/serialisation/jsonStringify.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/serialisation/sanitize.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/timer.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/arrayUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/browserDetection.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/byteUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/functionUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/numberUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/objectUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/polyfills.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/responseUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/stringUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/timeUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/typeUtils.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/utils/urlPolyfill.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/tools/valueHistory.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/transport/batch.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/transport/eventBridge.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/transport/flushController.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/transport/httpRequest.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/transport/sendWithRetryStrategy.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-core/src/transport/startBatchWithReplica.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/boot/logsPublicApi.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/boot/startLogs.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/assembly.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/configuration.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/console/consoleCollection.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/internalContext.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/lifeCycle.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/logger.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/logger/loggerCollection.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/logsSessionManager.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/networkError/networkErrorCollection.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/report/reportCollection.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/domain/runtimeError/runtimeErrorCollection.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/entries/main.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/transport/startLogsBatch.ts","webpack://@anaconda/toolbox/../../node_modules/@datadog/browser-logs/src/transport/startLogsBridge.ts","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/errors.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/base64-js/index.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/fast-deep-equal/index.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/utils.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/rng.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/regex.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/validate.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/stringify.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/v1.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/parse.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/v35.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/md5.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/v3.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/sha1.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/v5.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/v4.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/nil.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/uuid/dist/esm-browser/version.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/loggers.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/messages.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/configuration.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/headers.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/EventSender.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/context.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/EventSummarizer.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/attributeReference.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/ContextFilter.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/EventProcessor.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/EventEmitter.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/InitializationState.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/PersistentFlagStore.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/PersistentStorage.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/Stream.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/promiseCoalescer.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/Requestor.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/Identity.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/AnonymousContextProcessor.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/diagnosticEvents.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/SafeInspector.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/InspectorManager.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/timedPromise.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/launchdarkly-js-sdk-common/src/index.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/src/basicLogger.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/src/httpRequest.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/node_modules/escape-string-regexp/index.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/src/GoalTracker.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/src/GoalManager.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/src/index.js","webpack://@anaconda/toolbox/../../node_modules/launchdarkly-js-client-sdk/src/browserPlatform.js","webpack://@anaconda/toolbox/../../node_modules/reactjs-heap/src/heap.ts"],"sourcesContent":["import { catchUserErrors } from '../tools/catchUserErrors'\nimport { setDebugMode } from '../tools/monitor'\nimport { assign } from '../tools/utils/polyfills'\n\n// replaced at build time\ndeclare const __BUILD_ENV__SDK_VERSION__: string\n\nexport function makePublicApi<T>(stub: T): T & { onReady(callback: () => void): void; version: string } {\n  const publicApi = assign(\n    {\n      version: __BUILD_ENV__SDK_VERSION__,\n\n      // This API method is intentionally not monitored, since the only thing executed is the\n      // user-provided 'callback'.  All SDK usages executed in the callback should be monitored, and\n      // we don't want to interfere with the user uncaught exceptions.\n      onReady(callback: () => void) {\n        callback()\n      },\n    },\n    stub\n  )\n\n  // Add a \"hidden\" property to set debug mode. We define it that way to hide it\n  // as much as possible but of course it's not a real protection.\n  Object.defineProperty(publicApi, '_setDebug', {\n    get() {\n      return setDebugMode\n    },\n    enumerable: false,\n  })\n\n  return publicApi\n}\n\nexport function defineGlobal<Global, Name extends keyof Global>(global: Global, name: Name, api: Global[Name]) {\n  const existingGlobalVariable = global[name] as { q?: Array<() => void> } | undefined\n  global[name] = api\n  if (existingGlobalVariable && existingGlobalVariable.q) {\n    existingGlobalVariable.q.forEach((fn) => catchUserErrors(fn, 'onReady callback threw an error:')())\n  }\n}\n","import { monitor } from '../tools/monitor'\nimport { getZoneJsOriginalValue } from '../tools/getZoneJsOriginalValue'\nimport type { Configuration } from '../domain/configuration'\nimport type { VisualViewport, VisualViewportEventMap } from './types'\n\nexport const enum DOM_EVENT {\n  BEFORE_UNLOAD = 'beforeunload',\n  CLICK = 'click',\n  DBL_CLICK = 'dblclick',\n  KEY_DOWN = 'keydown',\n  LOAD = 'load',\n  POP_STATE = 'popstate',\n  SCROLL = 'scroll',\n  TOUCH_START = 'touchstart',\n  TOUCH_END = 'touchend',\n  TOUCH_MOVE = 'touchmove',\n  VISIBILITY_CHANGE = 'visibilitychange',\n  PAGE_SHOW = 'pageshow',\n  FREEZE = 'freeze',\n  RESUME = 'resume',\n  DOM_CONTENT_LOADED = 'DOMContentLoaded',\n  POINTER_DOWN = 'pointerdown',\n  POINTER_UP = 'pointerup',\n  POINTER_CANCEL = 'pointercancel',\n  HASH_CHANGE = 'hashchange',\n  PAGE_HIDE = 'pagehide',\n  MOUSE_DOWN = 'mousedown',\n  MOUSE_UP = 'mouseup',\n  MOUSE_MOVE = 'mousemove',\n  FOCUS = 'focus',\n  BLUR = 'blur',\n  CONTEXT_MENU = 'contextmenu',\n  RESIZE = 'resize',\n  CHANGE = 'change',\n  INPUT = 'input',\n  PLAY = 'play',\n  PAUSE = 'pause',\n  SECURITY_POLICY_VIOLATION = 'securitypolicyviolation',\n  SELECTION_CHANGE = 'selectionchange',\n  STORAGE = 'storage',\n}\n\ninterface AddEventListenerOptions {\n  once?: boolean\n  capture?: boolean\n  passive?: boolean\n}\n\ntype EventMapFor<T> = T extends Window\n  ? WindowEventMap & {\n      // TS 4.9.5 does not support `freeze` and `resume` events yet\n      freeze: Event\n      resume: Event\n      // TS 4.9.5 does not define `visibilitychange` on Window (only Document)\n      visibilitychange: Event\n    }\n  : T extends Document\n  ? DocumentEventMap\n  : T extends HTMLElement\n  ? HTMLElementEventMap\n  : T extends VisualViewport\n  ? VisualViewportEventMap\n  : T extends ShadowRoot\n  ? // ShadowRootEventMap is not yet defined in our supported TS version. Instead, use\n    // GlobalEventHandlersEventMap which is more than enough as we only need to listen for events bubbling\n    // through the ShadowRoot like \"change\" or \"input\"\n    GlobalEventHandlersEventMap\n  : T extends XMLHttpRequest\n  ? XMLHttpRequestEventMap\n  : T extends Performance\n  ? PerformanceEventMap\n  : T extends Worker\n  ? WorkerEventMap\n  : Record<never, never>\n\n/**\n * Add an event listener to an event target object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n */\nexport function addEventListener<Target extends EventTarget, EventName extends keyof EventMapFor<Target> & string>(\n  configuration: Configuration,\n  eventTarget: Target,\n  eventName: EventName,\n  listener: (event: EventMapFor<Target>[EventName] & { type: EventName }) => void,\n  options?: AddEventListenerOptions\n) {\n  return addEventListeners(configuration, eventTarget, [eventName], listener, options)\n}\n\n/**\n * Add event listeners to an event target object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n *\n * * with `once: true`, the listener will be called at most once, even if different events are listened\n */\nexport function addEventListeners<Target extends EventTarget, EventName extends keyof EventMapFor<Target> & string>(\n  _: Configuration,\n  eventTarget: Target,\n  eventNames: EventName[],\n  listener: (event: EventMapFor<Target>[EventName] & { type: EventName }) => void,\n  { once, capture, passive }: AddEventListenerOptions = {}\n) {\n  const listenerWithMonitor = monitor(\n    once\n      ? (event: Event) => {\n          stop()\n          listener(event as unknown as EventMapFor<Target>[EventName] & { type: EventName })\n        }\n      : (listener as unknown as (event: Event) => void)\n  )\n\n  const options = passive ? { capture, passive } : capture\n\n  const add = getZoneJsOriginalValue(eventTarget, 'addEventListener')\n  eventNames.forEach((eventName) => add.call(eventTarget, eventName, listenerWithMonitor, options))\n\n  function stop() {\n    const remove = getZoneJsOriginalValue(eventTarget, 'removeEventListener')\n    eventNames.forEach((eventName) => remove.call(eventTarget, eventName, listenerWithMonitor, options))\n  }\n\n  return {\n    stop,\n  }\n}\n","import { display } from '../tools/display'\nimport { ONE_MINUTE, ONE_SECOND } from '../tools/utils/timeUtils'\nimport { findCommaSeparatedValue, generateUUID } from '../tools/utils/stringUtils'\n\nexport interface CookieOptions {\n  secure?: boolean\n  crossSite?: boolean\n  domain?: string\n}\n\nexport function setCookie(name: string, value: string, expireDelay: number, options?: CookieOptions) {\n  const date = new Date()\n  date.setTime(date.getTime() + expireDelay)\n  const expires = `expires=${date.toUTCString()}`\n  const sameSite = options && options.crossSite ? 'none' : 'strict'\n  const domain = options && options.domain ? `;domain=${options.domain}` : ''\n  const secure = options && options.secure ? ';secure' : ''\n  document.cookie = `${name}=${value};${expires};path=/;samesite=${sameSite}${domain}${secure}`\n}\n\nexport function getCookie(name: string) {\n  return findCommaSeparatedValue(document.cookie, name)\n}\n\nexport function deleteCookie(name: string, options?: CookieOptions) {\n  setCookie(name, '', 0, options)\n}\n\nexport function areCookiesAuthorized(options: CookieOptions): boolean {\n  if (document.cookie === undefined || document.cookie === null) {\n    return false\n  }\n  try {\n    // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n    // the test cookie lifetime\n    const testCookieName = `dd_cookie_test_${generateUUID()}`\n    const testCookieValue = 'test'\n    setCookie(testCookieName, testCookieValue, ONE_MINUTE, options)\n    const isCookieCorrectlySet = getCookie(testCookieName) === testCookieValue\n    deleteCookie(testCookieName, options)\n    return isCookieCorrectlySet\n  } catch (error) {\n    display.error(error)\n    return false\n  }\n}\n\n/**\n * No API to retrieve it, number of levels for subdomain and suffix are unknown\n * strategy: find the minimal domain on which cookies are allowed to be set\n * https://web.dev/same-site-same-origin/#site\n */\nlet getCurrentSiteCache: string | undefined\nexport function getCurrentSite() {\n  if (getCurrentSiteCache === undefined) {\n    // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n    // the test cookie lifetime\n    const testCookieName = `dd_site_test_${generateUUID()}`\n    const testCookieValue = 'test'\n\n    const domainLevels = window.location.hostname.split('.')\n    let candidateDomain = domainLevels.pop()!\n    while (domainLevels.length && !getCookie(testCookieName)) {\n      candidateDomain = `${domainLevels.pop()!}.${candidateDomain}`\n      setCookie(testCookieName, testCookieValue, ONE_SECOND, { domain: candidateDomain })\n    }\n    deleteCookie(testCookieName, { domain: candidateDomain })\n    getCurrentSiteCache = candidateDomain\n  }\n  return getCurrentSiteCache\n}\n","import { instrumentMethod } from '../tools/instrumentMethod'\nimport { callMonitored, monitor } from '../tools/monitor'\nimport { Observable } from '../tools/observable'\nimport type { ClocksState } from '../tools/utils/timeUtils'\nimport { clocksNow } from '../tools/utils/timeUtils'\nimport { normalizeUrl } from '../tools/utils/urlPolyfill'\n\ninterface FetchContextBase {\n  method: string\n  startClocks: ClocksState\n  input: unknown\n  init?: RequestInit\n  url: string\n}\n\nexport interface FetchStartContext extends FetchContextBase {\n  state: 'start'\n}\n\nexport interface FetchResolveContext extends FetchContextBase {\n  state: 'resolve'\n  status: number\n  response?: Response\n  responseType?: string\n  isAborted: boolean\n  error?: Error\n}\n\nexport type FetchContext = FetchStartContext | FetchResolveContext\n\nlet fetchObservable: Observable<FetchContext> | undefined\n\nexport function initFetchObservable() {\n  if (!fetchObservable) {\n    fetchObservable = createFetchObservable()\n  }\n  return fetchObservable\n}\n\nfunction createFetchObservable() {\n  const observable = new Observable<FetchContext>(() => {\n    if (!window.fetch) {\n      return\n    }\n\n    const { stop } = instrumentMethod(\n      window,\n      'fetch',\n      (originalFetch) =>\n        function (input, init) {\n          let responsePromise: Promise<Response>\n\n          const context = callMonitored(beforeSend, null, [observable, input, init])\n          if (context) {\n            responsePromise = originalFetch.call(this, context.input as RequestInfo, context.init)\n            callMonitored(afterSend, null, [observable, responsePromise, context])\n          } else {\n            responsePromise = originalFetch.call(this, input, init)\n          }\n\n          return responsePromise\n        }\n    )\n\n    return stop\n  })\n\n  return observable\n}\n\nfunction beforeSend(observable: Observable<FetchContext>, input: unknown, init?: RequestInit) {\n  const method = (init && init.method) || (input instanceof Request && input.method) || 'GET'\n  const url = input instanceof Request ? input.url : normalizeUrl(String(input))\n  const startClocks = clocksNow()\n\n  const context: FetchStartContext = {\n    state: 'start',\n    init,\n    input,\n    method,\n    startClocks,\n    url,\n  }\n\n  observable.notify(context)\n\n  return context\n}\n\nfunction afterSend(\n  observable: Observable<FetchContext>,\n  responsePromise: Promise<Response>,\n  startContext: FetchStartContext\n) {\n  const reportFetch = (response: Response | Error) => {\n    const context = startContext as unknown as FetchResolveContext\n    context.state = 'resolve'\n    if ('stack' in response || response instanceof Error) {\n      context.status = 0\n      context.isAborted = response instanceof DOMException && response.code === DOMException.ABORT_ERR\n      context.error = response\n    } else if ('status' in response) {\n      context.response = response\n      context.responseType = response.type\n      context.status = response.status\n      context.isAborted = false\n    }\n    observable.notify(context)\n  }\n\n  responsePromise.then(monitor(reportFetch), monitor(reportFetch))\n}\n","import { isExperimentalFeatureEnabled, ExperimentalFeature } from '../tools/experimentalFeatures'\nimport { Observable } from '../tools/observable'\nimport { objectValues, includes } from '../tools/utils/polyfills'\nimport { noop } from '../tools/utils/functionUtils'\nimport type { Configuration } from '../domain/configuration'\nimport { addEventListeners, addEventListener, DOM_EVENT } from './addEventListener'\n\nexport const PageExitReason = {\n  HIDDEN: 'visibility_hidden',\n  UNLOADING: 'before_unload',\n  PAGEHIDE: 'page_hide',\n  FROZEN: 'page_frozen',\n} as const\n\nexport type PageExitReason = (typeof PageExitReason)[keyof typeof PageExitReason]\n\nexport interface PageExitEvent {\n  reason: PageExitReason\n}\n\nexport function createPageExitObservable(configuration: Configuration): Observable<PageExitEvent> {\n  const observable = new Observable<PageExitEvent>(() => {\n    const pagehideEnabled = isExperimentalFeatureEnabled(ExperimentalFeature.PAGEHIDE)\n    const { stop: stopListeners } = addEventListeners(\n      configuration,\n      window,\n      [DOM_EVENT.VISIBILITY_CHANGE, DOM_EVENT.FREEZE, DOM_EVENT.PAGE_HIDE],\n      (event) => {\n        if (event.type === DOM_EVENT.PAGE_HIDE && pagehideEnabled) {\n          /**\n           * Only event that detect page unload events while being compatible with the back/forward cache (bfcache)\n           */\n          observable.notify({ reason: PageExitReason.PAGEHIDE })\n        } else if (event.type === DOM_EVENT.VISIBILITY_CHANGE && document.visibilityState === 'hidden') {\n          /**\n           * Only event that guarantee to fire on mobile devices when the page transitions to background state\n           * (e.g. when user switches to a different application, goes to homescreen, etc), or is being unloaded.\n           */\n          observable.notify({ reason: PageExitReason.HIDDEN })\n        } else if (event.type === DOM_EVENT.FREEZE) {\n          /**\n           * After transitioning in background a tab can be freezed to preserve resources. (cf: https://developer.chrome.com/blog/page-lifecycle-api)\n           * Allow to collect events happening between hidden and frozen state.\n           */\n          observable.notify({ reason: PageExitReason.FROZEN })\n        }\n      },\n      { capture: true }\n    )\n\n    let stopBeforeUnloadListener = noop\n    if (!pagehideEnabled) {\n      stopBeforeUnloadListener = addEventListener(configuration, window, DOM_EVENT.BEFORE_UNLOAD, () => {\n        observable.notify({ reason: PageExitReason.UNLOADING })\n      }).stop\n    }\n\n    return () => {\n      stopListeners()\n      stopBeforeUnloadListener()\n    }\n  })\n\n  return observable\n}\n\nexport function isPageExitReason(reason: string | undefined): reason is PageExitReason {\n  return includes(objectValues(PageExitReason), reason)\n}\n","import { instrumentMethodAndCallOriginal } from '../tools/instrumentMethod'\nimport { Observable } from '../tools/observable'\nimport type { Duration, RelativeTime, ClocksState } from '../tools/utils/timeUtils'\nimport { elapsed, relativeNow, clocksNow, timeStampNow } from '../tools/utils/timeUtils'\nimport { normalizeUrl } from '../tools/utils/urlPolyfill'\nimport { shallowClone } from '../tools/utils/objectUtils'\nimport type { Configuration } from '../domain/configuration'\nimport { addEventListener } from './addEventListener'\n\nexport interface XhrOpenContext {\n  state: 'open'\n  method: string\n  url: string\n}\n\nexport interface XhrStartContext extends Omit<XhrOpenContext, 'state'> {\n  state: 'start'\n  startTime: RelativeTime // deprecated\n  startClocks: ClocksState\n  isAborted: boolean\n  xhr: XMLHttpRequest\n}\n\nexport interface XhrCompleteContext extends Omit<XhrStartContext, 'state'> {\n  state: 'complete'\n  duration: Duration\n  status: number\n}\n\nexport type XhrContext = XhrOpenContext | XhrStartContext | XhrCompleteContext\n\nlet xhrObservable: Observable<XhrContext> | undefined\nconst xhrContexts = new WeakMap<XMLHttpRequest, XhrContext>()\n\nexport function initXhrObservable(configuration: Configuration) {\n  if (!xhrObservable) {\n    xhrObservable = createXhrObservable(configuration)\n  }\n  return xhrObservable\n}\n\nfunction createXhrObservable(configuration: Configuration) {\n  const observable = new Observable<XhrContext>(() => {\n    const { stop: stopInstrumentingStart } = instrumentMethodAndCallOriginal(XMLHttpRequest.prototype, 'open', {\n      before: openXhr,\n    })\n\n    const { stop: stopInstrumentingSend } = instrumentMethodAndCallOriginal(XMLHttpRequest.prototype, 'send', {\n      before() {\n        sendXhr.call(this, configuration, observable)\n      },\n    })\n\n    const { stop: stopInstrumentingAbort } = instrumentMethodAndCallOriginal(XMLHttpRequest.prototype, 'abort', {\n      before: abortXhr,\n    })\n\n    return () => {\n      stopInstrumentingStart()\n      stopInstrumentingSend()\n      stopInstrumentingAbort()\n    }\n  })\n  return observable\n}\n\nfunction openXhr(this: XMLHttpRequest, method: string, url: string | URL | undefined | null) {\n  xhrContexts.set(this, {\n    state: 'open',\n    method,\n    url: normalizeUrl(String(url)),\n  })\n}\n\nfunction sendXhr(this: XMLHttpRequest, configuration: Configuration, observable: Observable<XhrContext>) {\n  const context = xhrContexts.get(this)\n  if (!context) {\n    return\n  }\n\n  const startContext = context as XhrStartContext\n  startContext.state = 'start'\n  startContext.startTime = relativeNow()\n  startContext.startClocks = clocksNow()\n  startContext.isAborted = false\n  startContext.xhr = this\n\n  let hasBeenReported = false\n\n  const { stop: stopInstrumentingOnReadyStateChange } = instrumentMethodAndCallOriginal(this, 'onreadystatechange', {\n    before() {\n      if (this.readyState === XMLHttpRequest.DONE) {\n        // Try to report the XHR as soon as possible, because the XHR may be mutated by the\n        // application during a future event. For example, Angular is calling .abort() on\n        // completed requests during a onreadystatechange event, so the status becomes '0'\n        // before the request is collected.\n        onEnd()\n      }\n    },\n  })\n\n  const onEnd = () => {\n    unsubscribeLoadEndListener()\n    stopInstrumentingOnReadyStateChange()\n    if (hasBeenReported) {\n      return\n    }\n    hasBeenReported = true\n\n    const completeContext = context as XhrCompleteContext\n    completeContext.state = 'complete'\n    completeContext.duration = elapsed(startContext.startClocks.timeStamp, timeStampNow())\n    completeContext.status = this.status\n    observable.notify(shallowClone(completeContext))\n  }\n\n  const { stop: unsubscribeLoadEndListener } = addEventListener(configuration, this, 'loadend', onEnd)\n\n  observable.notify(startContext)\n}\n\nfunction abortXhr(this: XMLHttpRequest) {\n  const context = xhrContexts.get(this) as XhrStartContext | undefined\n  if (context) {\n    context.isAborted = true\n  }\n}\n","import { catchUserErrors } from '../../tools/catchUserErrors'\nimport { display } from '../../tools/display'\nimport type { RawTelemetryConfiguration } from '../telemetry'\nimport { ExperimentalFeature, addExperimentalFeatures } from '../../tools/experimentalFeatures'\nimport type { Duration } from '../../tools/utils/timeUtils'\nimport { ONE_SECOND } from '../../tools/utils/timeUtils'\nimport { isPercentage } from '../../tools/utils/numberUtils'\nimport { ONE_KIBI_BYTE } from '../../tools/utils/byteUtils'\nimport { objectHasValue } from '../../tools/utils/objectUtils'\nimport { assign } from '../../tools/utils/polyfills'\nimport { selectSessionStoreStrategyType } from '../session/sessionStore'\nimport type { SessionStoreStrategyType } from '../session/storeStrategies/sessionStoreStrategy'\nimport type { TransportConfiguration } from './transportConfiguration'\nimport { computeTransportConfiguration } from './transportConfiguration'\n\nexport const DefaultPrivacyLevel = {\n  ALLOW: 'allow',\n  MASK: 'mask',\n  MASK_USER_INPUT: 'mask-user-input',\n} as const\nexport type DefaultPrivacyLevel = (typeof DefaultPrivacyLevel)[keyof typeof DefaultPrivacyLevel]\n\nexport interface InitConfiguration {\n  // global options\n  clientToken: string\n  beforeSend?: GenericBeforeSendCallback | undefined\n  /**\n   * @deprecated use sessionSampleRate instead\n   */\n  sampleRate?: number | undefined\n  sessionSampleRate?: number | undefined\n  telemetrySampleRate?: number | undefined\n  silentMultipleInit?: boolean | undefined\n  trackResources?: boolean | undefined\n  trackLongTasks?: boolean | undefined\n  storeContextsAcrossPages?: boolean | undefined\n\n  // transport options\n  proxy?: string | undefined\n  /**\n   * @deprecated use `proxy` instead\n   */\n  proxyUrl?: string | undefined\n  site?: string | undefined\n\n  // tag and context options\n  service?: string | undefined\n  env?: string | undefined\n  version?: string | undefined\n\n  // cookie options\n  useCrossSiteSessionCookie?: boolean | undefined\n  useSecureSessionCookie?: boolean | undefined\n  trackSessionAcrossSubdomains?: boolean | undefined\n\n  // alternate storage option\n  allowFallbackToLocalStorage?: boolean | undefined\n\n  // internal options\n  enableExperimentalFeatures?: string[] | undefined\n  replica?: ReplicaUserConfiguration | undefined\n  datacenter?: string\n  internalAnalyticsSubdomain?: string\n\n  telemetryConfigurationSampleRate?: number\n}\n\n// This type is only used to build the core configuration. Logs and RUM SDKs are using a proper type\n// for this option.\ntype GenericBeforeSendCallback = (event: any, context?: any) => unknown\n\ninterface ReplicaUserConfiguration {\n  applicationId?: string\n  clientToken: string\n}\n\nexport interface Configuration extends TransportConfiguration {\n  // Built from init configuration\n  beforeSend: GenericBeforeSendCallback | undefined\n  sessionStoreStrategyType: SessionStoreStrategyType | undefined\n  sessionSampleRate: number\n  telemetrySampleRate: number\n  telemetryConfigurationSampleRate: number\n  service: string | undefined\n  silentMultipleInit: boolean\n\n  // Event limits\n  eventRateLimiterThreshold: number // Limit the maximum number of actions, errors and logs per minutes\n  maxTelemetryEventsPerPage: number\n\n  // Batch configuration\n  batchBytesLimit: number\n  flushTimeout: Duration\n  batchMessagesLimit: number\n  messageBytesLimit: number\n}\n\nexport function validateAndBuildConfiguration(initConfiguration: InitConfiguration): Configuration | undefined {\n  if (!initConfiguration || !initConfiguration.clientToken) {\n    display.error('Client Token is not configured, we will not send any data.')\n    return\n  }\n\n  const sessionSampleRate = initConfiguration.sessionSampleRate ?? initConfiguration.sampleRate\n  if (sessionSampleRate !== undefined && !isPercentage(sessionSampleRate)) {\n    display.error('Session Sample Rate should be a number between 0 and 100')\n    return\n  }\n\n  if (initConfiguration.telemetrySampleRate !== undefined && !isPercentage(initConfiguration.telemetrySampleRate)) {\n    display.error('Telemetry Sample Rate should be a number between 0 and 100')\n    return\n  }\n\n  if (\n    initConfiguration.telemetryConfigurationSampleRate !== undefined &&\n    !isPercentage(initConfiguration.telemetryConfigurationSampleRate)\n  ) {\n    display.error('Telemetry Configuration Sample Rate should be a number between 0 and 100')\n    return\n  }\n\n  // Set the experimental feature flags as early as possible, so we can use them in most places\n  if (Array.isArray(initConfiguration.enableExperimentalFeatures)) {\n    addExperimentalFeatures(\n      initConfiguration.enableExperimentalFeatures.filter((flag): flag is ExperimentalFeature =>\n        objectHasValue(ExperimentalFeature, flag)\n      )\n    )\n  }\n\n  return assign(\n    {\n      beforeSend:\n        initConfiguration.beforeSend && catchUserErrors(initConfiguration.beforeSend, 'beforeSend threw an error:'),\n      sessionStoreStrategyType: selectSessionStoreStrategyType(initConfiguration),\n      sessionSampleRate: sessionSampleRate ?? 100,\n      telemetrySampleRate: initConfiguration.telemetrySampleRate ?? 20,\n      telemetryConfigurationSampleRate: initConfiguration.telemetryConfigurationSampleRate ?? 5,\n      service: initConfiguration.service,\n      silentMultipleInit: !!initConfiguration.silentMultipleInit,\n\n      /**\n       * beacon payload max queue size implementation is 64kb\n       * ensure that we leave room for logs, rum and potential other users\n       */\n      batchBytesLimit: 16 * ONE_KIBI_BYTE,\n\n      eventRateLimiterThreshold: 3000,\n      maxTelemetryEventsPerPage: 15,\n\n      /**\n       * flush automatically, aim to be lower than ALB connection timeout\n       * to maximize connection reuse.\n       */\n      flushTimeout: (30 * ONE_SECOND) as Duration,\n\n      /**\n       * Logs intake limit\n       */\n      batchMessagesLimit: 50,\n      messageBytesLimit: 256 * ONE_KIBI_BYTE,\n    },\n    computeTransportConfiguration(initConfiguration)\n  )\n}\n\nexport function serializeConfiguration(initConfiguration: InitConfiguration): Partial<RawTelemetryConfiguration> {\n  const proxy = initConfiguration.proxy ?? initConfiguration.proxyUrl\n  return {\n    session_sample_rate: initConfiguration.sessionSampleRate ?? initConfiguration.sampleRate,\n    telemetry_sample_rate: initConfiguration.telemetrySampleRate,\n    telemetry_configuration_sample_rate: initConfiguration.telemetryConfigurationSampleRate,\n    use_before_send: !!initConfiguration.beforeSend,\n    use_cross_site_session_cookie: initConfiguration.useCrossSiteSessionCookie,\n    use_secure_session_cookie: initConfiguration.useSecureSessionCookie,\n    use_proxy: proxy !== undefined ? !!proxy : undefined,\n    silent_multiple_init: initConfiguration.silentMultipleInit,\n    track_session_across_subdomains: initConfiguration.trackSessionAcrossSubdomains,\n    track_resources: initConfiguration.trackResources,\n    track_long_task: initConfiguration.trackLongTasks,\n    allow_fallback_to_local_storage: !!initConfiguration.allowFallbackToLocalStorage,\n    store_contexts_across_pages: !!initConfiguration.storeContextsAcrossPages,\n  }\n}\n","import type { Payload } from '../../transport'\nimport { timeStampNow } from '../../tools/utils/timeUtils'\nimport { normalizeUrl } from '../../tools/utils/urlPolyfill'\nimport { ExperimentalFeature, isExperimentalFeatureEnabled } from '../../tools/experimentalFeatures'\nimport { generateUUID } from '../../tools/utils/stringUtils'\nimport type { InitConfiguration } from './configuration'\nimport { INTAKE_SITE_AP1, INTAKE_SITE_US1 } from './intakeSites'\n\n// replaced at build time\ndeclare const __BUILD_ENV__SDK_VERSION__: string\n\nexport const ENDPOINTS = {\n  logs: 'logs',\n  rum: 'rum',\n  sessionReplay: 'session-replay',\n} as const\n\nconst INTAKE_TRACKS = {\n  logs: 'logs',\n  rum: 'rum',\n  sessionReplay: 'replay',\n}\n\nexport type EndpointType = keyof typeof ENDPOINTS\n\nexport type EndpointBuilder = ReturnType<typeof createEndpointBuilder>\n\nexport function createEndpointBuilder(\n  initConfiguration: InitConfiguration,\n  endpointType: EndpointType,\n  configurationTags: string[]\n) {\n  const buildUrlWithParameters = createEndpointUrlWithParametersBuilder(initConfiguration, endpointType)\n\n  return {\n    build(api: 'xhr' | 'fetch' | 'beacon', payload: Payload) {\n      const parameters = buildEndpointParameters(initConfiguration, endpointType, configurationTags, api, payload)\n      return buildUrlWithParameters(parameters)\n    },\n    urlPrefix: buildUrlWithParameters(''),\n    endpointType,\n  }\n}\n\n/**\n * Create a function used to build a full endpoint url from provided parameters. The goal of this\n * function is to pre-compute some parts of the URL to avoid re-computing everything on every\n * request, as only parameters are changing.\n */\nfunction createEndpointUrlWithParametersBuilder(\n  initConfiguration: InitConfiguration,\n  endpointType: EndpointType\n): (parameters: string) => string {\n  const path = `/api/v2/${INTAKE_TRACKS[endpointType]}`\n\n  const { proxy, proxyUrl } = initConfiguration\n  if (proxy) {\n    const normalizedProxyUrl = normalizeUrl(proxy)\n    return (parameters) => `${normalizedProxyUrl}?ddforward=${encodeURIComponent(`${path}?${parameters}`)}`\n  }\n\n  const host = buildEndpointHost(initConfiguration, endpointType)\n\n  if (proxy === undefined && proxyUrl) {\n    // TODO: remove this in a future major.\n    const normalizedProxyUrl = normalizeUrl(proxyUrl)\n    return (parameters) =>\n      `${normalizedProxyUrl}?ddforward=${encodeURIComponent(`https://${host}${path}?${parameters}`)}`\n  }\n\n  return (parameters) => `https://${host}${path}?${parameters}`\n}\n\nfunction buildEndpointHost(initConfiguration: InitConfiguration, endpointType: EndpointType) {\n  const { site = INTAKE_SITE_US1, internalAnalyticsSubdomain } = initConfiguration\n\n  if (internalAnalyticsSubdomain && site === INTAKE_SITE_US1) {\n    return `${internalAnalyticsSubdomain}.${INTAKE_SITE_US1}`\n  }\n\n  const domainParts = site.split('.')\n  const extension = domainParts.pop()\n  const subdomain = site !== INTAKE_SITE_AP1 ? `${ENDPOINTS[endpointType]}.` : ''\n  return `${subdomain}browser-intake-${domainParts.join('-')}.${extension!}`\n}\n\n/**\n * Build parameters to be used for an intake request. Parameters should be re-built for each\n * request, as they change randomly.\n */\nfunction buildEndpointParameters(\n  { clientToken, internalAnalyticsSubdomain }: InitConfiguration,\n  endpointType: EndpointType,\n  configurationTags: string[],\n  api: 'xhr' | 'fetch' | 'beacon',\n  { retry, flushReason, encoding }: Payload\n) {\n  const tags = [`sdk_version:${__BUILD_ENV__SDK_VERSION__}`, `api:${api}`].concat(configurationTags)\n  if (flushReason && isExperimentalFeatureEnabled(ExperimentalFeature.COLLECT_FLUSH_REASON)) {\n    tags.push(`flush_reason:${flushReason}`)\n  }\n  if (retry) {\n    tags.push(`retry_count:${retry.count}`, `retry_after:${retry.lastFailureStatus}`)\n  }\n\n  const parameters = [\n    'ddsource=browser',\n    `ddtags=${encodeURIComponent(tags.join(','))}`,\n    `dd-api-key=${clientToken}`,\n    `dd-evp-origin-version=${encodeURIComponent(__BUILD_ENV__SDK_VERSION__)}`,\n    'dd-evp-origin=browser',\n    `dd-request-id=${generateUUID()}`,\n  ]\n\n  if (encoding) {\n    parameters.push(`dd-evp-encoding=${encoding}`)\n  }\n\n  if (endpointType === 'rum') {\n    parameters.push(`batch_time=${timeStampNow()}`)\n  }\n\n  if (internalAnalyticsSubdomain) {\n    parameters.reverse()\n  }\n\n  return parameters.join('&')\n}\n","export const INTAKE_SITE_STAGING = 'datad0g.com'\nexport const INTAKE_SITE_US1 = 'datadoghq.com'\nexport const INTAKE_SITE_EU1 = 'datadoghq.eu'\nexport const INTAKE_SITE_AP1 = 'ap1.datadoghq.com'\nexport const INTAKE_SITE_US1_FED = 'ddog-gov.com'\n","import { display } from '../../tools/display'\nimport type { InitConfiguration } from './configuration'\n\nexport const TAG_SIZE_LIMIT = 200\n\nexport function buildTags(configuration: InitConfiguration): string[] {\n  const { env, service, version, datacenter } = configuration\n  const tags = []\n\n  if (env) {\n    tags.push(buildTag('env', env))\n  }\n  if (service) {\n    tags.push(buildTag('service', service))\n  }\n  if (version) {\n    tags.push(buildTag('version', version))\n  }\n  if (datacenter) {\n    tags.push(buildTag('datacenter', datacenter))\n  }\n\n  return tags\n}\n\nconst FORBIDDEN_CHARACTERS = /[^a-z0-9_:./-]/\n\nexport function buildTag(key: string, rawValue: string) {\n  // See https://docs.datadoghq.com/getting_started/tagging/#defining-tags for tags syntax. Note\n  // that the backend may not follow the exact same rules, so we only want to display an informal\n  // warning.\n  const valueSizeLimit = TAG_SIZE_LIMIT - key.length - 1\n\n  if (rawValue.length > valueSizeLimit || FORBIDDEN_CHARACTERS.test(rawValue)) {\n    display.warn(`${key} value doesn't meet tag requirements and will be sanitized`)\n  }\n\n  // Let the backend do most of the sanitization, but still make sure multiple tags can't be crafted\n  // by forging a value containing commas.\n  const sanitizedValue = rawValue.replace(/,/g, '_')\n\n  return `${key}:${sanitizedValue}`\n}\n","import { objectValues, assign } from '../../tools/utils/polyfills'\nimport type { InitConfiguration } from './configuration'\nimport type { EndpointBuilder } from './endpointBuilder'\nimport { createEndpointBuilder } from './endpointBuilder'\nimport { buildTags } from './tags'\nimport { INTAKE_SITE_US1 } from './intakeSites'\n\nexport interface TransportConfiguration {\n  logsEndpointBuilder: EndpointBuilder\n  rumEndpointBuilder: EndpointBuilder\n  sessionReplayEndpointBuilder: EndpointBuilder\n  isIntakeUrl: (url: string) => boolean\n  replica?: ReplicaConfiguration\n  site: string\n}\n\nexport interface ReplicaConfiguration {\n  applicationId?: string\n  logsEndpointBuilder: EndpointBuilder\n  rumEndpointBuilder: EndpointBuilder\n}\n\nexport function computeTransportConfiguration(initConfiguration: InitConfiguration): TransportConfiguration {\n  const tags = buildTags(initConfiguration)\n\n  const endpointBuilders = computeEndpointBuilders(initConfiguration, tags)\n  const intakeUrlPrefixes = objectValues(endpointBuilders).map((builder) => builder.urlPrefix)\n\n  const replicaConfiguration = computeReplicaConfiguration(initConfiguration, intakeUrlPrefixes, tags)\n\n  return assign(\n    {\n      isIntakeUrl: (url: string) => intakeUrlPrefixes.some((intakeEndpoint) => url.indexOf(intakeEndpoint) === 0),\n      replica: replicaConfiguration,\n      site: initConfiguration.site || INTAKE_SITE_US1,\n    },\n    endpointBuilders\n  )\n}\n\nfunction computeEndpointBuilders(initConfiguration: InitConfiguration, tags: string[]) {\n  return {\n    logsEndpointBuilder: createEndpointBuilder(initConfiguration, 'logs', tags),\n    rumEndpointBuilder: createEndpointBuilder(initConfiguration, 'rum', tags),\n    sessionReplayEndpointBuilder: createEndpointBuilder(initConfiguration, 'sessionReplay', tags),\n  }\n}\n\nfunction computeReplicaConfiguration(\n  initConfiguration: InitConfiguration,\n  intakeUrlPrefixes: string[],\n  tags: string[]\n): ReplicaConfiguration | undefined {\n  if (!initConfiguration.replica) {\n    return\n  }\n\n  const replicaConfiguration: InitConfiguration = assign({}, initConfiguration, {\n    site: INTAKE_SITE_US1,\n    clientToken: initConfiguration.replica.clientToken,\n  })\n\n  const replicaEndpointBuilders = {\n    logsEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'logs', tags),\n    rumEndpointBuilder: createEndpointBuilder(replicaConfiguration, 'rum', tags),\n  }\n\n  intakeUrlPrefixes.push(...objectValues(replicaEndpointBuilders).map((builder) => builder.urlPrefix))\n\n  return assign({ applicationId: initConfiguration.replica.applicationId }, replicaEndpointBuilders)\n}\n","import { computeStackTrace } from '../tracekit'\nimport { createHandlingStack, formatErrorMessage, toStackTraceString, tryToGetFingerprint } from '../error/error'\nimport { mergeObservables, Observable } from '../../tools/observable'\nimport { ConsoleApiName, globalConsole } from '../../tools/display'\nimport { callMonitored } from '../../tools/monitor'\nimport { sanitize } from '../../tools/serialisation/sanitize'\nimport { find } from '../../tools/utils/polyfills'\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify'\n\nexport interface ConsoleLog {\n  message: string\n  api: ConsoleApiName\n  stack?: string\n  handlingStack?: string\n  fingerprint?: string\n}\n\nlet consoleObservablesByApi: { [k in ConsoleApiName]?: Observable<ConsoleLog> } = {}\n\nexport function initConsoleObservable(apis: ConsoleApiName[]) {\n  const consoleObservables = apis.map((api) => {\n    if (!consoleObservablesByApi[api]) {\n      consoleObservablesByApi[api] = createConsoleObservable(api)\n    }\n    return consoleObservablesByApi[api]!\n  })\n\n  return mergeObservables<ConsoleLog>(...consoleObservables)\n}\n\nexport function resetConsoleObservable() {\n  consoleObservablesByApi = {}\n}\n\nfunction createConsoleObservable(api: ConsoleApiName) {\n  const observable = new Observable<ConsoleLog>(() => {\n    const originalConsoleApi = globalConsole[api]\n\n    globalConsole[api] = (...params: unknown[]) => {\n      originalConsoleApi.apply(console, params)\n      const handlingStack = createHandlingStack()\n\n      callMonitored(() => {\n        observable.notify(buildConsoleLog(params, api, handlingStack))\n      })\n    }\n\n    return () => {\n      globalConsole[api] = originalConsoleApi\n    }\n  })\n\n  return observable\n}\n\nfunction buildConsoleLog(params: unknown[], api: ConsoleApiName, handlingStack: string): ConsoleLog {\n  // Todo: remove console error prefix in the next major version\n  let message = params.map((param) => formatConsoleParameters(param)).join(' ')\n  let stack\n  let fingerprint\n\n  if (api === ConsoleApiName.error) {\n    const firstErrorParam = find(params, (param: unknown): param is Error => param instanceof Error)\n    stack = firstErrorParam ? toStackTraceString(computeStackTrace(firstErrorParam)) : undefined\n    fingerprint = tryToGetFingerprint(firstErrorParam)\n    message = `console error: ${message}`\n  }\n\n  return {\n    api,\n    message,\n    stack,\n    handlingStack,\n    fingerprint,\n  }\n}\n\nfunction formatConsoleParameters(param: unknown) {\n  if (typeof param === 'string') {\n    return sanitize(param)\n  }\n  if (param instanceof Error) {\n    return formatErrorMessage(computeStackTrace(param))\n  }\n  return jsonStringify(sanitize(param), undefined, 2)\n}\n","import { computeBytesCount } from '../../tools/utils/byteUtils'\nimport { throttle } from '../../tools/utils/functionUtils'\nimport { deepClone } from '../../tools/mergeInto'\nimport { getType } from '../../tools/utils/typeUtils'\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify'\nimport { sanitize } from '../../tools/serialisation/sanitize'\nimport type { Context, ContextValue } from '../../tools/serialisation/context'\nimport { Observable } from '../../tools/observable'\nimport { warnIfCustomerDataLimitReached } from './heavyCustomerDataWarning'\nimport type { CustomerDataType } from './contextConstants'\n\nexport const BYTES_COMPUTATION_THROTTLING_DELAY = 200\n\nexport type ContextManager = ReturnType<typeof createContextManager>\n\nexport function createContextManager(customerDataType: CustomerDataType, computeBytesCountImpl = computeBytesCount) {\n  let context: Context = {}\n  let bytesCountCache: number\n  let alreadyWarned = false\n  const changeObservable = new Observable<void>()\n\n  // Throttle the bytes computation to minimize the impact on performance.\n  // Especially useful if the user call context APIs synchronously multiple times in a row\n  const { throttled: computeBytesCountThrottled } = throttle((context: Context) => {\n    bytesCountCache = computeBytesCountImpl(jsonStringify(context)!)\n    if (!alreadyWarned) {\n      alreadyWarned = warnIfCustomerDataLimitReached(bytesCountCache, customerDataType)\n    }\n  }, BYTES_COMPUTATION_THROTTLING_DELAY)\n\n  const contextManager = {\n    getBytesCount: () => bytesCountCache,\n    /** @deprecated use getContext instead */\n    get: () => context,\n\n    /** @deprecated use setContextProperty instead */\n    add: (key: string, value: any) => {\n      context[key] = value as ContextValue\n      computeBytesCountThrottled(context)\n      changeObservable.notify()\n    },\n\n    /** @deprecated renamed to removeContextProperty */\n    remove: (key: string) => {\n      delete context[key]\n      computeBytesCountThrottled(context)\n      changeObservable.notify()\n    },\n\n    /** @deprecated use setContext instead */\n    set: (newContext: object) => {\n      context = newContext as Context\n      computeBytesCountThrottled(context)\n      changeObservable.notify()\n    },\n\n    getContext: () => deepClone(context),\n\n    setContext: (newContext: Context) => {\n      if (getType(newContext) === 'object') {\n        context = sanitize(newContext)\n        computeBytesCountThrottled(context)\n      } else {\n        contextManager.clearContext()\n      }\n      changeObservable.notify()\n    },\n\n    setContextProperty: (key: string, property: any) => {\n      context[key] = sanitize(property)\n      computeBytesCountThrottled(context)\n      changeObservable.notify()\n    },\n\n    removeContextProperty: (key: string) => {\n      delete context[key]\n      computeBytesCountThrottled(context)\n      changeObservable.notify()\n    },\n\n    clearContext: () => {\n      context = {}\n      bytesCountCache = 0\n      changeObservable.notify()\n    },\n\n    changeObservable,\n  }\n  return contextManager\n}\n","import { ONE_KIBI_BYTE } from '../../tools/utils/byteUtils'\nimport { display } from '../../tools/display'\nimport { CustomerDataType } from './contextConstants'\n\n// RUM and logs batch bytes limit is 16KB\n// ensure that we leave room for other event attributes and maintain a decent amount of event per batch\n// (3KB (customer data) + 1KB (other attributes)) * 4 (events per batch) = 16KB\nexport const CUSTOMER_DATA_BYTES_LIMIT = 3 * ONE_KIBI_BYTE\n\nconst CustomerDataLabel = {\n  [CustomerDataType.FeatureFlag]: 'feature flag evaluation',\n  [CustomerDataType.User]: 'user',\n  [CustomerDataType.GlobalContext]: 'global context',\n  [CustomerDataType.LoggerContext]: 'logger context',\n}\nexport function warnIfCustomerDataLimitReached(bytesCount: number, customerDataType: CustomerDataType): boolean {\n  if (bytesCount > CUSTOMER_DATA_BYTES_LIMIT) {\n    display.warn(\n      `The ${CustomerDataLabel[customerDataType]} data exceeds the recommended ${\n        CUSTOMER_DATA_BYTES_LIMIT / ONE_KIBI_BYTE\n      }KiB threshold. More details: https://docs.datadoghq.com/real_user_monitoring/browser/troubleshooting/#customer-data-exceeds-the-recommended-3kib-warning`\n    )\n    return true\n  }\n  return false\n}\n","import { computeBytesCount } from '../../tools/utils/byteUtils'\nimport { addEventListener, DOM_EVENT } from '../../browser/addEventListener'\nimport type { Context } from '../../tools/serialisation/context'\nimport type { Configuration } from '../configuration'\nimport type { ContextManager } from './contextManager'\nimport { createContextManager } from './contextManager'\nimport type { CustomerDataType } from './contextConstants'\n\nconst CONTEXT_STORE_KEY_PREFIX = '_dd_c'\n\nconst storageListeners: Array<{ stop: () => void }> = []\n\nexport function createStoredContextManager(\n  configuration: Configuration,\n  productKey: string,\n  customerDataType: CustomerDataType,\n  computeBytesCountImpl = computeBytesCount\n): ContextManager {\n  const storageKey = buildStorageKey(productKey, customerDataType)\n  const contextManager = createContextManager(customerDataType, computeBytesCountImpl)\n\n  synchronizeWithStorage()\n  storageListeners.push(\n    addEventListener(configuration, window, DOM_EVENT.STORAGE, ({ key }) => {\n      if (storageKey === key) {\n        synchronizeWithStorage()\n      }\n    })\n  )\n  contextManager.changeObservable.subscribe(dumpToStorage)\n\n  return contextManager\n\n  function synchronizeWithStorage() {\n    const rawContext = localStorage.getItem(storageKey)\n    const context = rawContext !== null ? (JSON.parse(rawContext) as Context) : {}\n    contextManager.setContext(context)\n  }\n\n  function dumpToStorage() {\n    localStorage.setItem(storageKey, JSON.stringify(contextManager.getContext()))\n  }\n}\n\nexport function buildStorageKey(productKey: string, customerDataType: CustomerDataType) {\n  return `${CONTEXT_STORE_KEY_PREFIX}_${productKey}_${customerDataType}`\n}\n\nexport function removeStorageListeners() {\n  storageListeners.map((listener) => listener.stop())\n}\n","import type { StackTrace } from '../tracekit'\nimport { computeStackTrace } from '../tracekit'\nimport { callMonitored } from '../../tools/monitor'\nimport { sanitize } from '../../tools/serialisation/sanitize'\nimport type { ClocksState } from '../../tools/utils/timeUtils'\nimport { noop } from '../../tools/utils/functionUtils'\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify'\nimport type { ErrorSource, ErrorHandling, RawError, RawErrorCause, ErrorWithCause, NonErrorPrefix } from './error.types'\n\nexport const NO_ERROR_STACK_PRESENT_MESSAGE = 'No stack, consider using an instance of Error'\n\ntype RawErrorParams = {\n  stackTrace?: StackTrace\n  originalError: unknown\n\n  handlingStack?: string\n  startClocks: ClocksState\n  nonErrorPrefix: NonErrorPrefix\n  source: ErrorSource\n  handling: ErrorHandling\n}\n\nexport function computeRawError({\n  stackTrace,\n  originalError,\n  handlingStack,\n  startClocks,\n  nonErrorPrefix,\n  source,\n  handling,\n}: RawErrorParams): RawError {\n  const isErrorInstance = originalError instanceof Error\n\n  const message = computeMessage(stackTrace, isErrorInstance, nonErrorPrefix, originalError)\n  const stack = hasUsableStack(isErrorInstance, stackTrace)\n    ? toStackTraceString(stackTrace)\n    : NO_ERROR_STACK_PRESENT_MESSAGE\n  const causes = isErrorInstance ? flattenErrorCauses(originalError as ErrorWithCause, source) : undefined\n  const type = stackTrace?.name\n  const fingerprint = tryToGetFingerprint(originalError)\n\n  return {\n    startClocks,\n    source,\n    handling,\n    handlingStack,\n    originalError,\n    type,\n    message,\n    stack,\n    causes,\n    fingerprint,\n  }\n}\n\nfunction computeMessage(\n  stackTrace: StackTrace | undefined,\n  isErrorInstance: boolean,\n  nonErrorPrefix: NonErrorPrefix,\n  originalError: unknown\n) {\n  // Favor stackTrace message only if tracekit has really been able to extract something meaningful (message + name)\n  // TODO rework tracekit integration to avoid scattering error building logic\n  return stackTrace?.message && stackTrace?.name\n    ? stackTrace.message\n    : !isErrorInstance\n    ? `${nonErrorPrefix} ${jsonStringify(sanitize(originalError))!}`\n    : 'Empty message'\n}\n\nfunction hasUsableStack(isErrorInstance: boolean, stackTrace?: StackTrace): stackTrace is StackTrace {\n  if (stackTrace === undefined) {\n    return false\n  }\n  if (isErrorInstance) {\n    return true\n  }\n  // handle cases where tracekit return stack = [] or stack = [{url: undefined, line: undefined, column: undefined}]\n  // TODO rework tracekit integration to avoid generating those unusable stack\n  return stackTrace.stack.length > 0 && (stackTrace.stack.length > 1 || stackTrace.stack[0].url !== undefined)\n}\n\nexport function tryToGetFingerprint(originalError: unknown) {\n  return originalError instanceof Error && 'dd_fingerprint' in originalError\n    ? String(originalError.dd_fingerprint)\n    : undefined\n}\n\nexport function toStackTraceString(stack: StackTrace) {\n  let result = formatErrorMessage(stack)\n  stack.stack.forEach((frame) => {\n    const func = frame.func === '?' ? '<anonymous>' : frame.func\n    const args = frame.args && frame.args.length > 0 ? `(${frame.args.join(', ')})` : ''\n    const line = frame.line ? `:${frame.line}` : ''\n    const column = frame.line && frame.column ? `:${frame.column}` : ''\n    result += `\\n  at ${func!}${args} @ ${frame.url!}${line}${column}`\n  })\n  return result\n}\n\nexport function getFileFromStackTraceString(stack: string) {\n  return /@ (.+)/.exec(stack)?.[1]\n}\n\nexport function formatErrorMessage(stack: StackTrace) {\n  return `${stack.name || 'Error'}: ${stack.message!}`\n}\n\n/**\n Creates a stacktrace without SDK internal frames.\n \n Constraints:\n - Has to be called at the utmost position of the call stack.\n - No monitored function should encapsulate it, that is why we need to use callMonitored inside it.\n */\nexport function createHandlingStack(): string {\n  /**\n   * Skip the two internal frames:\n   * - SDK API (console.error, ...)\n   * - this function\n   * in order to keep only the user calls\n   */\n  const internalFramesToSkip = 2\n  const error = new Error()\n  let formattedStack: string\n\n  // IE needs to throw the error to fill in the stack trace\n  if (!error.stack) {\n    try {\n      throw error\n    } catch (e) {\n      noop()\n    }\n  }\n\n  callMonitored(() => {\n    const stackTrace = computeStackTrace(error)\n    stackTrace.stack = stackTrace.stack.slice(internalFramesToSkip)\n    formattedStack = toStackTraceString(stackTrace)\n  })\n\n  return formattedStack!\n}\n\nexport function flattenErrorCauses(error: ErrorWithCause, parentSource: ErrorSource): RawErrorCause[] | undefined {\n  let currentError = error\n  const causes: RawErrorCause[] = []\n  while (currentError?.cause instanceof Error && causes.length < 10) {\n    const stackTrace = computeStackTrace(currentError.cause)\n    causes.push({\n      message: currentError.cause.message,\n      source: parentSource,\n      type: stackTrace?.name,\n      stack: stackTrace && toStackTraceString(stackTrace),\n    })\n    currentError = currentError.cause\n  }\n  return causes.length ? causes : undefined\n}\n","import type { ClocksState } from '../../tools/utils/timeUtils'\n\n// TS v4.6 introduced Error.cause[1] typed as `Error`. TS v4.8 changed Error.cause to be\n// `unknown`[2].\n//\n// Because we still support TS 3.8, we need to declare our own type. We can remove it once we drop\n// support for TS v4.7 and before. The 'cause' property defined by TS needs to be omitted because\n// we define it with a type `unknown` which is incompatible with TS 4.6 and 4.7.\n//\n// [1]: https://devblogs.microsoft.com/typescript/announcing-typescript-4-6/#target-es2022\n// [2]: https://devblogs.microsoft.com/typescript/announcing-typescript-4-8/#lib-d-ts-updates\nexport interface ErrorWithCause extends Omit<Error, 'cause'> {\n  cause?: unknown\n}\n\nexport type RawErrorCause = {\n  message: string\n  source: string\n  type?: string\n  stack?: string\n}\n\nexport interface RawError {\n  startClocks: ClocksState\n  message: string\n  type?: string\n  stack?: string\n  source: ErrorSource\n  originalError?: unknown\n  handling?: ErrorHandling\n  handlingStack?: string\n  causes?: RawErrorCause[]\n  fingerprint?: string\n}\n\nexport const ErrorSource = {\n  AGENT: 'agent',\n  CONSOLE: 'console',\n  CUSTOM: 'custom',\n  LOGGER: 'logger',\n  NETWORK: 'network',\n  SOURCE: 'source',\n  REPORT: 'report',\n} as const\n\nexport const enum NonErrorPrefix {\n  UNCAUGHT = 'Uncaught',\n  PROVIDED = 'Provided',\n}\n\nexport const enum ErrorHandling {\n  HANDLED = 'handled',\n  UNHANDLED = 'unhandled',\n}\n\nexport type ErrorSource = (typeof ErrorSource)[keyof typeof ErrorSource]\n","import type { Observable } from '../../tools/observable'\nimport { clocksNow } from '../../tools/utils/timeUtils'\nimport { startUnhandledErrorCollection } from '../tracekit'\nimport { computeRawError } from './error'\nimport type { RawError } from './error.types'\nimport { ErrorHandling, ErrorSource, NonErrorPrefix } from './error.types'\n\nexport function trackRuntimeError(errorObservable: Observable<RawError>) {\n  return startUnhandledErrorCollection((stackTrace, originalError) => {\n    errorObservable.notify(\n      computeRawError({\n        stackTrace,\n        originalError,\n        startClocks: clocksNow(),\n        nonErrorPrefix: NonErrorPrefix.UNCAUGHT,\n        source: ErrorSource.SOURCE,\n        handling: ErrorHandling.UNHANDLED,\n      })\n    )\n  })\n}\n","import { setTimeout } from '../../tools/timer'\nimport { clocksNow, ONE_MINUTE } from '../../tools/utils/timeUtils'\nimport type { RawError } from '../error/error.types'\nimport { ErrorSource } from '../error/error.types'\n\nexport type EventRateLimiter = ReturnType<typeof createEventRateLimiter>\n\nexport function createEventRateLimiter(\n  eventType: string,\n  limit: number,\n  onLimitReached: (limitError: RawError) => void\n) {\n  let eventCount = 0\n  let allowNextEvent = false\n\n  return {\n    isLimitReached() {\n      if (eventCount === 0) {\n        setTimeout(() => {\n          eventCount = 0\n        }, ONE_MINUTE)\n      }\n\n      eventCount += 1\n      if (eventCount <= limit || allowNextEvent) {\n        allowNextEvent = false\n        return false\n      }\n\n      if (eventCount === limit + 1) {\n        allowNextEvent = true\n        try {\n          onLimitReached({\n            message: `Reached max number of ${eventType}s by minute: ${limit}`,\n            source: ErrorSource.AGENT,\n            startClocks: clocksNow(),\n          })\n        } finally {\n          allowNextEvent = false\n        }\n      }\n\n      return true\n    },\n  }\n}\n","import { toStackTraceString } from '../error/error'\nimport { monitor } from '../../tools/monitor'\nimport { mergeObservables, Observable } from '../../tools/observable'\nimport { addEventListener, DOM_EVENT } from '../../browser/addEventListener'\nimport { includes } from '../../tools/utils/polyfills'\nimport { safeTruncate } from '../../tools/utils/stringUtils'\nimport type { Configuration } from '../configuration'\nimport type { ReportType, InterventionReport, DeprecationReport } from './browser.types'\n\nexport const RawReportType = {\n  intervention: 'intervention',\n  deprecation: 'deprecation',\n  cspViolation: 'csp_violation',\n} as const\n\nexport type RawReportType = (typeof RawReportType)[keyof typeof RawReportType]\n\nexport interface RawReport {\n  type: RawReportType\n  subtype: string\n  message: string\n  stack?: string\n}\n\nexport function initReportObservable(configuration: Configuration, apis: RawReportType[]) {\n  const observables: Array<Observable<RawReport>> = []\n\n  if (includes(apis, RawReportType.cspViolation)) {\n    observables.push(createCspViolationReportObservable(configuration))\n  }\n\n  const reportTypes = apis.filter((api: RawReportType): api is ReportType => api !== RawReportType.cspViolation)\n  if (reportTypes.length) {\n    observables.push(createReportObservable(reportTypes))\n  }\n\n  return mergeObservables<RawReport>(...observables)\n}\n\nfunction createReportObservable(reportTypes: ReportType[]) {\n  const observable = new Observable<RawReport>(() => {\n    if (!window.ReportingObserver) {\n      return\n    }\n\n    const handleReports = monitor((reports: Array<DeprecationReport | InterventionReport>, _: ReportingObserver) =>\n      reports.forEach((report) => {\n        observable.notify(buildRawReportFromReport(report))\n      })\n    ) as ReportingObserverCallback\n\n    const observer = new window.ReportingObserver(handleReports, {\n      types: reportTypes,\n      buffered: true,\n    })\n\n    observer.observe()\n    return () => {\n      observer.disconnect()\n    }\n  })\n\n  return observable\n}\n\nfunction createCspViolationReportObservable(configuration: Configuration) {\n  const observable = new Observable<RawReport>(() => {\n    const { stop } = addEventListener(configuration, document, DOM_EVENT.SECURITY_POLICY_VIOLATION, (event) => {\n      observable.notify(buildRawReportFromCspViolation(event))\n    })\n\n    return stop\n  })\n  return observable\n}\n\nfunction buildRawReportFromReport({ type, body }: DeprecationReport | InterventionReport): RawReport {\n  return {\n    type,\n    subtype: body.id,\n    message: `${type}: ${body.message}`,\n    stack: buildStack(body.id, body.message, body.sourceFile, body.lineNumber, body.columnNumber),\n  }\n}\n\nfunction buildRawReportFromCspViolation(event: SecurityPolicyViolationEvent): RawReport {\n  const type = RawReportType.cspViolation\n  const message = `'${event.blockedURI}' blocked by '${event.effectiveDirective}' directive`\n  return {\n    type: RawReportType.cspViolation,\n    subtype: event.effectiveDirective,\n    message: `${type}: ${message}`,\n    stack: buildStack(\n      event.effectiveDirective,\n      event.originalPolicy\n        ? `${message} of the policy \"${safeTruncate(event.originalPolicy, 100, '...')}\"`\n        : 'no policy',\n      event.sourceFile,\n      event.lineNumber,\n      event.columnNumber\n    ),\n  }\n}\n\nfunction buildStack(\n  name: string,\n  message: string,\n  sourceFile: string | null,\n  lineNumber: number | null,\n  columnNumber: number | null\n): string | undefined {\n  return sourceFile\n    ? toStackTraceString({\n        name,\n        message,\n        stack: [\n          {\n            func: '?',\n            url: sourceFile,\n            line: lineNumber ?? undefined,\n            column: columnNumber ?? undefined,\n          },\n        ],\n      })\n    : undefined\n}\n","import { getCookie } from '../../browser/cookie'\nimport type { SessionStoreStrategy } from './storeStrategies/sessionStoreStrategy'\nimport { SESSION_STORE_KEY } from './storeStrategies/sessionStoreStrategy'\nimport type { SessionState } from './sessionState'\nimport { expandSessionState, isSessionInExpiredState } from './sessionState'\n\nexport const OLD_SESSION_COOKIE_NAME = '_dd'\nexport const OLD_RUM_COOKIE_NAME = '_dd_r'\nexport const OLD_LOGS_COOKIE_NAME = '_dd_l'\n\n// duplicate values to avoid dependency issues\nexport const RUM_SESSION_KEY = 'rum'\nexport const LOGS_SESSION_KEY = 'logs'\n\n/**\n * This migration should remain in the codebase as long as older versions are available/live\n * to allow older sdk versions to be upgraded to newer versions without compatibility issues.\n */\nexport function tryOldCookiesMigration(cookieStoreStrategy: SessionStoreStrategy) {\n  const sessionString = getCookie(SESSION_STORE_KEY)\n  if (!sessionString) {\n    const oldSessionId = getCookie(OLD_SESSION_COOKIE_NAME)\n    const oldRumType = getCookie(OLD_RUM_COOKIE_NAME)\n    const oldLogsType = getCookie(OLD_LOGS_COOKIE_NAME)\n    const session: SessionState = {}\n\n    if (oldSessionId) {\n      session.id = oldSessionId\n    }\n    if (oldLogsType && /^[01]$/.test(oldLogsType)) {\n      session[LOGS_SESSION_KEY] = oldLogsType\n    }\n    if (oldRumType && /^[012]$/.test(oldRumType)) {\n      session[RUM_SESSION_KEY] = oldRumType\n    }\n\n    if (!isSessionInExpiredState(session)) {\n      expandSessionState(session)\n      cookieStoreStrategy.persistSession(session)\n    }\n  }\n}\n","import { ONE_HOUR, ONE_MINUTE } from '../../tools/utils/timeUtils'\n\nexport const SESSION_TIME_OUT_DELAY = 4 * ONE_HOUR\nexport const SESSION_EXPIRATION_DELAY = 15 * ONE_MINUTE\n","import type { Observable } from '../../tools/observable'\nimport type { Context } from '../../tools/serialisation/context'\nimport { ValueHistory } from '../../tools/valueHistory'\nimport type { RelativeTime } from '../../tools/utils/timeUtils'\nimport { relativeNow, clocksOrigin, ONE_MINUTE } from '../../tools/utils/timeUtils'\nimport { DOM_EVENT, addEventListener, addEventListeners } from '../../browser/addEventListener'\nimport { clearInterval, setInterval } from '../../tools/timer'\nimport type { Configuration } from '../configuration'\nimport { SESSION_TIME_OUT_DELAY } from './sessionConstants'\nimport { startSessionStore } from './sessionStore'\n\nexport interface SessionManager<TrackingType extends string> {\n  findActiveSession: (startTime?: RelativeTime) => SessionContext<TrackingType> | undefined\n  renewObservable: Observable<void>\n  expireObservable: Observable<void>\n  expire: () => void\n}\n\nexport interface SessionContext<TrackingType extends string> extends Context {\n  id: string\n  trackingType: TrackingType\n}\n\nexport const VISIBILITY_CHECK_DELAY = ONE_MINUTE\nconst SESSION_CONTEXT_TIMEOUT_DELAY = SESSION_TIME_OUT_DELAY\nlet stopCallbacks: Array<() => void> = []\n\nexport function startSessionManager<TrackingType extends string>(\n  configuration: Configuration,\n  productKey: string,\n  computeSessionState: (rawTrackingType?: string) => { trackingType: TrackingType; isTracked: boolean }\n): SessionManager<TrackingType> {\n  // TODO - Improve configuration type and remove assertion\n  const sessionStore = startSessionStore(configuration.sessionStoreStrategyType!, productKey, computeSessionState)\n  stopCallbacks.push(() => sessionStore.stop())\n\n  const sessionContextHistory = new ValueHistory<SessionContext<TrackingType>>(SESSION_CONTEXT_TIMEOUT_DELAY)\n  stopCallbacks.push(() => sessionContextHistory.stop())\n\n  sessionStore.renewObservable.subscribe(() => {\n    sessionContextHistory.add(buildSessionContext(), relativeNow())\n  })\n  sessionStore.expireObservable.subscribe(() => {\n    sessionContextHistory.closeActive(relativeNow())\n  })\n\n  sessionStore.expandOrRenewSession()\n  sessionContextHistory.add(buildSessionContext(), clocksOrigin().relative)\n\n  trackActivity(configuration, () => sessionStore.expandOrRenewSession())\n  trackVisibility(configuration, () => sessionStore.expandSession())\n\n  function buildSessionContext() {\n    return {\n      id: sessionStore.getSession().id!,\n      trackingType: sessionStore.getSession()[productKey] as TrackingType,\n    }\n  }\n\n  return {\n    findActiveSession: (startTime) => sessionContextHistory.find(startTime),\n    renewObservable: sessionStore.renewObservable,\n    expireObservable: sessionStore.expireObservable,\n    expire: sessionStore.expire,\n  }\n}\n\nexport function stopSessionManager() {\n  stopCallbacks.forEach((e) => e())\n  stopCallbacks = []\n}\n\nfunction trackActivity(configuration: Configuration, expandOrRenewSession: () => void) {\n  const { stop } = addEventListeners(\n    configuration,\n    window,\n    [DOM_EVENT.CLICK, DOM_EVENT.TOUCH_START, DOM_EVENT.KEY_DOWN, DOM_EVENT.SCROLL],\n    expandOrRenewSession,\n    { capture: true, passive: true }\n  )\n  stopCallbacks.push(stop)\n}\n\nfunction trackVisibility(configuration: Configuration, expandSession: () => void) {\n  const expandSessionWhenVisible = () => {\n    if (document.visibilityState === 'visible') {\n      expandSession()\n    }\n  }\n\n  const { stop } = addEventListener(configuration, document, DOM_EVENT.VISIBILITY_CHANGE, expandSessionWhenVisible)\n  stopCallbacks.push(stop)\n\n  const visibilityCheckInterval = setInterval(expandSessionWhenVisible, VISIBILITY_CHECK_DELAY)\n  stopCallbacks.push(() => {\n    clearInterval(visibilityCheckInterval)\n  })\n}\n","import { isEmptyObject } from '../../tools/utils/objectUtils'\nimport { objectEntries } from '../../tools/utils/polyfills'\nimport { dateNow } from '../../tools/utils/timeUtils'\nimport { SESSION_EXPIRATION_DELAY } from './sessionConstants'\n\nconst SESSION_ENTRY_REGEXP = /^([a-z]+)=([a-z0-9-]+)$/\nconst SESSION_ENTRY_SEPARATOR = '&'\n\nexport interface SessionState {\n  id?: string\n  created?: string\n  expire?: string\n  lock?: string\n\n  [key: string]: string | undefined\n}\n\nexport function isSessionInExpiredState(session: SessionState) {\n  return isEmptyObject(session)\n}\n\nexport function expandSessionState(session: SessionState) {\n  session.expire = String(dateNow() + SESSION_EXPIRATION_DELAY)\n}\n\nexport function toSessionString(session: SessionState) {\n  return objectEntries(session)\n    .map(([key, value]) => `${key}=${value as string}`)\n    .join(SESSION_ENTRY_SEPARATOR)\n}\n\nexport function toSessionState(sessionString: string | undefined | null) {\n  const session: SessionState = {}\n  if (isValidSessionString(sessionString)) {\n    sessionString.split(SESSION_ENTRY_SEPARATOR).forEach((entry) => {\n      const matches = SESSION_ENTRY_REGEXP.exec(entry)\n      if (matches !== null) {\n        const [, key, value] = matches\n        session[key] = value\n      }\n    })\n  }\n  return session\n}\n\nfunction isValidSessionString(sessionString: string | undefined | null): sessionString is string {\n  return (\n    !!sessionString &&\n    (sessionString.indexOf(SESSION_ENTRY_SEPARATOR) !== -1 || SESSION_ENTRY_REGEXP.test(sessionString))\n  )\n}\n","import { clearInterval, setInterval } from '../../tools/timer'\nimport { Observable } from '../../tools/observable'\nimport { ONE_SECOND, dateNow } from '../../tools/utils/timeUtils'\nimport { throttle } from '../../tools/utils/functionUtils'\nimport { generateUUID } from '../../tools/utils/stringUtils'\nimport type { InitConfiguration } from '../configuration'\nimport { SESSION_TIME_OUT_DELAY } from './sessionConstants'\nimport { selectCookieStrategy, initCookieStrategy } from './storeStrategies/sessionInCookie'\nimport type { SessionStoreStrategyType } from './storeStrategies/sessionStoreStrategy'\nimport type { SessionState } from './sessionState'\nimport { initLocalStorageStrategy, selectLocalStorageStrategy } from './storeStrategies/sessionInLocalStorage'\nimport { processSessionStoreOperations } from './sessionStoreOperations'\n\nexport interface SessionStore {\n  expandOrRenewSession: () => void\n  expandSession: () => void\n  getSession: () => SessionState\n  renewObservable: Observable<void>\n  expireObservable: Observable<void>\n  expire: () => void\n  stop: () => void\n}\n\n/**\n * Every second, the storage will be polled to check for any change that can occur\n * to the session state in another browser tab, or another window.\n * This value has been determined from our previous cookie-only implementation.\n */\nexport const STORAGE_POLL_DELAY = ONE_SECOND\n\n/**\n * Checks if cookies are available as the preferred storage\n * Else, checks if LocalStorage is allowed and available\n */\nexport function selectSessionStoreStrategyType(\n  initConfiguration: InitConfiguration\n): SessionStoreStrategyType | undefined {\n  let sessionStoreStrategyType = selectCookieStrategy(initConfiguration)\n  if (!sessionStoreStrategyType && initConfiguration.allowFallbackToLocalStorage) {\n    sessionStoreStrategyType = selectLocalStorageStrategy()\n  }\n  return sessionStoreStrategyType\n}\n\n/**\n * Different session concepts:\n * - tracked, the session has an id and is updated along the user navigation\n * - not tracked, the session does not have an id but it is updated along the user navigation\n * - inactive, no session in store or session expired, waiting for a renew session\n */\nexport function startSessionStore<TrackingType extends string>(\n  sessionStoreStrategyType: SessionStoreStrategyType,\n  productKey: string,\n  computeSessionState: (rawTrackingType?: string) => { trackingType: TrackingType; isTracked: boolean }\n): SessionStore {\n  const renewObservable = new Observable<void>()\n  const expireObservable = new Observable<void>()\n\n  const sessionStoreStrategy =\n    sessionStoreStrategyType.type === 'Cookie'\n      ? initCookieStrategy(sessionStoreStrategyType.cookieOptions)\n      : initLocalStorageStrategy()\n  const { clearSession, retrieveSession } = sessionStoreStrategy\n\n  const watchSessionTimeoutId = setInterval(watchSession, STORAGE_POLL_DELAY)\n  let sessionCache: SessionState = retrieveActiveSession()\n\n  function expandOrRenewSession() {\n    let isTracked: boolean\n    processSessionStoreOperations(\n      {\n        process: (sessionState) => {\n          const synchronizedSession = synchronizeSession(sessionState)\n          isTracked = expandOrRenewSessionState(synchronizedSession)\n          return synchronizedSession\n        },\n        after: (sessionState) => {\n          if (isTracked && !hasSessionInCache()) {\n            renewSessionInCache(sessionState)\n          }\n          sessionCache = sessionState\n        },\n      },\n      sessionStoreStrategy\n    )\n  }\n\n  function expandSession() {\n    processSessionStoreOperations(\n      {\n        process: (sessionState) => (hasSessionInCache() ? synchronizeSession(sessionState) : undefined),\n      },\n      sessionStoreStrategy\n    )\n  }\n\n  /**\n   * allows two behaviors:\n   * - if the session is active, synchronize the session cache without updating the session store\n   * - if the session is not active, clear the session store and expire the session cache\n   */\n  function watchSession() {\n    processSessionStoreOperations(\n      {\n        process: (sessionState) => (!isActiveSession(sessionState) ? {} : undefined),\n        after: synchronizeSession,\n      },\n      sessionStoreStrategy\n    )\n  }\n\n  function synchronizeSession(sessionState: SessionState) {\n    if (!isActiveSession(sessionState)) {\n      sessionState = {}\n    }\n    if (hasSessionInCache()) {\n      if (isSessionInCacheOutdated(sessionState)) {\n        expireSessionInCache()\n      } else {\n        sessionCache = sessionState\n      }\n    }\n    return sessionState\n  }\n\n  function expandOrRenewSessionState(sessionState: SessionState) {\n    const { trackingType, isTracked } = computeSessionState(sessionState[productKey])\n    sessionState[productKey] = trackingType\n    if (isTracked && !sessionState.id) {\n      sessionState.id = generateUUID()\n      sessionState.created = String(dateNow())\n    }\n    return isTracked\n  }\n\n  function hasSessionInCache() {\n    return sessionCache[productKey] !== undefined\n  }\n\n  function isSessionInCacheOutdated(sessionState: SessionState) {\n    return sessionCache.id !== sessionState.id || sessionCache[productKey] !== sessionState[productKey]\n  }\n\n  function expireSessionInCache() {\n    sessionCache = {}\n    expireObservable.notify()\n  }\n\n  function renewSessionInCache(sessionState: SessionState) {\n    sessionCache = sessionState\n    renewObservable.notify()\n  }\n\n  function retrieveActiveSession(): SessionState {\n    const session = retrieveSession()\n    if (isActiveSession(session)) {\n      return session\n    }\n    return {}\n  }\n\n  function isActiveSession(sessionState: SessionState) {\n    // created and expire can be undefined for versions which was not storing them\n    // these checks could be removed when older versions will not be available/live anymore\n    return (\n      (sessionState.created === undefined || dateNow() - Number(sessionState.created) < SESSION_TIME_OUT_DELAY) &&\n      (sessionState.expire === undefined || dateNow() < Number(sessionState.expire))\n    )\n  }\n\n  return {\n    expandOrRenewSession: throttle(expandOrRenewSession, STORAGE_POLL_DELAY).throttled,\n    expandSession,\n    getSession: () => sessionCache,\n    renewObservable,\n    expireObservable,\n    expire: () => {\n      clearSession()\n      synchronizeSession({})\n    },\n    stop: () => {\n      clearInterval(watchSessionTimeoutId)\n    },\n  }\n}\n","import { setTimeout } from '../../tools/timer'\nimport { generateUUID } from '../../tools/utils/stringUtils'\nimport type { SessionStoreStrategy } from './storeStrategies/sessionStoreStrategy'\nimport type { SessionState } from './sessionState'\nimport { expandSessionState, isSessionInExpiredState } from './sessionState'\n\ntype Operations = {\n  process: (sessionState: SessionState) => SessionState | undefined\n  after?: (sessionState: SessionState) => void\n}\n\nexport const LOCK_RETRY_DELAY = 10\nexport const LOCK_MAX_TRIES = 100\nconst bufferedOperations: Operations[] = []\nlet ongoingOperations: Operations | undefined\n\nexport function processSessionStoreOperations(\n  operations: Operations,\n  sessionStoreStrategy: SessionStoreStrategy,\n  numberOfRetries = 0\n) {\n  const { isLockEnabled, retrieveSession, persistSession, clearSession } = sessionStoreStrategy\n\n  if (!ongoingOperations) {\n    ongoingOperations = operations\n  }\n  if (operations !== ongoingOperations) {\n    bufferedOperations.push(operations)\n    return\n  }\n  if (isLockEnabled && numberOfRetries >= LOCK_MAX_TRIES) {\n    next(sessionStoreStrategy)\n    return\n  }\n  let currentLock: string\n  let currentSession = retrieveSession()\n  if (isLockEnabled) {\n    // if someone has lock, retry later\n    if (currentSession.lock) {\n      retryLater(operations, sessionStoreStrategy, numberOfRetries)\n      return\n    }\n    // acquire lock\n    currentLock = generateUUID()\n    currentSession.lock = currentLock\n    persistSession(currentSession)\n    // if lock is not acquired, retry later\n    currentSession = retrieveSession()\n    if (currentSession.lock !== currentLock) {\n      retryLater(operations, sessionStoreStrategy, numberOfRetries)\n      return\n    }\n  }\n  let processedSession = operations.process(currentSession)\n  if (isLockEnabled) {\n    // if lock corrupted after process, retry later\n    currentSession = retrieveSession()\n    if (currentSession.lock !== currentLock!) {\n      retryLater(operations, sessionStoreStrategy, numberOfRetries)\n      return\n    }\n  }\n  if (processedSession) {\n    if (isSessionInExpiredState(processedSession)) {\n      clearSession()\n    } else {\n      expandSessionState(processedSession)\n      persistSession(processedSession)\n    }\n  }\n  if (isLockEnabled) {\n    // correctly handle lock around expiration would require to handle this case properly at several levels\n    // since we don't have evidence of lock issues around expiration, let's just not do the corruption check for it\n    if (!(processedSession && isSessionInExpiredState(processedSession))) {\n      // if lock corrupted after persist, retry later\n      currentSession = retrieveSession()\n      if (currentSession.lock !== currentLock!) {\n        retryLater(operations, sessionStoreStrategy, numberOfRetries)\n        return\n      }\n      delete currentSession.lock\n      persistSession(currentSession)\n      processedSession = currentSession\n    }\n  }\n  // call after even if session is not persisted in order to perform operations on\n  // up-to-date session state value => the value could have been modified by another tab\n  operations.after?.(processedSession || currentSession)\n  next(sessionStoreStrategy)\n}\n\nfunction retryLater(operations: Operations, sessionStore: SessionStoreStrategy, currentNumberOfRetries: number) {\n  setTimeout(() => {\n    processSessionStoreOperations(operations, sessionStore, currentNumberOfRetries + 1)\n  }, LOCK_RETRY_DELAY)\n}\n\nfunction next(sessionStore: SessionStoreStrategy) {\n  ongoingOperations = undefined\n  const nextOperations = bufferedOperations.shift()\n  if (nextOperations) {\n    processSessionStoreOperations(nextOperations, sessionStore)\n  }\n}\n","import { isChromium } from '../../../tools/utils/browserDetection'\nimport type { CookieOptions } from '../../../browser/cookie'\nimport { getCurrentSite, areCookiesAuthorized, deleteCookie, getCookie, setCookie } from '../../../browser/cookie'\nimport type { InitConfiguration } from '../../configuration'\nimport { tryOldCookiesMigration } from '../oldCookiesMigration'\nimport { SESSION_EXPIRATION_DELAY } from '../sessionConstants'\nimport type { SessionState } from '../sessionState'\nimport { toSessionString, toSessionState } from '../sessionState'\nimport type { SessionStoreStrategy, SessionStoreStrategyType } from './sessionStoreStrategy'\nimport { SESSION_STORE_KEY } from './sessionStoreStrategy'\n\nexport function selectCookieStrategy(initConfiguration: InitConfiguration): SessionStoreStrategyType | undefined {\n  const cookieOptions = buildCookieOptions(initConfiguration)\n  return areCookiesAuthorized(cookieOptions) ? { type: 'Cookie', cookieOptions } : undefined\n}\n\nexport function initCookieStrategy(cookieOptions: CookieOptions): SessionStoreStrategy {\n  const cookieStore = {\n    /**\n     * Lock strategy allows mitigating issues due to concurrent access to cookie.\n     * This issue concerns only chromium browsers and enabling this on firefox increases cookie write failures.\n     */\n    isLockEnabled: isChromium(),\n    persistSession: persistSessionCookie(cookieOptions),\n    retrieveSession: retrieveSessionCookie,\n    clearSession: deleteSessionCookie(cookieOptions),\n  }\n\n  tryOldCookiesMigration(cookieStore)\n\n  return cookieStore\n}\n\nfunction persistSessionCookie(options: CookieOptions) {\n  return (session: SessionState) => {\n    setCookie(SESSION_STORE_KEY, toSessionString(session), SESSION_EXPIRATION_DELAY, options)\n  }\n}\n\nfunction retrieveSessionCookie(): SessionState {\n  const sessionString = getCookie(SESSION_STORE_KEY)\n  return toSessionState(sessionString)\n}\n\nfunction deleteSessionCookie(options: CookieOptions) {\n  return () => {\n    deleteCookie(SESSION_STORE_KEY, options)\n  }\n}\n\nexport function buildCookieOptions(initConfiguration: InitConfiguration) {\n  const cookieOptions: CookieOptions = {}\n\n  cookieOptions.secure = !!initConfiguration.useSecureSessionCookie || !!initConfiguration.useCrossSiteSessionCookie\n  cookieOptions.crossSite = !!initConfiguration.useCrossSiteSessionCookie\n\n  if (initConfiguration.trackSessionAcrossSubdomains) {\n    cookieOptions.domain = getCurrentSite()\n  }\n\n  return cookieOptions\n}\n","import { generateUUID } from '../../../tools/utils/stringUtils'\nimport type { SessionState } from '../sessionState'\nimport { toSessionString, toSessionState } from '../sessionState'\nimport type { SessionStoreStrategy, SessionStoreStrategyType } from './sessionStoreStrategy'\nimport { SESSION_STORE_KEY } from './sessionStoreStrategy'\n\nconst LOCAL_STORAGE_TEST_KEY = '_dd_test_'\n\nexport function selectLocalStorageStrategy(): SessionStoreStrategyType | undefined {\n  try {\n    const id = generateUUID()\n    const testKey = `${LOCAL_STORAGE_TEST_KEY}${id}`\n    localStorage.setItem(testKey, id)\n    const retrievedId = localStorage.getItem(testKey)\n    localStorage.removeItem(testKey)\n    return id === retrievedId ? { type: 'LocalStorage' } : undefined\n  } catch (e) {\n    return undefined\n  }\n}\n\nexport function initLocalStorageStrategy(): SessionStoreStrategy {\n  return {\n    isLockEnabled: false,\n    persistSession: persistInLocalStorage,\n    retrieveSession: retrieveSessionFromLocalStorage,\n    clearSession: clearSessionFromLocalStorage,\n  }\n}\n\nfunction persistInLocalStorage(sessionState: SessionState) {\n  localStorage.setItem(SESSION_STORE_KEY, toSessionString(sessionState))\n}\n\nfunction retrieveSessionFromLocalStorage(): SessionState {\n  const sessionString = localStorage.getItem(SESSION_STORE_KEY)\n  return toSessionState(sessionString)\n}\n\nfunction clearSessionFromLocalStorage() {\n  localStorage.removeItem(SESSION_STORE_KEY)\n}\n","import type { CookieOptions } from '../../../browser/cookie'\nimport type { SessionState } from '../sessionState'\n\nexport const SESSION_STORE_KEY = '_dd_s'\n\nexport type SessionStoreStrategyType = { type: 'Cookie'; cookieOptions: CookieOptions } | { type: 'LocalStorage' }\n\nexport interface SessionStoreStrategy {\n  isLockEnabled: boolean\n  persistSession: (session: SessionState) => void\n  retrieveSession: () => SessionState\n  clearSession: () => void\n}\n","import { getCookie } from '../../browser/cookie'\n\nexport const SYNTHETICS_TEST_ID_COOKIE_NAME = 'datadog-synthetics-public-id'\nexport const SYNTHETICS_RESULT_ID_COOKIE_NAME = 'datadog-synthetics-result-id'\nexport const SYNTHETICS_INJECTS_RUM_COOKIE_NAME = 'datadog-synthetics-injects-rum'\n\nexport interface BrowserWindow extends Window {\n  _DATADOG_SYNTHETICS_PUBLIC_ID?: unknown\n  _DATADOG_SYNTHETICS_RESULT_ID?: unknown\n  _DATADOG_SYNTHETICS_INJECTS_RUM?: unknown\n}\n\nexport function willSyntheticsInjectRum(): boolean {\n  return Boolean(\n    (window as BrowserWindow)._DATADOG_SYNTHETICS_INJECTS_RUM || getCookie(SYNTHETICS_INJECTS_RUM_COOKIE_NAME)\n  )\n}\n\nexport function getSyntheticsTestId(): string | undefined {\n  const value = (window as BrowserWindow)._DATADOG_SYNTHETICS_PUBLIC_ID || getCookie(SYNTHETICS_TEST_ID_COOKIE_NAME)\n  return typeof value === 'string' ? value : undefined\n}\n\nexport function getSyntheticsResultId(): string | undefined {\n  const value = (window as BrowserWindow)._DATADOG_SYNTHETICS_RESULT_ID || getCookie(SYNTHETICS_RESULT_ID_COOKIE_NAME)\n  return typeof value === 'string' ? value : undefined\n}\n","import type { TelemetryEvent, TelemetryConfigurationEvent } from './telemetryEvent.types'\n\nexport const TelemetryType = {\n  log: 'log',\n  configuration: 'configuration',\n} as const\n\nexport const enum StatusType {\n  debug = 'debug',\n  error = 'error',\n}\n\nexport interface RuntimeEnvInfo {\n  is_local_file: boolean\n  is_worker: boolean\n}\n\nexport type RawTelemetryEvent = TelemetryEvent['telemetry']\nexport type RawTelemetryConfiguration = TelemetryConfigurationEvent['telemetry']['configuration']\n","import type { Context } from '../../tools/serialisation/context'\nimport { ConsoleApiName } from '../../tools/display'\nimport { toStackTraceString, NO_ERROR_STACK_PRESENT_MESSAGE } from '../error/error'\nimport { getExperimentalFeatures } from '../../tools/experimentalFeatures'\nimport type { Configuration } from '../configuration'\nimport { INTAKE_SITE_STAGING, INTAKE_SITE_US1_FED } from '../configuration'\nimport type { StackTrace } from '../tracekit'\nimport { computeStackTrace } from '../tracekit'\nimport { Observable } from '../../tools/observable'\nimport { timeStampNow } from '../../tools/utils/timeUtils'\nimport { displayIfDebugEnabled, startMonitorErrorCollection } from '../../tools/monitor'\nimport { sendToExtension } from '../../tools/sendToExtension'\nimport { startsWith, arrayFrom, includes, assign } from '../../tools/utils/polyfills'\nimport { performDraw } from '../../tools/utils/numberUtils'\nimport { jsonStringify } from '../../tools/serialisation/jsonStringify'\nimport { combine } from '../../tools/mergeInto'\nimport { NonErrorPrefix } from '../error/error.types'\nimport type { TelemetryEvent } from './telemetryEvent.types'\nimport type { RawTelemetryConfiguration, RawTelemetryEvent, RuntimeEnvInfo } from './rawTelemetryEvent.types'\nimport { StatusType, TelemetryType } from './rawTelemetryEvent.types'\n\n// replaced at build time\ndeclare const __BUILD_ENV__SDK_VERSION__: string\n\nconst ALLOWED_FRAME_URLS = [\n  'https://www.datadoghq-browser-agent.com',\n  'https://www.datad0g-browser-agent.com',\n  'https://d3uc069fcn7uxw.cloudfront.net',\n  'https://d20xtzwzcl0ceb.cloudfront.net',\n  'http://localhost',\n  '<anonymous>',\n]\n\nexport const enum TelemetryService {\n  LOGS = 'browser-logs-sdk',\n  RUM = 'browser-rum-sdk',\n}\n\nexport interface Telemetry {\n  setContextProvider: (provider: () => Context) => void\n  observable: Observable<TelemetryEvent & Context>\n  enabled: boolean\n}\n\nconst TELEMETRY_EXCLUDED_SITES: string[] = [INTAKE_SITE_US1_FED]\n\nconst telemetryConfiguration: {\n  maxEventsPerPage: number\n  sentEventCount: number\n  telemetryEnabled: boolean\n  telemetryConfigurationEnabled: boolean\n} = { maxEventsPerPage: 0, sentEventCount: 0, telemetryEnabled: false, telemetryConfigurationEnabled: false }\n\nlet onRawTelemetryEventCollected: ((event: RawTelemetryEvent) => void) | undefined\n\nexport function startTelemetry(telemetryService: TelemetryService, configuration: Configuration): Telemetry {\n  let contextProvider: () => Context\n  const observable = new Observable<TelemetryEvent & Context>()\n\n  telemetryConfiguration.telemetryEnabled =\n    !includes(TELEMETRY_EXCLUDED_SITES, configuration.site) && performDraw(configuration.telemetrySampleRate)\n  telemetryConfiguration.telemetryConfigurationEnabled =\n    telemetryConfiguration.telemetryEnabled && performDraw(configuration.telemetryConfigurationSampleRate)\n\n  const runtimeEnvInfo = getRuntimeEnvInfo()\n  onRawTelemetryEventCollected = (rawEvent: RawTelemetryEvent) => {\n    if (telemetryConfiguration.telemetryEnabled) {\n      const event = toTelemetryEvent(telemetryService, rawEvent, runtimeEnvInfo)\n      observable.notify(event)\n      sendToExtension('telemetry', event)\n    }\n  }\n  startMonitorErrorCollection(addTelemetryError)\n\n  assign(telemetryConfiguration, {\n    maxEventsPerPage: configuration.maxTelemetryEventsPerPage,\n    sentEventCount: 0,\n  })\n\n  function toTelemetryEvent(\n    telemetryService: TelemetryService,\n    event: RawTelemetryEvent,\n    runtimeEnvInfo: RuntimeEnvInfo\n  ): TelemetryEvent & Context {\n    return combine(\n      {\n        type: 'telemetry' as const,\n        date: timeStampNow(),\n        service: telemetryService,\n        version: __BUILD_ENV__SDK_VERSION__,\n        source: 'browser' as const,\n        _dd: {\n          format_version: 2 as const,\n        },\n        telemetry: combine(event, {\n          runtime_env: runtimeEnvInfo,\n        }),\n        experimental_features: arrayFrom(getExperimentalFeatures()),\n      },\n      contextProvider !== undefined ? contextProvider() : {}\n    ) as TelemetryEvent & Context\n  }\n\n  return {\n    setContextProvider: (provider: () => Context) => {\n      contextProvider = provider\n    },\n    observable,\n    enabled: telemetryConfiguration.telemetryEnabled,\n  }\n}\nfunction getRuntimeEnvInfo(): RuntimeEnvInfo {\n  return {\n    is_local_file: window.location.protocol === 'file:',\n    is_worker: 'WorkerGlobalScope' in self,\n  }\n}\n\nexport function startFakeTelemetry() {\n  const events: RawTelemetryEvent[] = []\n  assign(telemetryConfiguration, {\n    maxEventsPerPage: Infinity,\n    sentEventCount: 0,\n  })\n\n  onRawTelemetryEventCollected = (event: RawTelemetryEvent) => {\n    events.push(event)\n  }\n\n  return events\n}\n\nexport function resetTelemetry() {\n  onRawTelemetryEventCollected = undefined\n}\n\n/**\n * Avoid mixing telemetry events from different data centers\n * but keep replicating staging events for reliability\n */\nexport function isTelemetryReplicationAllowed(configuration: Configuration) {\n  return configuration.site === INTAKE_SITE_STAGING\n}\n\nexport function addTelemetryDebug(message: string, context?: Context) {\n  displayIfDebugEnabled(ConsoleApiName.debug, message, context)\n  addTelemetry(\n    assign(\n      {\n        type: TelemetryType.log,\n        message,\n        status: StatusType.debug,\n      },\n      context\n    )\n  )\n}\n\nexport function addTelemetryError(e: unknown, context?: Context) {\n  addTelemetry(\n    assign(\n      {\n        type: TelemetryType.log,\n        status: StatusType.error,\n      },\n      formatError(e),\n      context\n    )\n  )\n}\n\nexport function addTelemetryConfiguration(configuration: RawTelemetryConfiguration) {\n  if (telemetryConfiguration.telemetryConfigurationEnabled) {\n    addTelemetry({\n      type: TelemetryType.configuration,\n      configuration,\n    })\n  }\n}\n\nfunction addTelemetry(event: RawTelemetryEvent) {\n  if (onRawTelemetryEventCollected && telemetryConfiguration.sentEventCount < telemetryConfiguration.maxEventsPerPage) {\n    telemetryConfiguration.sentEventCount += 1\n    onRawTelemetryEventCollected(event)\n  }\n}\n\nexport function formatError(e: unknown) {\n  if (e instanceof Error) {\n    const stackTrace = computeStackTrace(e)\n    return {\n      error: {\n        kind: stackTrace.name,\n        stack: toStackTraceString(scrubCustomerFrames(stackTrace)),\n      },\n      message: stackTrace.message!,\n    }\n  }\n  return {\n    error: {\n      stack: NO_ERROR_STACK_PRESENT_MESSAGE,\n    },\n    message: `${NonErrorPrefix.UNCAUGHT} ${jsonStringify(e)!}`,\n  }\n}\n\nexport function scrubCustomerFrames(stackTrace: StackTrace) {\n  stackTrace.stack = stackTrace.stack.filter(\n    (frame) => !frame.url || ALLOWED_FRAME_URLS.some((allowedFrameUrl) => startsWith(frame.url!, allowedFrameUrl))\n  )\n  return stackTrace\n}\n","import { startsWith } from '../../tools/utils/polyfills'\nimport type { StackTrace, StackFrame } from './types'\n\nconst UNKNOWN_FUNCTION = '?'\n\n/**\n * Computes a stack trace for an exception.\n */\nexport function computeStackTrace(ex: unknown): StackTrace {\n  const stack: StackFrame[] = []\n\n  let stackProperty = tryToGetString(ex, 'stack')\n  const exString = String(ex)\n  if (stackProperty && startsWith(stackProperty, exString)) {\n    stackProperty = stackProperty.slice(exString.length)\n  }\n  if (stackProperty) {\n    stackProperty.split('\\n').forEach((line) => {\n      const stackFrame =\n        parseChromeLine(line) || parseChromeAnonymousLine(line) || parseWinLine(line) || parseGeckoLine(line)\n      if (stackFrame) {\n        if (!stackFrame.func && stackFrame.line) {\n          stackFrame.func = UNKNOWN_FUNCTION\n        }\n\n        stack.push(stackFrame)\n      }\n    })\n  }\n\n  return {\n    message: tryToGetString(ex, 'message'),\n    name: tryToGetString(ex, 'name'),\n    stack,\n  }\n}\nconst fileUrl = '((?:file|https?|blob|chrome-extension|native|eval|webpack|snippet|<anonymous>|\\\\w+\\\\.|\\\\/).*?)'\nconst filePosition = '(?::(\\\\d+))'\nconst CHROME_LINE_RE = new RegExp(`^\\\\s*at (.*?) ?\\\\(${fileUrl}${filePosition}?${filePosition}?\\\\)?\\\\s*$`, 'i')\n\nconst CHROME_EVAL_RE = new RegExp(`\\\\((\\\\S*)${filePosition}${filePosition}\\\\)`)\n\nfunction parseChromeLine(line: string): StackFrame | undefined {\n  const parts = CHROME_LINE_RE.exec(line)\n\n  if (!parts) {\n    return\n  }\n\n  const isNative = parts[2] && parts[2].indexOf('native') === 0 // start of line\n  const isEval = parts[2] && parts[2].indexOf('eval') === 0 // start of line\n  const submatch = CHROME_EVAL_RE.exec(parts[2])\n\n  if (isEval && submatch) {\n    // throw out eval line/column and use top-most line/column number\n    parts[2] = submatch[1] // url\n    parts[3] = submatch[2] // line\n    parts[4] = submatch[3] // column\n  }\n\n  return {\n    args: isNative ? [parts[2]] : [],\n    column: parts[4] ? +parts[4] : undefined,\n    func: parts[1] || UNKNOWN_FUNCTION,\n    line: parts[3] ? +parts[3] : undefined,\n    url: !isNative ? parts[2] : undefined,\n  }\n}\n\nconst CHROME_ANONYMOUS_FUNCTION_RE = new RegExp(`^\\\\s*at ?${fileUrl}${filePosition}?${filePosition}??\\\\s*$`, 'i')\n\nfunction parseChromeAnonymousLine(line: string): StackFrame | undefined {\n  const parts = CHROME_ANONYMOUS_FUNCTION_RE.exec(line)\n\n  if (!parts) {\n    return\n  }\n\n  return {\n    args: [],\n    column: parts[3] ? +parts[3] : undefined,\n    func: UNKNOWN_FUNCTION,\n    line: parts[2] ? +parts[2] : undefined,\n    url: parts[1],\n  }\n}\n\nconst WINJS_LINE_RE =\n  /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i\n\nfunction parseWinLine(line: string): StackFrame | undefined {\n  const parts = WINJS_LINE_RE.exec(line)\n  if (!parts) {\n    return\n  }\n\n  return {\n    args: [],\n    column: parts[4] ? +parts[4] : undefined,\n    func: parts[1] || UNKNOWN_FUNCTION,\n    line: +parts[3],\n    url: parts[2],\n  }\n}\n\nconst GECKO_LINE_RE =\n  /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\\[native).*?|[^@]*bundle)(?::(\\d+))?(?::(\\d+))?\\s*$/i\nconst GECKO_EVAL_RE = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i\n\nfunction parseGeckoLine(line: string): StackFrame | undefined {\n  const parts = GECKO_LINE_RE.exec(line)\n  if (!parts) {\n    return\n  }\n\n  const isEval = parts[3] && parts[3].indexOf(' > eval') > -1\n  const submatch = GECKO_EVAL_RE.exec(parts[3])\n\n  if (isEval && submatch) {\n    // throw out eval line/column and use top-most line number\n    parts[3] = submatch[1]\n    parts[4] = submatch[2]\n    parts[5] = undefined! // no column when eval\n  }\n\n  return {\n    args: parts[2] ? parts[2].split(',') : [],\n    column: parts[5] ? +parts[5] : undefined,\n    func: parts[1] || UNKNOWN_FUNCTION,\n    line: parts[4] ? +parts[4] : undefined,\n    url: parts[3],\n  }\n}\n\nfunction tryToGetString(candidate: unknown, property: string) {\n  if (typeof candidate !== 'object' || !candidate || !(property in candidate)) {\n    return undefined\n  }\n  const value = (candidate as { [k: string]: unknown })[property]\n  return typeof value === 'string' ? value : undefined\n}\n","import { instrumentMethodAndCallOriginal } from '../../tools/instrumentMethod'\nimport { computeStackTrace } from './computeStackTrace'\nimport type { UnhandledErrorCallback, StackTrace } from './types'\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Error_types\nconst ERROR_TYPES_RE =\n  /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\\s\\S]*)$/\n\n/**\n * Cross-browser collection of unhandled errors\n *\n * Supports:\n * - Firefox: full stack trace with line numbers, plus column number\n * on top frame; column number is not guaranteed\n * - Opera: full stack trace with line and column numbers\n * - Chrome: full stack trace with line and column numbers\n * - Safari: line and column number for the top frame only; some frames\n * may be missing, and column number is not guaranteed\n * - IE: line and column number for the top frame only; some frames\n * may be missing, and column number is not guaranteed\n *\n * In theory, TraceKit should work on all of the following versions:\n * - IE5.5+ (only 8.0 tested)\n * - Firefox 0.9+ (only 3.5+ tested)\n * - Opera 7+ (only 10.50 tested; versions 9 and earlier may require\n * Exceptions Have Stacktrace to be enabled in opera:config)\n * - Safari 3+ (only 4+ tested)\n * - Chrome 1+ (only 5+ tested)\n * - Konqueror 3.5+ (untested)\n *\n * Tries to catch all unhandled errors and report them to the\n * callback.\n *\n * Callbacks receive a StackTrace object as described in the\n * computeStackTrace docs.\n *\n * @memberof TraceKit\n * @namespace\n */\n\nexport function startUnhandledErrorCollection(callback: UnhandledErrorCallback) {\n  const { stop: stopInstrumentingOnError } = instrumentOnError(callback)\n  const { stop: stopInstrumentingOnUnhandledRejection } = instrumentUnhandledRejection(callback)\n\n  return {\n    stop: () => {\n      stopInstrumentingOnError()\n      stopInstrumentingOnUnhandledRejection()\n    },\n  }\n}\n\n/**\n * Install a global onerror handler\n */\nfunction instrumentOnError(callback: UnhandledErrorCallback) {\n  return instrumentMethodAndCallOriginal(window, 'onerror', {\n    before(this: any, messageObj: unknown, url?: string, line?: number, column?: number, errorObj?: unknown) {\n      let stackTrace: StackTrace\n      if (errorObj instanceof Error) {\n        stackTrace = computeStackTrace(errorObj)\n      } else {\n        const stack = [{ url, column, line }]\n        const { name, message } = tryToParseMessage(messageObj)\n        stackTrace = {\n          name,\n          message,\n          stack,\n        }\n      }\n      callback(stackTrace, errorObj ?? messageObj)\n    },\n  })\n}\n\nfunction tryToParseMessage(messageObj: unknown) {\n  let name\n  let message\n  if ({}.toString.call(messageObj) === '[object String]') {\n    ;[, name, message] = ERROR_TYPES_RE.exec(messageObj as string)!\n  }\n  return { name, message }\n}\n\n/**\n * Install a global onunhandledrejection handler\n */\nfunction instrumentUnhandledRejection(callback: UnhandledErrorCallback) {\n  return instrumentMethodAndCallOriginal(window, 'onunhandledrejection', {\n    before(e: PromiseRejectionEvent) {\n      const reason = e.reason || 'Empty reason'\n      const stack = computeStackTrace(reason)\n      callback(stack, reason)\n    },\n  })\n}\n","import type { Context } from '../../tools/serialisation/context'\nimport { display } from '../../tools/display'\nimport { getType } from '../../tools/utils/typeUtils'\nimport { assign } from '../../tools/utils/polyfills'\nimport type { User } from './user.types'\n\n/**\n * Clone input data and ensure known user properties (id, name, email)\n * are strings, as defined here:\n * https://docs.datadoghq.com/logs/log_configuration/attributes_naming_convention/#user-related-attributes\n */\nexport function sanitizeUser(newUser: Context): Context {\n  // We shallow clone only to prevent mutation of user data.\n  const user = assign({}, newUser)\n  const keys = ['id', 'name', 'email']\n  keys.forEach((key) => {\n    if (key in user) {\n      user[key] = String(user[key])\n    }\n  })\n  return user\n}\n\n/**\n * Simple check to ensure user is valid\n */\nexport function checkUser(newUser: User): boolean {\n  const isValid = getType(newUser) === 'object'\n  if (!isValid) {\n    display.error('Unsupported user:', newUser)\n  }\n  return isValid\n}\n","import type { Subscription } from './observable'\n\n/**\n * Type helper to extract event types that have \"void\" data. This allows to call `notify` without a\n * second argument. Ex:\n *\n * ```\n * interface EventMap {\n *   foo: void\n * }\n * const LifeCycle = AbstractLifeCycle<EventMap>\n * new LifeCycle().notify('foo')\n * ```\n */\ntype EventTypesWithoutData<EventMap> = {\n  [K in keyof EventMap]: EventMap[K] extends void ? K : never\n}[keyof EventMap]\n\nexport class AbstractLifeCycle<EventMap> {\n  private callbacks: { [key in keyof EventMap]?: Array<(data: any) => void> } = {}\n\n  notify<EventType extends EventTypesWithoutData<EventMap>>(eventType: EventType): void\n  notify<EventType extends keyof EventMap>(eventType: EventType, data: EventMap[EventType]): void\n  notify(eventType: keyof EventMap, data?: unknown) {\n    const eventCallbacks = this.callbacks[eventType]\n    if (eventCallbacks) {\n      eventCallbacks.forEach((callback) => callback(data))\n    }\n  }\n\n  subscribe<EventType extends keyof EventMap>(\n    eventType: EventType,\n    callback: (data: EventMap[EventType]) => void\n  ): Subscription {\n    if (!this.callbacks[eventType]) {\n      this.callbacks[eventType] = []\n    }\n    this.callbacks[eventType]!.push(callback)\n    return {\n      unsubscribe: () => {\n        this.callbacks[eventType] = this.callbacks[eventType]!.filter((other) => callback !== other)\n      },\n    }\n  }\n}\n","const BUFFER_LIMIT = 500\n\nexport class BoundedBuffer {\n  private buffer: Array<() => void> = []\n\n  add(callback: () => void) {\n    const length = this.buffer.push(callback)\n    if (length > BUFFER_LIMIT) {\n      this.buffer.splice(0, 1)\n    }\n  }\n\n  drain() {\n    this.buffer.forEach((callback) => callback())\n    this.buffer.length = 0\n  }\n}\n","import { display } from './display'\n\nexport function catchUserErrors<Args extends any[], R>(fn: (...args: Args) => R, errorMsg: string) {\n  return (...args: Args) => {\n    try {\n      return fn(...args)\n    } catch (err) {\n      display.error(errorMsg, err)\n    }\n  }\n}\n","/* eslint-disable local-rules/disallow-side-effects */\n/**\n * Keep references on console methods to avoid triggering patched behaviors\n *\n * NB: in some setup, console could already be patched by another SDK.\n * In this case, some display messages can be sent by the other SDK\n * but we should be safe from infinite loop nonetheless.\n */\n\nexport const ConsoleApiName = {\n  log: 'log',\n  debug: 'debug',\n  info: 'info',\n  warn: 'warn',\n  error: 'error',\n} as const\n\nexport type ConsoleApiName = (typeof ConsoleApiName)[keyof typeof ConsoleApiName]\n\ninterface Display {\n  debug: typeof console.debug\n  log: typeof console.log\n  info: typeof console.info\n  warn: typeof console.warn\n  error: typeof console.error\n}\n\n/**\n * When building JS bundles, some users might use a plugin[1] or configuration[2] to remove\n * \"console.*\" references. This causes some issue as we expect `console.*` to be defined.\n * As a workaround, let's use a variable alias, so those expressions won't be taken into account by\n * simple static analysis.\n *\n * [1]: https://babeljs.io/docs/babel-plugin-transform-remove-console/\n * [2]: https://github.com/terser/terser#compress-options (look for drop_console)\n */\nexport const globalConsole = console\n\nexport const originalConsoleMethods = {} as Display\nObject.keys(ConsoleApiName).forEach((name) => {\n  originalConsoleMethods[name as ConsoleApiName] = globalConsole[name as ConsoleApiName]\n})\n\nconst PREFIX = 'Datadog Browser SDK:'\n\nexport const display: Display = {\n  debug: originalConsoleMethods.debug.bind(globalConsole, PREFIX),\n  log: originalConsoleMethods.log.bind(globalConsole, PREFIX),\n  info: originalConsoleMethods.info.bind(globalConsole, PREFIX),\n  warn: originalConsoleMethods.warn.bind(globalConsole, PREFIX),\n  error: originalConsoleMethods.error.bind(globalConsole, PREFIX),\n}\n","/**\n * LIMITATION:\n * For NPM setup, this feature flag singleton is shared between RUM and Logs product.\n * This means that an experimental flag set on the RUM product will be set on the Logs product.\n * So keep in mind that in certain configurations, your experimental feature flag may affect other products.\n *\n * FORMAT:\n * All feature flags should be snake_cased\n */\n// We want to use a real enum (i.e. not a const enum) here, to be able to check whether an arbitrary\n// string is an expected feature flag\n// eslint-disable-next-line no-restricted-syntax\nexport enum ExperimentalFeature {\n  PAGEHIDE = 'pagehide',\n  FEATURE_FLAGS = 'feature_flags',\n  RESOURCE_PAGE_STATES = 'resource_page_states',\n  PAGE_STATES = 'page_states',\n  COLLECT_FLUSH_REASON = 'collect_flush_reason',\n  NO_RESOURCE_DURATION_FROZEN_STATE = 'no_resource_duration_frozen_state',\n  SCROLLMAP = 'scrollmap',\n  INTERACTION_TO_NEXT_PAINT = 'interaction_to_next_paint',\n  WEB_VITALS_ATTRIBUTION = 'web_vitals_attribution',\n  DISABLE_REPLAY_INLINE_CSS = 'disable_replay_inline_css',\n}\n\nconst enabledExperimentalFeatures: Set<ExperimentalFeature> = new Set()\n\nexport function addExperimentalFeatures(enabledFeatures: ExperimentalFeature[]): void {\n  enabledFeatures.forEach((flag) => {\n    enabledExperimentalFeatures.add(flag)\n  })\n}\n\nexport function isExperimentalFeatureEnabled(featureName: ExperimentalFeature): boolean {\n  return enabledExperimentalFeatures.has(featureName)\n}\n\nexport function resetExperimentalFeatures(): void {\n  enabledExperimentalFeatures.clear()\n}\n\nexport function getExperimentalFeatures(): Set<ExperimentalFeature> {\n  return enabledExperimentalFeatures\n}\n","/**\n * inspired by https://mathiasbynens.be/notes/globalthis\n */\n\nexport function getGlobalObject<T = typeof globalThis>(): T {\n  if (typeof globalThis === 'object') {\n    return globalThis as unknown as T\n  }\n  Object.defineProperty(Object.prototype, '_dd_temp_', {\n    get() {\n      return this as object\n    },\n    configurable: true,\n  })\n  // @ts-ignore _dd_temp is defined using defineProperty\n  let globalObject: unknown = _dd_temp_\n  // @ts-ignore _dd_temp is defined using defineProperty\n  delete Object.prototype._dd_temp_\n  if (typeof globalObject !== 'object') {\n    // on safari _dd_temp_ is available on window but not globally\n    // fallback on other browser globals check\n    if (typeof self === 'object') {\n      globalObject = self\n    } else if (typeof window === 'object') {\n      globalObject = window\n    } else {\n      globalObject = {}\n    }\n  }\n  return globalObject as T\n}\n","import { getGlobalObject } from './getGlobalObject'\n\nexport interface BrowserWindowWithZoneJs extends Window {\n  Zone?: {\n    // All Zone.js versions expose the __symbol__ method, but we observed that some website have a\n    // 'Zone' global variable unrelated to Zone.js, so let's consider this method optional\n    // nonetheless.\n    __symbol__?: (name: string) => string\n  }\n}\n\n/**\n * Gets the original value for a DOM API that was potentially patched by Zone.js.\n *\n * Zone.js[1] is a library that patches a bunch of JS and DOM APIs. It usually stores the original\n * value of the patched functions/constructors/methods in a hidden property prefixed by\n * __zone_symbol__.\n *\n * In multiple occasions, we observed that Zone.js is the culprit of important issues leading to\n * browser resource exhaustion (memory leak, high CPU usage). This method is used as a workaround to\n * use the original DOM API instead of the one patched by Zone.js.\n *\n * [1]: https://github.com/angular/angular/tree/main/packages/zone.js\n */\nexport function getZoneJsOriginalValue<Target, Name extends keyof Target & string>(\n  target: Target,\n  name: Name\n): Target[Name] {\n  const browserWindow = getGlobalObject<BrowserWindowWithZoneJs>()\n  let original: Target[Name] | undefined\n  if (browserWindow.Zone && typeof browserWindow.Zone.__symbol__ === 'function') {\n    original = (target as any)[browserWindow.Zone.__symbol__(name)]\n  }\n  if (!original) {\n    original = target[name]\n  }\n  return original\n}\n","import { setTimeout } from './timer'\nimport { callMonitored } from './monitor'\nimport { noop } from './utils/functionUtils'\n\nexport function instrumentMethod<OBJECT extends { [key: string]: any }, METHOD extends keyof OBJECT>(\n  object: OBJECT,\n  method: METHOD,\n  instrumentationFactory: (\n    original: OBJECT[METHOD]\n  ) => (this: OBJECT, ...args: Parameters<OBJECT[METHOD]>) => ReturnType<OBJECT[METHOD]>\n) {\n  const original = object[method]\n\n  let instrumentation = instrumentationFactory(original)\n\n  const instrumentationWrapper = function (this: OBJECT): ReturnType<OBJECT[METHOD]> | undefined {\n    if (typeof instrumentation !== 'function') {\n      return undefined\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return instrumentation.apply(this, arguments as unknown as Parameters<OBJECT[METHOD]>)\n  }\n  object[method] = instrumentationWrapper as OBJECT[METHOD]\n\n  return {\n    stop: () => {\n      if (object[method] === instrumentationWrapper) {\n        object[method] = original\n      } else {\n        instrumentation = original\n      }\n    },\n  }\n}\n\nexport function instrumentMethodAndCallOriginal<OBJECT extends { [key: string]: any }, METHOD extends keyof OBJECT>(\n  object: OBJECT,\n  method: METHOD,\n  {\n    before,\n    after,\n  }: {\n    before?: (this: OBJECT, ...args: Parameters<OBJECT[METHOD]>) => void\n    after?: (this: OBJECT, ...args: Parameters<OBJECT[METHOD]>) => void\n  }\n) {\n  return instrumentMethod(\n    object,\n    method,\n    (original) =>\n      function () {\n        const args = arguments as unknown as Parameters<OBJECT[METHOD]>\n        let result\n\n        if (before) {\n          callMonitored(before, this, args)\n        }\n\n        if (typeof original === 'function') {\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n          result = original.apply(this, args)\n        }\n\n        if (after) {\n          callMonitored(after, this, args)\n        }\n\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return result\n      }\n  )\n}\n\nexport function instrumentSetter<OBJECT extends { [key: string]: any }, PROPERTY extends keyof OBJECT>(\n  object: OBJECT,\n  property: PROPERTY,\n  after: (thisObject: OBJECT, value: OBJECT[PROPERTY]) => void\n) {\n  const originalDescriptor = Object.getOwnPropertyDescriptor(object, property)\n  if (!originalDescriptor || !originalDescriptor.set || !originalDescriptor.configurable) {\n    return { stop: noop }\n  }\n\n  let instrumentation = (thisObject: OBJECT, value: OBJECT[PROPERTY]) => {\n    // put hooked setter into event loop to avoid of set latency\n    setTimeout(() => {\n      after(thisObject, value)\n    }, 0)\n  }\n\n  const instrumentationWrapper = function (this: OBJECT, value: OBJECT[PROPERTY]) {\n    originalDescriptor.set!.call(this, value)\n    instrumentation(this, value)\n  }\n\n  Object.defineProperty(object, property, {\n    set: instrumentationWrapper,\n  })\n\n  return {\n    stop: () => {\n      if (Object.getOwnPropertyDescriptor(object, property)?.set === instrumentationWrapper) {\n        Object.defineProperty(object, property, originalDescriptor)\n      } else {\n        instrumentation = noop\n      }\n    },\n  }\n}\n","import { getType } from './utils/typeUtils'\n\ntype Merged<TDestination, TSource> =\n  // case 1 - source is undefined - return destination\n  TSource extends undefined\n    ? TDestination\n    : // case 2 - destination is undefined - return source\n    TDestination extends undefined\n    ? TSource\n    : // case 3 - source is an array - see if it merges or overwrites\n    TSource extends any[]\n    ? TDestination extends any[]\n      ? TDestination & TSource\n      : TSource\n    : // case 4 - source is an object - see if it merges or overwrites\n    TSource extends object\n    ? TDestination extends object\n      ? TDestination extends any[]\n        ? TSource\n        : TDestination & TSource\n      : TSource\n    : // case 5 - cannot merge - return source\n      TSource\n\n/**\n * Iterate over source and affect its sub values into destination, recursively.\n * If the source and destination can't be merged, return source.\n */\nexport function mergeInto<D, S>(\n  destination: D,\n  source: S,\n  circularReferenceChecker = createCircularReferenceChecker()\n): Merged<D, S> {\n  // ignore the source if it is undefined\n  if (source === undefined) {\n    return destination as Merged<D, S>\n  }\n\n  if (typeof source !== 'object' || source === null) {\n    // primitive values - just return source\n    return source as Merged<D, S>\n  } else if (source instanceof Date) {\n    return new Date(source.getTime()) as unknown as Merged<D, S>\n  } else if (source instanceof RegExp) {\n    const flags =\n      source.flags ||\n      // old browsers compatibility\n      [\n        source.global ? 'g' : '',\n        source.ignoreCase ? 'i' : '',\n        source.multiline ? 'm' : '',\n        source.sticky ? 'y' : '',\n        source.unicode ? 'u' : '',\n      ].join('')\n    return new RegExp(source.source, flags) as unknown as Merged<D, S>\n  }\n\n  if (circularReferenceChecker.hasAlreadyBeenSeen(source)) {\n    // remove circular references\n    return undefined as unknown as Merged<D, S>\n  } else if (Array.isArray(source)) {\n    const merged: any[] = Array.isArray(destination) ? destination : []\n    for (let i = 0; i < source.length; ++i) {\n      merged[i] = mergeInto(merged[i], source[i], circularReferenceChecker)\n    }\n    return merged as unknown as Merged<D, S>\n  }\n\n  const merged = getType(destination) === 'object' ? (destination as Record<any, any>) : {}\n  for (const key in source) {\n    if (Object.prototype.hasOwnProperty.call(source, key)) {\n      merged[key] = mergeInto(merged[key], source[key], circularReferenceChecker)\n    }\n  }\n  return merged as unknown as Merged<D, S>\n}\n\n/**\n * A simplistic implementation of a deep clone algorithm.\n * Caveats:\n * - It doesn't maintain prototype chains - don't use with instances of custom classes.\n * - It doesn't handle Map and Set\n */\nexport function deepClone<T>(value: T): T {\n  return mergeInto(undefined, value) as T\n}\n\ntype Combined<A, B> = A extends null ? B : B extends null ? A : Merged<A, B>\n\n/*\n * Performs a deep merge of objects and arrays.\n * - Arguments won't be mutated\n * - Object and arrays in the output value are de-referenced (\"deep cloned\")\n * - Arrays values are merged index by index\n * - Objects are merged by keys\n * - Values get replaced, unless undefined\n */\nexport function combine<A, B>(a: A, b: B): Combined<A, B>\nexport function combine<A, B, C>(a: A, b: B, c: C): Combined<Combined<A, B>, C>\nexport function combine<A, B, C, D>(a: A, b: B, c: C, d: D): Combined<Combined<Combined<A, B>, C>, D>\nexport function combine<A, B, C, D, E>(\n  a: A,\n  b: B,\n  c: C,\n  d: D,\n  e: E\n): Combined<Combined<Combined<Combined<A, B>, C>, D>, E>\nexport function combine<A, B, C, D, E, F>(\n  a: A,\n  b: B,\n  c: C,\n  d: D,\n  e: E,\n  f: F\n): Combined<Combined<Combined<Combined<Combined<A, B>, C>, D>, E>, F>\nexport function combine<A, B, C, D, E, F, G>(\n  a: A,\n  b: B,\n  c: C,\n  d: D,\n  e: E,\n  f: F,\n  g: G\n): Combined<Combined<Combined<Combined<Combined<Combined<A, B>, C>, D>, E>, F>, G>\nexport function combine<A, B, C, D, E, F, G, H>(\n  a: A,\n  b: B,\n  c: C,\n  d: D,\n  e: E,\n  f: F,\n  g: G,\n  h: H\n): Combined<Combined<Combined<Combined<Combined<Combined<Combined<A, B>, C>, D>, E>, F>, G>, H>\nexport function combine(...sources: any[]): unknown {\n  let destination: any\n\n  for (const source of sources) {\n    // Ignore any undefined or null sources.\n    if (source === undefined || source === null) {\n      continue\n    }\n\n    destination = mergeInto(destination, source)\n  }\n\n  return destination as unknown\n}\n\ninterface CircularReferenceChecker {\n  hasAlreadyBeenSeen(value: any): boolean\n}\n\nfunction createCircularReferenceChecker(): CircularReferenceChecker {\n  if (typeof WeakSet !== 'undefined') {\n    const set: WeakSet<any> = new WeakSet()\n    return {\n      hasAlreadyBeenSeen(value) {\n        const has = set.has(value)\n        if (!has) {\n          set.add(value)\n        }\n        return has\n      },\n    }\n  }\n  const array: any[] = []\n  return {\n    hasAlreadyBeenSeen(value) {\n      const has = array.indexOf(value) >= 0\n      if (!has) {\n        array.push(value)\n      }\n      return has\n    },\n  }\n}\n","import { display } from './display'\n\nlet onMonitorErrorCollected: undefined | ((error: unknown) => void)\nlet debugMode = false\n\nexport function startMonitorErrorCollection(newOnMonitorErrorCollected: (error: unknown) => void) {\n  onMonitorErrorCollected = newOnMonitorErrorCollected\n}\n\nexport function setDebugMode(newDebugMode: boolean) {\n  debugMode = newDebugMode\n}\n\nexport function resetMonitor() {\n  onMonitorErrorCollected = undefined\n  debugMode = false\n}\n\nexport function monitored<T extends (...params: any[]) => unknown>(\n  _: any,\n  __: string,\n  descriptor: TypedPropertyDescriptor<T>\n) {\n  const originalMethod = descriptor.value!\n  descriptor.value = function (this: any, ...args: Parameters<T>) {\n    const decorated = onMonitorErrorCollected ? monitor(originalMethod) : originalMethod\n    return decorated.apply(this, args) as ReturnType<T>\n  } as T\n}\n\nexport function monitor<T extends (...args: any[]) => any>(fn: T): T {\n  return function (this: any) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return callMonitored(fn, this, arguments as unknown as Parameters<T>)\n  } as unknown as T // consider output type has input type\n}\n\nexport function callMonitored<T extends (...args: any[]) => any>(\n  fn: T,\n  context: ThisParameterType<T>,\n  args: Parameters<T>\n): ReturnType<T> | undefined\nexport function callMonitored<T extends (this: void) => any>(fn: T): ReturnType<T> | undefined\nexport function callMonitored<T extends (...args: any[]) => any>(\n  fn: T,\n  context?: any,\n  args?: any\n): ReturnType<T> | undefined {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return fn.apply(context, args)\n  } catch (e) {\n    displayIfDebugEnabled(e)\n    if (onMonitorErrorCollected) {\n      try {\n        onMonitorErrorCollected(e)\n      } catch (e) {\n        displayIfDebugEnabled(e)\n      }\n    }\n  }\n}\n\nexport function displayIfDebugEnabled(...args: any[]) {\n  if (debugMode) {\n    display.error('[MONITOR]', ...args)\n  }\n}\n","export interface Subscription {\n  unsubscribe: () => void\n}\n\nexport class Observable<T> {\n  private observers: Array<(data: T) => void> = []\n  private onLastUnsubscribe?: () => void\n\n  constructor(private onFirstSubscribe?: () => (() => void) | void) {}\n\n  subscribe(f: (data: T) => void): Subscription {\n    if (!this.observers.length && this.onFirstSubscribe) {\n      this.onLastUnsubscribe = this.onFirstSubscribe() || undefined\n    }\n    this.observers.push(f)\n    return {\n      unsubscribe: () => {\n        this.observers = this.observers.filter((other) => f !== other)\n        if (!this.observers.length && this.onLastUnsubscribe) {\n          this.onLastUnsubscribe()\n        }\n      },\n    }\n  }\n\n  notify(data: T) {\n    this.observers.forEach((observer) => observer(data))\n  }\n}\n\nexport function mergeObservables<T>(...observables: Array<Observable<T>>) {\n  const globalObservable = new Observable<T>(() => {\n    const subscriptions: Subscription[] = observables.map((observable) =>\n      observable.subscribe((data) => globalObservable.notify(data))\n    )\n    return () => subscriptions.forEach((subscription) => subscription.unsubscribe())\n  })\n\n  return globalObservable\n}\n","import { monitor } from './monitor'\nimport { noop } from './utils/functionUtils'\n\ntype Options = {\n  bytesLimit: number\n  collectStreamBody?: boolean\n}\n/**\n * Read bytes from a ReadableStream until at least `limit` bytes have been read (or until the end of\n * the stream). The callback is invoked with the at most `limit` bytes, and indicates that the limit\n * has been exceeded if more bytes were available.\n */\nexport function readBytesFromStream(\n  stream: ReadableStream<Uint8Array>,\n  callback: (error?: Error, bytes?: Uint8Array, limitExceeded?: boolean) => void,\n  options: Options\n) {\n  const reader = stream.getReader()\n  const chunks: Uint8Array[] = []\n  let readBytesCount = 0\n\n  readMore()\n\n  function readMore() {\n    reader.read().then(\n      monitor((result: ReadableStreamReadResult<Uint8Array>) => {\n        if (result.done) {\n          onDone()\n          return\n        }\n\n        if (options.collectStreamBody) {\n          chunks.push(result.value)\n        }\n        readBytesCount += result.value.length\n\n        if (readBytesCount > options.bytesLimit) {\n          onDone()\n        } else {\n          readMore()\n        }\n      }),\n      monitor((error) => callback(error))\n    )\n  }\n\n  function onDone() {\n    reader.cancel().catch(\n      // we don't care if cancel fails, but we still need to catch the error to avoid reporting it\n      // as an unhandled rejection\n      noop\n    )\n\n    let bytes: Uint8Array | undefined\n    let limitExceeded: boolean | undefined\n    if (options.collectStreamBody) {\n      let completeBuffer: Uint8Array\n      if (chunks.length === 1) {\n        // optimization: if the response is small enough to fit in a single buffer (provided by the browser), just\n        // use it directly.\n        completeBuffer = chunks[0]\n      } else {\n        // else, we need to copy buffers into a larger buffer to concatenate them.\n        completeBuffer = new Uint8Array(readBytesCount)\n        let offset = 0\n        chunks.forEach((chunk) => {\n          completeBuffer.set(chunk, offset)\n          offset += chunk.length\n        })\n      }\n      bytes = completeBuffer.slice(0, options.bytesLimit)\n      limitExceeded = completeBuffer.length > options.bytesLimit\n    }\n\n    callback(undefined, bytes, limitExceeded)\n  }\n}\n","interface BrowserWindow {\n  __ddBrowserSdkExtensionCallback?: (message: unknown) => void\n}\n\ntype ExtensionMessageType = 'logs' | 'record' | 'rum' | 'telemetry'\n\nexport function sendToExtension(type: ExtensionMessageType, payload: unknown) {\n  const callback = (window as BrowserWindow).__ddBrowserSdkExtensionCallback\n  if (callback) {\n    callback({ type, payload })\n  }\n}\n","import { noop } from '../utils/functionUtils'\n\n/**\n * Custom implementation of JSON.stringify that ignores some toJSON methods. We need to do that\n * because some sites badly override toJSON on certain objects. Removing all toJSON methods from\n * nested values would be too costly, so we just detach them from the root value, and native classes\n * used to build JSON values (Array and Object).\n *\n * Note: this still assumes that JSON.stringify is correct.\n */\nexport function jsonStringify(\n  value: unknown,\n  replacer?: Array<string | number>,\n  space?: string | number\n): string | undefined {\n  if (typeof value !== 'object' || value === null) {\n    return JSON.stringify(value)\n  }\n\n  // Note: The order matter here. We need to detach toJSON methods on parent classes before their\n  // subclasses.\n  const restoreObjectPrototypeToJson = detachToJsonMethod(Object.prototype)\n  const restoreArrayPrototypeToJson = detachToJsonMethod(Array.prototype)\n  const restoreValuePrototypeToJson = detachToJsonMethod(Object.getPrototypeOf(value))\n  const restoreValueToJson = detachToJsonMethod(value)\n\n  try {\n    return JSON.stringify(value, replacer, space)\n  } catch {\n    return '<error: unable to serialize object>'\n  } finally {\n    restoreObjectPrototypeToJson()\n    restoreArrayPrototypeToJson()\n    restoreValuePrototypeToJson()\n    restoreValueToJson()\n  }\n}\n\nexport interface ObjectWithToJsonMethod {\n  toJSON?: () => unknown\n}\n\nexport function detachToJsonMethod(value: object) {\n  const object = value as ObjectWithToJsonMethod\n  const objectToJson = object.toJSON\n  if (objectToJson) {\n    delete object.toJSON\n    return () => {\n      object.toJSON = objectToJson\n    }\n  }\n  return noop\n}\n","import { display } from '../display'\nimport { ONE_KIBI_BYTE } from '../utils/byteUtils'\nimport type { Context, ContextArray, ContextValue } from './context'\nimport type { ObjectWithToJsonMethod } from './jsonStringify'\nimport { detachToJsonMethod } from './jsonStringify'\n\n// eslint-disable-next-line @typescript-eslint/ban-types\ntype PrimitivesAndFunctions = string | number | boolean | undefined | null | symbol | bigint | Function\ntype ExtendedContextValue = PrimitivesAndFunctions | object | ExtendedContext | ExtendedContextArray\ntype ExtendedContext = { [key: string]: ExtendedContextValue }\ntype ExtendedContextArray = ExtendedContextValue[]\n\ntype ContainerElementToProcess = {\n  source: ExtendedContextArray | ExtendedContext\n  target: ContextArray | Context\n  path: string\n}\n\n// The maximum size of a single event is 256KiB. By default, we ensure that user-provided data\n// going through sanitize fits inside our events, while leaving room for other contexts, metadata, ...\nconst SANITIZE_DEFAULT_MAX_CHARACTER_COUNT = 220 * ONE_KIBI_BYTE\n\n// Symbol for the root element of the JSONPath used for visited objects\nconst JSON_PATH_ROOT_ELEMENT = '$'\n\n// When serializing (using JSON.stringify) a key of an object, { key: 42 } gets wrapped in quotes as \"key\".\n// With the separator (:), we need to add 3 characters to the count.\nconst KEY_DECORATION_LENGTH = 3\n\n/**\n * Ensures user-provided data is 'safe' for the SDK\n * - Deep clones data\n * - Removes cyclic references\n * - Transforms unserializable types to a string representation\n *\n * LIMITATIONS:\n * - Size is in characters, not byte count (may differ according to character encoding)\n * - Size does not take into account indentation that can be applied to JSON.stringify\n * - Non-numerical properties of Arrays are ignored. Same behavior as JSON.stringify\n *\n * @param source              User-provided data meant to be serialized using JSON.stringify\n * @param maxCharacterCount   Maximum number of characters allowed in serialized form\n */\nexport function sanitize(source: string, maxCharacterCount?: number): string | undefined\nexport function sanitize(source: Context, maxCharacterCount?: number): Context\nexport function sanitize(source: unknown, maxCharacterCount?: number): ContextValue\nexport function sanitize(source: unknown, maxCharacterCount = SANITIZE_DEFAULT_MAX_CHARACTER_COUNT) {\n  // Unbind any toJSON function we may have on [] or {} prototypes\n  const restoreObjectPrototypeToJson = detachToJsonMethod(Object.prototype)\n  const restoreArrayPrototypeToJson = detachToJsonMethod(Array.prototype)\n\n  // Initial call to sanitizeProcessor - will populate containerQueue if source is an Array or a plain Object\n  const containerQueue: ContainerElementToProcess[] = []\n  const visitedObjectsWithPath = new WeakMap<object, string>()\n  const sanitizedData = sanitizeProcessor(\n    source as ExtendedContextValue,\n    JSON_PATH_ROOT_ELEMENT,\n    undefined,\n    containerQueue,\n    visitedObjectsWithPath\n  )\n  let accumulatedCharacterCount = JSON.stringify(sanitizedData)?.length || 0\n  if (accumulatedCharacterCount > maxCharacterCount) {\n    warnOverCharacterLimit(maxCharacterCount, 'discarded', source)\n    return undefined\n  }\n\n  while (containerQueue.length > 0 && accumulatedCharacterCount < maxCharacterCount) {\n    const containerToProcess = containerQueue.shift()!\n    let separatorLength = 0 // 0 for the first element, 1 for subsequent elements\n\n    // Arrays and Objects have to be handled distinctly to ensure\n    // we do not pick up non-numerical properties from Arrays\n    if (Array.isArray(containerToProcess.source)) {\n      for (let key = 0; key < containerToProcess.source.length; key++) {\n        const targetData = sanitizeProcessor(\n          containerToProcess.source[key],\n          containerToProcess.path,\n          key,\n          containerQueue,\n          visitedObjectsWithPath\n        )\n\n        if (targetData !== undefined) {\n          accumulatedCharacterCount += JSON.stringify(targetData).length\n        } else {\n          // When an element of an Array (targetData) is undefined, it is serialized as null:\n          // JSON.stringify([undefined]) => '[null]' - This accounts for 4 characters\n          accumulatedCharacterCount += 4\n        }\n        accumulatedCharacterCount += separatorLength\n        separatorLength = 1\n        if (accumulatedCharacterCount > maxCharacterCount) {\n          warnOverCharacterLimit(maxCharacterCount, 'truncated', source)\n          break\n        }\n        ;(containerToProcess.target as ContextArray)[key] = targetData\n      }\n    } else {\n      for (const key in containerToProcess.source) {\n        if (Object.prototype.hasOwnProperty.call(containerToProcess.source, key)) {\n          const targetData = sanitizeProcessor(\n            containerToProcess.source[key],\n            containerToProcess.path,\n            key,\n            containerQueue,\n            visitedObjectsWithPath\n          )\n          // When a property of an object has an undefined value, it will be dropped during serialization:\n          // JSON.stringify({a:undefined}) => '{}'\n          if (targetData !== undefined) {\n            accumulatedCharacterCount +=\n              JSON.stringify(targetData).length + separatorLength + key.length + KEY_DECORATION_LENGTH\n            separatorLength = 1\n          }\n          if (accumulatedCharacterCount > maxCharacterCount) {\n            warnOverCharacterLimit(maxCharacterCount, 'truncated', source)\n            break\n          }\n          ;(containerToProcess.target as Context)[key] = targetData\n        }\n      }\n    }\n  }\n\n  // Rebind detached toJSON functions\n  restoreObjectPrototypeToJson()\n  restoreArrayPrototypeToJson()\n\n  return sanitizedData\n}\n\n/**\n * Internal function to factorize the process common to the\n * initial call to sanitize, and iterations for Arrays and Objects\n *\n */\nfunction sanitizeProcessor(\n  source: ExtendedContextValue,\n  parentPath: string,\n  key: string | number | undefined,\n  queue: ContainerElementToProcess[],\n  visitedObjectsWithPath: WeakMap<object, string>\n) {\n  // Start by handling toJSON, as we want to sanitize its output\n  const sourceToSanitize = tryToApplyToJSON(source)\n\n  if (!sourceToSanitize || typeof sourceToSanitize !== 'object') {\n    return sanitizePrimitivesAndFunctions(sourceToSanitize)\n  }\n\n  const sanitizedSource = sanitizeObjects(sourceToSanitize)\n  if (sanitizedSource !== '[Object]' && sanitizedSource !== '[Array]' && sanitizedSource !== '[Error]') {\n    return sanitizedSource\n  }\n\n  // Handle potential cyclic references\n  // We need to use source as sourceToSanitize could be a reference to a new object\n  // At this stage, we know the source is an object type\n  const sourceAsObject = source as object\n  if (visitedObjectsWithPath.has(sourceAsObject)) {\n    return `[Reference seen at ${visitedObjectsWithPath.get(sourceAsObject)!}]`\n  }\n\n  // Add processed source to queue\n  const currentPath = key !== undefined ? `${parentPath}.${key}` : parentPath\n  const target = Array.isArray(sourceToSanitize) ? ([] as ContextArray) : ({} as Context)\n  visitedObjectsWithPath.set(sourceAsObject, currentPath)\n  queue.push({ source: sourceToSanitize as ExtendedContext | ExtendedContextArray, target, path: currentPath })\n\n  return target\n}\n\n/**\n * Handles sanitization of simple, non-object types\n *\n */\nfunction sanitizePrimitivesAndFunctions(value: PrimitivesAndFunctions) {\n  // BigInt cannot be serialized by JSON.stringify(), convert it to a string representation\n  if (typeof value === 'bigint') {\n    return `[BigInt] ${value.toString()}`\n  }\n  // Functions cannot be serialized by JSON.stringify(). Moreover, if a faulty toJSON is present, it needs to be converted\n  // so it won't prevent stringify from serializing later\n  if (typeof value === 'function') {\n    return `[Function] ${value.name || 'unknown'}`\n  }\n  // JSON.stringify() does not serialize symbols.\n  if (typeof value === 'symbol') {\n    // symbol.description is part of ES2019+\n    type symbolWithDescription = symbol & { description: string }\n    return `[Symbol] ${(value as symbolWithDescription).description || value.toString()}`\n  }\n\n  return value\n}\n\n/**\n * Handles sanitization of object types\n *\n * LIMITATIONS\n * - If a class defines a toStringTag Symbol, it will fall in the catch-all method and prevent enumeration of properties.\n * To avoid this, a toJSON method can be defined.\n * - IE11 does not return a distinct type for objects such as Map, WeakMap, ... These objects will pass through and their\n * properties enumerated if any.\n *\n */\nfunction sanitizeObjects(value: object) {\n  try {\n    // Handle events - Keep a simple implementation to avoid breaking changes\n    if (value instanceof Event) {\n      return {\n        isTrusted: value.isTrusted,\n      }\n    }\n\n    // Handle all remaining object types in a generic way\n    const result = Object.prototype.toString.call(value)\n    const match = result.match(/\\[object (.*)\\]/)\n    if (match && match[1]) {\n      return `[${match[1]}]`\n    }\n  } catch {\n    // If the previous serialization attempts failed, and we cannot convert using\n    // Object.prototype.toString, declare the value unserializable\n  }\n  return '[Unserializable]'\n}\n\n/**\n * Checks if a toJSON function exists and tries to execute it\n *\n */\nfunction tryToApplyToJSON(value: ExtendedContextValue) {\n  const object = value as ObjectWithToJsonMethod\n  if (object && typeof object.toJSON === 'function') {\n    try {\n      return object.toJSON() as ExtendedContextValue\n    } catch {\n      // If toJSON fails, we continue by trying to serialize the value manually\n    }\n  }\n\n  return value\n}\n\n/**\n * Helper function to display the warning when the accumulated character count is over the limit\n */\nfunction warnOverCharacterLimit(maxCharacterCount: number, changeType: 'discarded' | 'truncated', source: unknown) {\n  display.warn(\n    `The data provided has been ${changeType} as it is over the limit of ${maxCharacterCount} characters:`,\n    source\n  )\n}\n","import { getZoneJsOriginalValue } from './getZoneJsOriginalValue'\nimport { monitor } from './monitor'\nimport { getGlobalObject } from './getGlobalObject'\n\nexport type TimeoutId = ReturnType<typeof globalThis.setTimeout>\n\nexport function setTimeout(callback: () => void, delay?: number): TimeoutId {\n  return getZoneJsOriginalValue(getGlobalObject(), 'setTimeout')(monitor(callback), delay)\n}\n\nexport function clearTimeout(timeoutId: TimeoutId | undefined) {\n  getZoneJsOriginalValue(getGlobalObject(), 'clearTimeout')(timeoutId)\n}\n\nexport function setInterval(callback: () => void, delay?: number): TimeoutId {\n  return getZoneJsOriginalValue(getGlobalObject(), 'setInterval')(monitor(callback), delay)\n}\n\nexport function clearInterval(timeoutId: TimeoutId | undefined) {\n  getZoneJsOriginalValue(getGlobalObject(), 'clearInterval')(timeoutId)\n}\n","import { arrayFrom } from './polyfills'\n\nexport function removeDuplicates<T>(array: T[]) {\n  const set = new Set<T>()\n  array.forEach((item) => set.add(item))\n  return arrayFrom(set)\n}\n","let browserIsIE: boolean | undefined\nexport function isIE() {\n  return browserIsIE ?? (browserIsIE = Boolean((document as any).documentMode))\n}\n\nlet browserIsChromium: boolean | undefined\nexport function isChromium() {\n  return (\n    browserIsChromium ??\n    (browserIsChromium = !!(window as any).chrome || /HeadlessChrome/.test(window.navigator.userAgent))\n  )\n}\n\nlet browserIsSafari: boolean | undefined\nexport function isSafari() {\n  return browserIsSafari ?? (browserIsSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent))\n}\n","export const ONE_KIBI_BYTE = 1024\nexport const ONE_MEBI_BYTE = 1024 * ONE_KIBI_BYTE\n\n// eslint-disable-next-line no-control-regex\nconst HAS_MULTI_BYTES_CHARACTERS = /[^\\u0000-\\u007F]/\n\nexport function computeBytesCount(candidate: string): number {\n  // Accurate bytes count computations can degrade performances when there is a lot of events to process\n  if (!HAS_MULTI_BYTES_CHARACTERS.test(candidate)) {\n    return candidate.length\n  }\n\n  if (window.TextEncoder !== undefined) {\n    return new TextEncoder().encode(candidate).length\n  }\n\n  return new Blob([candidate]).size\n}\n\nexport function concatBuffers(buffers: Uint8Array[]) {\n  const length = buffers.reduce((total, buffer) => total + buffer.length, 0)\n  const result = new Uint8Array(length)\n  let offset = 0\n  for (const buffer of buffers) {\n    result.set(buffer, offset)\n    offset += buffer.length\n  }\n  return result\n}\n","import type { TimeoutId } from '../timer'\nimport { setTimeout, clearTimeout } from '../timer'\n\n// use lodash API\nexport function throttle<T extends (...args: any[]) => void>(\n  fn: T,\n  wait: number,\n  options?: { leading?: boolean; trailing?: boolean }\n) {\n  const needLeadingExecution = options && options.leading !== undefined ? options.leading : true\n  const needTrailingExecution = options && options.trailing !== undefined ? options.trailing : true\n  let inWaitPeriod = false\n  let pendingExecutionWithParameters: Parameters<T> | undefined\n  let pendingTimeoutId: TimeoutId\n\n  return {\n    throttled: (...parameters: Parameters<T>) => {\n      if (inWaitPeriod) {\n        pendingExecutionWithParameters = parameters\n        return\n      }\n      if (needLeadingExecution) {\n        fn(...parameters)\n      } else {\n        pendingExecutionWithParameters = parameters\n      }\n      inWaitPeriod = true\n      pendingTimeoutId = setTimeout(() => {\n        if (needTrailingExecution && pendingExecutionWithParameters) {\n          fn(...pendingExecutionWithParameters)\n        }\n        inWaitPeriod = false\n        pendingExecutionWithParameters = undefined\n      }, wait)\n    },\n    cancel: () => {\n      clearTimeout(pendingTimeoutId)\n      inWaitPeriod = false\n      pendingExecutionWithParameters = undefined\n    },\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function noop() {}\n\nexport type ListenerHandler = () => void\n","/**\n * Return true if the draw is successful\n * @param threshold between 0 and 100\n */\nexport function performDraw(threshold: number): boolean {\n  return threshold !== 0 && Math.random() * 100 <= threshold\n}\n\nexport function round(num: number, decimals: 0 | 1 | 2 | 3 | 4) {\n  return +num.toFixed(decimals)\n}\n\nexport function isPercentage(value: unknown) {\n  return isNumber(value) && value >= 0 && value <= 100\n}\n\nexport function isNumber(value: unknown): value is number {\n  return typeof value === 'number'\n}\n","import { assign } from './polyfills'\n\nexport function shallowClone<T>(object: T): T & Record<string, never> {\n  return assign({}, object)\n}\n\nexport function objectHasValue<T extends { [key: string]: unknown }>(object: T, value: unknown): value is T[keyof T] {\n  return Object.keys(object).some((key) => object[key] === value)\n}\n\nexport function isEmptyObject(object: object) {\n  return Object.keys(object).length === 0\n}\n\nexport function mapValues<A, B>(object: { [key: string]: A }, fn: (arg: A) => B) {\n  const newObject: { [key: string]: B } = {}\n  for (const key of Object.keys(object)) {\n    newObject[key] = fn(object[key])\n  }\n  return newObject\n}\n","export function includes(candidate: string, search: string): boolean\nexport function includes<T>(candidate: T[], search: T): boolean\nexport function includes(candidate: string | unknown[], search: any) {\n  return candidate.indexOf(search) !== -1\n}\n\nexport function arrayFrom<T>(arrayLike: ArrayLike<T> | Set<T>): T[] {\n  if (Array.from) {\n    return Array.from(arrayLike)\n  }\n\n  const array = []\n\n  if (arrayLike instanceof Set) {\n    arrayLike.forEach((item) => array.push(item))\n  } else {\n    for (let i = 0; i < arrayLike.length; i++) {\n      array.push(arrayLike[i])\n    }\n  }\n\n  return array\n}\n\nexport function find<T, S extends T>(\n  array: ArrayLike<T>,\n  predicate: (item: T, index: number) => item is S\n): S | undefined\nexport function find<T>(array: ArrayLike<T>, predicate: (item: T, index: number) => boolean): T | undefined\nexport function find(array: ArrayLike<unknown>, predicate: (item: unknown, index: number) => boolean): unknown {\n  for (let i = 0; i < array.length; i += 1) {\n    const item = array[i]\n    if (predicate(item, i)) {\n      return item\n    }\n  }\n  return undefined\n}\n\nexport function findLast<T, S extends T>(\n  array: T[],\n  predicate: (item: T, index: number, array: T[]) => item is S\n): S | undefined {\n  for (let i = array.length - 1; i >= 0; i -= 1) {\n    const item = array[i]\n    if (predicate(item, i, array)) {\n      return item\n    }\n  }\n  return undefined\n}\n\nexport function forEach<List extends { [index: number]: any }>(\n  list: List,\n  callback: (value: List[number], index: number, parent: List) => void\n) {\n  Array.prototype.forEach.call(list, callback as any)\n}\n\nexport function objectValues<T = unknown>(object: { [key: string]: T }) {\n  return Object.keys(object).map((key) => object[key])\n}\n\nexport function objectEntries<T = unknown>(object: { [key: string]: T }): Array<[string, T]> {\n  return Object.keys(object).map((key) => [key, object[key]])\n}\n\nexport function startsWith(candidate: string, search: string) {\n  return candidate.slice(0, search.length) === search\n}\n\nexport function endsWith(candidate: string, search: string) {\n  return candidate.slice(-search.length) === search\n}\n\nexport function elementMatches(element: Element & { msMatchesSelector?(selector: string): boolean }, selector: string) {\n  if (element.matches) {\n    return element.matches(selector)\n  }\n  // IE11 support\n  if (element.msMatchesSelector) {\n    return element.msMatchesSelector(selector)\n  }\n  return false\n}\n\n// https://github.com/jquery/jquery/blob/a684e6ba836f7c553968d7d026ed7941e1a612d8/src/selector/escapeSelector.js\nexport function cssEscape(str: string) {\n  if (window.CSS && window.CSS.escape) {\n    return window.CSS.escape(str)\n  }\n\n  // eslint-disable-next-line no-control-regex\n  return str.replace(/([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\x80-\\uFFFF\\w-]/g, function (ch, asCodePoint) {\n    if (asCodePoint) {\n      // U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER\n      if (ch === '\\0') {\n        return '\\uFFFD'\n      }\n      // Control characters and (dependent upon position) numbers get escaped as code points\n      return `${ch.slice(0, -1)}\\\\${ch.charCodeAt(ch.length - 1).toString(16)} `\n    }\n    // Other potentially-special ASCII characters get backslash-escaped\n    return `\\\\${ch}`\n  })\n}\n\ninterface Assignable {\n  [key: string]: any\n}\n\nexport function assign<T, U>(target: T, source: U): T & U\nexport function assign<T, U, V>(target: T, source1: U, source2: V): T & U & V\nexport function assign<T, U, V, W>(target: T, source1: U, source2: V, source3: W): T & U & V & W\nexport function assign(target: Assignable, ...toAssign: Assignable[]) {\n  toAssign.forEach((source: Assignable) => {\n    for (const key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key]\n      }\n    }\n  })\n  return target\n}\n","export function isServerError(status: number) {\n  return status >= 500\n}\n\nexport function tryToClone(response: Response): Response | undefined {\n  try {\n    return response.clone()\n  } catch (e) {\n    // clone can throw if the response has already been used by another instrumentation or is disturbed\n    return\n  }\n}\n","/**\n * UUID v4\n * from https://gist.github.com/jed/982883\n */\nexport function generateUUID(placeholder?: string): string {\n  return placeholder\n    ? // eslint-disable-next-line  no-bitwise\n      (parseInt(placeholder, 10) ^ ((Math.random() * 16) >> (parseInt(placeholder, 10) / 4))).toString(16)\n    : `${1e7}-${1e3}-${4e3}-${8e3}-${1e11}`.replace(/[018]/g, generateUUID)\n}\n\nexport function findCommaSeparatedValue(rawString: string, name: string) {\n  const regex = new RegExp(`(?:^|;)\\\\s*${name}\\\\s*=\\\\s*([^;]+)`)\n  const matches = regex.exec(rawString)\n  return matches ? matches[1] : undefined\n}\n\nexport function safeTruncate(candidate: string, length: number, suffix = '') {\n  const lastChar = candidate.charCodeAt(length - 1)\n  const isLastCharSurrogatePair = lastChar >= 0xd800 && lastChar <= 0xdbff\n  const correctedLength = isLastCharSurrogatePair ? length + 1 : length\n\n  if (candidate.length <= correctedLength) {\n    return candidate\n  }\n\n  return `${candidate.slice(0, correctedLength)}${suffix}`\n}\n","import { isNumber, round } from './numberUtils'\n\nexport const ONE_SECOND = 1000\nexport const ONE_MINUTE = 60 * ONE_SECOND\nexport const ONE_HOUR = 60 * ONE_MINUTE\nexport const ONE_DAY = 24 * ONE_HOUR\nexport const ONE_YEAR = 365 * ONE_DAY\n\nexport type Duration = number & { d: 'Duration in ms' }\nexport type ServerDuration = number & { s: 'Duration in ns' }\nexport type TimeStamp = number & { t: 'Epoch time' }\nexport type RelativeTime = number & { r: 'Time relative to navigation start' } & { d: 'Duration in ms' }\nexport type ClocksState = { relative: RelativeTime; timeStamp: TimeStamp }\n\nexport function relativeToClocks(relative: RelativeTime) {\n  return { relative, timeStamp: getCorrectedTimeStamp(relative) }\n}\n\nfunction getCorrectedTimeStamp(relativeTime: RelativeTime) {\n  const correctedOrigin = (dateNow() - performance.now()) as TimeStamp\n  // apply correction only for positive drift\n  if (correctedOrigin > getNavigationStart()) {\n    return Math.round(addDuration(correctedOrigin, relativeTime)) as TimeStamp\n  }\n  return getTimeStamp(relativeTime)\n}\n\nexport function currentDrift() {\n  return Math.round(dateNow() - addDuration(getNavigationStart(), performance.now() as Duration))\n}\n\nexport function toServerDuration(duration: Duration): ServerDuration\nexport function toServerDuration(duration: Duration | undefined): ServerDuration | undefined\nexport function toServerDuration(duration: Duration | undefined) {\n  if (!isNumber(duration)) {\n    return duration\n  }\n  return round(duration * 1e6, 0) as ServerDuration\n}\n\nexport function dateNow() {\n  // Do not use `Date.now` because sometimes websites are wrongly \"polyfilling\" it. For example, we\n  // had some users using a very old version of `datejs`, which patched `Date.now` to return a Date\n  // instance instead of a timestamp[1]. Those users are unlikely to fix this, so let's handle this\n  // case ourselves.\n  // [1]: https://github.com/datejs/Datejs/blob/97f5c7c58c5bc5accdab8aa7602b6ac56462d778/src/core-debug.js#L14-L16\n  return new Date().getTime()\n}\n\nexport function timeStampNow() {\n  return dateNow() as TimeStamp\n}\n\nexport function relativeNow() {\n  return performance.now() as RelativeTime\n}\n\nexport function clocksNow() {\n  return { relative: relativeNow(), timeStamp: timeStampNow() }\n}\n\nexport function clocksOrigin() {\n  return { relative: 0 as RelativeTime, timeStamp: getNavigationStart() }\n}\n\nexport function elapsed(start: TimeStamp, end: TimeStamp): Duration\nexport function elapsed(start: RelativeTime, end: RelativeTime): Duration\nexport function elapsed(start: number, end: number) {\n  return (end - start) as Duration\n}\n\nexport function addDuration(a: TimeStamp, b: Duration): TimeStamp\nexport function addDuration(a: RelativeTime, b: Duration): RelativeTime\nexport function addDuration(a: Duration, b: Duration): Duration\nexport function addDuration(a: number, b: number) {\n  return a + b\n}\n\n/**\n * Get the time since the navigation was started.\n *\n * Note: this does not use `performance.timeOrigin` because it doesn't seem to reflect the actual\n * time on which the navigation has started: it may be much farther in the past, at least in Firefox 71.\n * Related issue in Firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=1429926\n */\nexport function getRelativeTime(timestamp: TimeStamp) {\n  return (timestamp - getNavigationStart()) as RelativeTime\n}\n\nexport function getTimeStamp(relativeTime: RelativeTime) {\n  return Math.round(addDuration(getNavigationStart(), relativeTime)) as TimeStamp\n}\n\nexport function looksLikeRelativeTime(time: RelativeTime | TimeStamp): time is RelativeTime {\n  return time < ONE_YEAR\n}\n\n/**\n * Navigation start slightly change on some rare cases\n */\nlet navigationStart: TimeStamp | undefined\n\nfunction getNavigationStart() {\n  if (navigationStart === undefined) {\n    navigationStart = performance.timing.navigationStart as TimeStamp\n  }\n  return navigationStart\n}\n\nexport function resetNavigationStart() {\n  navigationStart = undefined\n}\n","/**\n * Similar to `typeof`, but distinguish plain objects from `null` and arrays\n */\nexport function getType(value: unknown) {\n  if (value === null) {\n    return 'null'\n  }\n  if (Array.isArray(value)) {\n    return 'array'\n  }\n  return typeof value\n}\n","import { jsonStringify } from '../serialisation/jsonStringify'\n\nexport function normalizeUrl(url: string) {\n  return buildUrl(url, getLocationOrigin()).href\n}\n\nexport function isValidUrl(url: string) {\n  try {\n    return !!buildUrl(url)\n  } catch {\n    return false\n  }\n}\n\nexport function getOrigin(url: string) {\n  return getLinkElementOrigin(buildUrl(url))\n}\n\nexport function getPathName(url: string) {\n  const pathname = buildUrl(url).pathname\n  return pathname[0] === '/' ? pathname : `/${pathname}`\n}\n\nexport function getSearch(url: string) {\n  return buildUrl(url).search\n}\n\nexport function getHash(url: string) {\n  return buildUrl(url).hash\n}\n\nexport function buildUrl(url: string, base?: string) {\n  const supportedURL = getSupportedUrl()\n  if (supportedURL) {\n    try {\n      return base !== undefined ? new supportedURL(url, base) : new supportedURL(url)\n    } catch (error) {\n      throw new Error(`Failed to construct URL: ${String(error)} ${jsonStringify({ url, base })!}`)\n    }\n  }\n  if (base === undefined && !/:/.test(url)) {\n    throw new Error(`Invalid URL: '${url}'`)\n  }\n  let doc = document\n  const anchorElement = doc.createElement('a')\n  if (base !== undefined) {\n    doc = document.implementation.createHTMLDocument('')\n    const baseElement = doc.createElement('base')\n    baseElement.href = base\n    doc.head.appendChild(baseElement)\n    doc.body.appendChild(anchorElement)\n  }\n  anchorElement.href = url\n  return anchorElement\n}\n\nconst originalURL = URL\nlet isURLSupported: boolean | undefined\nfunction getSupportedUrl(): typeof URL | undefined {\n  if (isURLSupported === undefined) {\n    try {\n      const url = new originalURL('http://test/path')\n      isURLSupported = url.href === 'http://test/path'\n    } catch {\n      isURLSupported = false\n    }\n  }\n  return isURLSupported ? originalURL : undefined\n}\n\nexport function getLocationOrigin() {\n  return getLinkElementOrigin(window.location)\n}\n\n/**\n * Fallback\n * On IE HTMLAnchorElement origin is not supported: https://developer.mozilla.org/en-US/docs/Web/API/HTMLHyperlinkElementUtils/origin\n * On Firefox window.location.origin is \"null\" for file: URIs: https://bugzilla.mozilla.org/show_bug.cgi?id=878297\n */\nexport function getLinkElementOrigin(element: Location | HTMLAnchorElement | URL) {\n  if (element.origin && element.origin !== 'null') {\n    return element.origin\n  }\n  const sanitizedHost = element.host.replace(/(:80|:443)$/, '')\n  return `${element.protocol}//${sanitizedHost}`\n}\n","import { setInterval, clearInterval } from './timer'\nimport type { TimeoutId } from './timer'\nimport type { Duration, RelativeTime } from './utils/timeUtils'\nimport { addDuration, relativeNow, ONE_MINUTE } from './utils/timeUtils'\n\nconst END_OF_TIMES = Infinity as RelativeTime\n\nexport interface ValueHistoryEntry<T> {\n  startTime: RelativeTime\n  endTime: RelativeTime\n  value: T\n  remove(): void\n  close(endTime: RelativeTime): void\n}\n\nexport const CLEAR_OLD_VALUES_INTERVAL = ONE_MINUTE\n\n/**\n * Store and keep track of values spans. This whole class assumes that values are added in\n * chronological order (i.e. all entries have an increasing start time).\n */\nexport class ValueHistory<Value> {\n  private entries: Array<ValueHistoryEntry<Value>> = []\n  private clearOldValuesInterval: TimeoutId\n\n  constructor(\n    private expireDelay: number,\n    private maxEntries?: number\n  ) {\n    this.clearOldValuesInterval = setInterval(() => this.clearOldValues(), CLEAR_OLD_VALUES_INTERVAL)\n  }\n\n  /**\n   * Add a value to the history associated with a start time. Returns a reference to this newly\n   * added entry that can be removed or closed.\n   */\n  add(value: Value, startTime: RelativeTime): ValueHistoryEntry<Value> {\n    const entry: ValueHistoryEntry<Value> = {\n      value,\n      startTime,\n      endTime: END_OF_TIMES,\n      remove: () => {\n        const index = this.entries.indexOf(entry)\n        if (index >= 0) {\n          this.entries.splice(index, 1)\n        }\n      },\n      close: (endTime: RelativeTime) => {\n        entry.endTime = endTime\n      },\n    }\n\n    if (this.maxEntries && this.entries.length >= this.maxEntries) {\n      this.entries.pop()\n    }\n\n    this.entries.unshift(entry)\n\n    return entry\n  }\n\n  /**\n   * Return the latest value that was active during `startTime`, or the currently active value\n   * if no `startTime` is provided. This method assumes that entries are not overlapping.\n   */\n  find(startTime: RelativeTime = END_OF_TIMES): Value | undefined {\n    for (const entry of this.entries) {\n      if (entry.startTime <= startTime) {\n        if (startTime <= entry.endTime) {\n          return entry.value\n        }\n        break\n      }\n    }\n  }\n\n  /**\n   * Helper function to close the currently active value, if any. This method assumes that entries\n   * are not overlapping.\n   */\n  closeActive(endTime: RelativeTime) {\n    const latestEntry = this.entries[0]\n    if (latestEntry && latestEntry.endTime === END_OF_TIMES) {\n      latestEntry.close(endTime)\n    }\n  }\n\n  /**\n   * Return all values with an active period overlapping with the duration,\n   * or all values that were active during `startTime` if no duration is provided,\n   * or all currently active values if no `startTime` is provided.\n   */\n  findAll(startTime: RelativeTime = END_OF_TIMES, duration = 0 as Duration): Value[] {\n    const endTime = addDuration(startTime, duration)\n    return this.entries\n      .filter((entry) => entry.startTime <= endTime && startTime <= entry.endTime)\n      .map((entry) => entry.value)\n  }\n\n  /**\n   * Remove all entries from this collection.\n   */\n  reset() {\n    this.entries = []\n  }\n\n  /**\n   * Stop internal garbage collection of past entries.\n   */\n  stop() {\n    clearInterval(this.clearOldValuesInterval)\n  }\n\n  private clearOldValues() {\n    const oldTimeThreshold = relativeNow() - this.expireDelay\n    while (this.entries.length > 0 && this.entries[this.entries.length - 1].endTime < oldTimeThreshold) {\n      this.entries.pop()\n    }\n  }\n}\n","import { display } from '../tools/display'\nimport type { Context } from '../tools/serialisation/context'\nimport { objectValues } from '../tools/utils/polyfills'\nimport { isPageExitReason } from '../browser/pageExitObservable'\nimport { computeBytesCount } from '../tools/utils/byteUtils'\nimport { jsonStringify } from '../tools/serialisation/jsonStringify'\nimport type { Subscription } from '../tools/observable'\nimport type { HttpRequest } from './httpRequest'\nimport type { FlushController, FlushEvent } from './flushController'\n\nexport class Batch {\n  private pushOnlyBuffer: string[] = []\n  private upsertBuffer: { [key: string]: string } = {}\n  private flushSubscription: Subscription\n\n  constructor(\n    private request: HttpRequest,\n    public flushController: FlushController,\n    private messageBytesLimit: number\n  ) {\n    this.flushSubscription = this.flushController.flushObservable.subscribe((event) => this.flush(event))\n  }\n\n  add(message: Context) {\n    this.addOrUpdate(message)\n  }\n\n  upsert(message: Context, key: string) {\n    this.addOrUpdate(message, key)\n  }\n\n  stop() {\n    this.flushSubscription.unsubscribe()\n  }\n\n  private flush(event: FlushEvent) {\n    const messages = this.pushOnlyBuffer.concat(objectValues(this.upsertBuffer))\n\n    this.pushOnlyBuffer = []\n    this.upsertBuffer = {}\n\n    const payload = { data: messages.join('\\n'), bytesCount: event.bytesCount, flushReason: event.reason }\n    if (isPageExitReason(event.reason)) {\n      this.request.sendOnExit(payload)\n    } else {\n      this.request.send(payload)\n    }\n  }\n\n  private addOrUpdate(message: Context, key?: string) {\n    const { processedMessage, messageBytesCount } = this.process(message)\n\n    if (messageBytesCount >= this.messageBytesLimit) {\n      display.warn(\n        `Discarded a message whose size was bigger than the maximum allowed size ${this.messageBytesLimit}KB.`\n      )\n      return\n    }\n\n    if (this.hasMessageFor(key)) {\n      this.remove(key)\n    }\n\n    this.push(processedMessage, messageBytesCount, key)\n  }\n\n  private process(message: Context) {\n    const processedMessage = jsonStringify(message)!\n    const messageBytesCount = computeBytesCount(processedMessage)\n    return { processedMessage, messageBytesCount }\n  }\n\n  private push(processedMessage: string, messageBytesCount: number, key?: string) {\n    // If there are other messages, a '\\n' will be added at serialization\n    const separatorBytesCount = this.flushController.messagesCount > 0 ? 1 : 0\n\n    this.flushController.notifyBeforeAddMessage(messageBytesCount + separatorBytesCount)\n    if (key !== undefined) {\n      this.upsertBuffer[key] = processedMessage\n    } else {\n      this.pushOnlyBuffer.push(processedMessage)\n    }\n    this.flushController.notifyAfterAddMessage()\n  }\n\n  private remove(key: string) {\n    const removedMessage = this.upsertBuffer[key]\n    delete this.upsertBuffer[key]\n    const messageBytesCount = computeBytesCount(removedMessage)\n    // If there are other messages, a '\\n' will be added at serialization\n    const separatorBytesCount = this.flushController.messagesCount > 1 ? 1 : 0\n    this.flushController.notifyAfterRemoveMessage(messageBytesCount + separatorBytesCount)\n  }\n\n  private hasMessageFor(key?: string): key is string {\n    return key !== undefined && this.upsertBuffer[key] !== undefined\n  }\n}\n","import { endsWith } from '../tools/utils/polyfills'\nimport { getGlobalObject } from '../tools/getGlobalObject'\n\nexport interface BrowserWindowWithEventBridge extends Window {\n  DatadogEventBridge?: DatadogEventBridge\n}\n\nexport interface DatadogEventBridge {\n  getAllowedWebViewHosts(): string\n  send(msg: string): void\n}\n\nexport function getEventBridge<T, E>() {\n  const eventBridgeGlobal = getEventBridgeGlobal()\n\n  if (!eventBridgeGlobal) {\n    return\n  }\n\n  return {\n    getAllowedWebViewHosts() {\n      return JSON.parse(eventBridgeGlobal.getAllowedWebViewHosts()) as string[]\n    },\n    send(eventType: T, event: E) {\n      eventBridgeGlobal.send(JSON.stringify({ eventType, event }))\n    },\n  }\n}\n\nexport function canUseEventBridge(currentHost = getGlobalObject<Window>().location?.hostname): boolean {\n  const bridge = getEventBridge()\n  return (\n    !!bridge &&\n    bridge\n      .getAllowedWebViewHosts()\n      .some((allowedHost) => currentHost === allowedHost || endsWith(currentHost, `.${allowedHost}`))\n  )\n}\n\nfunction getEventBridgeGlobal() {\n  return getGlobalObject<BrowserWindowWithEventBridge>().DatadogEventBridge\n}\n","import type { PageExitEvent, PageExitReason } from '../browser/pageExitObservable'\nimport { Observable } from '../tools/observable'\nimport type { TimeoutId } from '../tools/timer'\nimport { clearTimeout, setTimeout } from '../tools/timer'\nimport type { Duration } from '../tools/utils/timeUtils'\n\nexport type FlushReason = PageExitReason | 'duration_limit' | 'bytes_limit' | 'messages_limit' | 'session_expire'\n\nexport type FlushController = ReturnType<typeof createFlushController>\nexport interface FlushEvent {\n  reason: FlushReason\n  bytesCount: number\n  messagesCount: number\n}\n\ninterface FlushControllerOptions {\n  messagesLimit: number\n  bytesLimit: number\n  durationLimit: Duration\n  pageExitObservable: Observable<PageExitEvent>\n  sessionExpireObservable: Observable<void>\n}\n\n/**\n * Returns a \"flush controller\", responsible of notifying when flushing a pool of pending data needs\n * to happen. The implementation is designed to support both synchronous and asynchronous usages,\n * but relies on invariants described in each method documentation to keep a coherent state.\n */\nexport function createFlushController({\n  messagesLimit,\n  bytesLimit,\n  durationLimit,\n  pageExitObservable,\n  sessionExpireObservable,\n}: FlushControllerOptions) {\n  const pageExitSubscription = pageExitObservable.subscribe((event) => flush(event.reason))\n  const sessionExpireSubscription = sessionExpireObservable.subscribe(() => flush('session_expire'))\n\n  const flushObservable = new Observable<FlushEvent>(() => () => {\n    pageExitSubscription.unsubscribe()\n    sessionExpireSubscription.unsubscribe()\n  })\n\n  let currentBytesCount = 0\n  let currentMessagesCount = 0\n\n  function flush(flushReason: FlushReason) {\n    if (currentMessagesCount === 0) {\n      return\n    }\n\n    const messagesCount = currentMessagesCount\n    const bytesCount = currentBytesCount\n\n    currentMessagesCount = 0\n    currentBytesCount = 0\n    cancelDurationLimitTimeout()\n\n    flushObservable.notify({\n      reason: flushReason,\n      messagesCount,\n      bytesCount,\n    })\n  }\n\n  let durationLimitTimeoutId: TimeoutId | undefined\n  function scheduleDurationLimitTimeout() {\n    if (durationLimitTimeoutId === undefined) {\n      durationLimitTimeoutId = setTimeout(() => {\n        flush('duration_limit')\n      }, durationLimit)\n    }\n  }\n\n  function cancelDurationLimitTimeout() {\n    clearTimeout(durationLimitTimeoutId)\n    durationLimitTimeoutId = undefined\n  }\n\n  return {\n    flushObservable,\n    get messagesCount() {\n      return currentMessagesCount\n    },\n\n    /**\n     * Notifies that a message will be added to a pool of pending messages waiting to be flushed.\n     *\n     * This function needs to be called synchronously, right before adding the message, so no flush\n     * event can happen after `notifyBeforeAddMessage` and before adding the message.\n     */\n    notifyBeforeAddMessage(messageBytesCount: number) {\n      if (currentBytesCount + messageBytesCount >= bytesLimit) {\n        flush('bytes_limit')\n      }\n      // Consider the message to be added now rather than in `notifyAfterAddMessage`, because if no\n      // message was added yet and `notifyAfterAddMessage` is called asynchronously, we still want\n      // to notify when a flush is needed (for example on page exit).\n      currentMessagesCount += 1\n      currentBytesCount += messageBytesCount\n      scheduleDurationLimitTimeout()\n    },\n\n    /**\n     * Notifies that a message *was* added to a pool of pending messages waiting to be flushed.\n     *\n     * This function can be called asynchronously after the message was added, but in this case it\n     * should not be called if a flush event occurred in between.\n     */\n    notifyAfterAddMessage() {\n      if (currentMessagesCount >= messagesLimit) {\n        flush('messages_limit')\n      } else if (currentBytesCount >= bytesLimit) {\n        flush('bytes_limit')\n      }\n    },\n\n    /**\n     * Notifies that a message was removed from a pool of pending messages waiting to be flushed.\n     *\n     * This function needs to be called synchronously, right after removing the message, so no flush\n     * event can happen after removing the message and before `notifyAfterRemoveMessage`.\n     */\n    notifyAfterRemoveMessage(messageBytesCount: number) {\n      currentBytesCount -= messageBytesCount\n      currentMessagesCount -= 1\n      if (currentMessagesCount === 0) {\n        cancelDurationLimitTimeout()\n      }\n    },\n  }\n}\n","import type { EndpointBuilder, Configuration } from '../domain/configuration'\nimport { addTelemetryError } from '../domain/telemetry'\nimport type { Context } from '../tools/serialisation/context'\nimport { monitor } from '../tools/monitor'\nimport { addEventListener } from '../browser/addEventListener'\nimport type { RawError } from '../domain/error/error.types'\nimport { newRetryState, sendWithRetryStrategy } from './sendWithRetryStrategy'\nimport type { FlushReason } from './flushController'\n\n/**\n * Use POST request without content type to:\n * - avoid CORS preflight requests\n * - allow usage of sendBeacon\n *\n * multiple elements are sent separated by \\n in order\n * to be parsed correctly without content type header\n */\n\nexport type HttpRequest = ReturnType<typeof createHttpRequest>\n\nexport interface HttpResponse extends Context {\n  status: number\n  type?: ResponseType\n}\n\nexport interface Payload {\n  data: string | FormData\n  bytesCount: number\n  retry?: RetryInfo\n  flushReason?: FlushReason\n  encoding?: 'deflate'\n}\n\nexport interface RetryInfo {\n  count: number\n  lastFailureStatus: number\n}\n\nexport function createHttpRequest(\n  configuration: Configuration,\n  endpointBuilder: EndpointBuilder,\n  bytesLimit: number,\n  reportError: (error: RawError) => void\n) {\n  const retryState = newRetryState()\n  const sendStrategyForRetry = (payload: Payload, onResponse: (r: HttpResponse) => void) =>\n    fetchKeepAliveStrategy(configuration, endpointBuilder, bytesLimit, payload, onResponse)\n\n  return {\n    send: (payload: Payload) => {\n      sendWithRetryStrategy(payload, retryState, sendStrategyForRetry, endpointBuilder.endpointType, reportError)\n    },\n    /**\n     * Since fetch keepalive behaves like regular fetch on Firefox,\n     * keep using sendBeaconStrategy on exit\n     */\n    sendOnExit: (payload: Payload) => {\n      sendBeaconStrategy(configuration, endpointBuilder, bytesLimit, payload)\n    },\n  }\n}\n\nfunction sendBeaconStrategy(\n  configuration: Configuration,\n  endpointBuilder: EndpointBuilder,\n  bytesLimit: number,\n  payload: Payload\n) {\n  const canUseBeacon = !!navigator.sendBeacon && payload.bytesCount < bytesLimit\n  if (canUseBeacon) {\n    try {\n      const beaconUrl = endpointBuilder.build('beacon', payload)\n      const isQueued = navigator.sendBeacon(beaconUrl, payload.data)\n\n      if (isQueued) {\n        return\n      }\n    } catch (e) {\n      reportBeaconError(e)\n    }\n  }\n\n  const xhrUrl = endpointBuilder.build('xhr', payload)\n  sendXHR(configuration, xhrUrl, payload.data)\n}\n\nlet hasReportedBeaconError = false\n\nfunction reportBeaconError(e: unknown) {\n  if (!hasReportedBeaconError) {\n    hasReportedBeaconError = true\n    addTelemetryError(e)\n  }\n}\n\nexport function fetchKeepAliveStrategy(\n  configuration: Configuration,\n  endpointBuilder: EndpointBuilder,\n  bytesLimit: number,\n  payload: Payload,\n  onResponse?: (r: HttpResponse) => void\n) {\n  const canUseKeepAlive = isKeepAliveSupported() && payload.bytesCount < bytesLimit\n  if (canUseKeepAlive) {\n    const fetchUrl = endpointBuilder.build('fetch', payload)\n    fetch(fetchUrl, { method: 'POST', body: payload.data, keepalive: true, mode: 'cors' }).then(\n      monitor((response: Response) => onResponse?.({ status: response.status, type: response.type })),\n      monitor(() => {\n        const xhrUrl = endpointBuilder.build('xhr', payload)\n        // failed to queue the request\n        sendXHR(configuration, xhrUrl, payload.data, onResponse)\n      })\n    )\n  } else {\n    const xhrUrl = endpointBuilder.build('xhr', payload)\n    sendXHR(configuration, xhrUrl, payload.data, onResponse)\n  }\n}\n\nfunction isKeepAliveSupported() {\n  // Request can throw, cf https://developer.mozilla.org/en-US/docs/Web/API/Request/Request#errors\n  try {\n    return window.Request && 'keepalive' in new Request('http://a')\n  } catch {\n    return false\n  }\n}\n\nexport function sendXHR(\n  configuration: Configuration,\n  url: string,\n  data: Payload['data'],\n  onResponse?: (r: HttpResponse) => void\n) {\n  const request = new XMLHttpRequest()\n  request.open('POST', url, true)\n  addEventListener(\n    configuration,\n    request,\n    'loadend',\n    () => {\n      onResponse?.({ status: request.status })\n    },\n    {\n      // prevent multiple onResponse callbacks\n      // if the xhr instance is reused by a third party\n      once: true,\n    }\n  )\n  request.send(data)\n}\n","import type { EndpointType } from '../domain/configuration'\nimport { setTimeout } from '../tools/timer'\nimport { clocksNow, ONE_MINUTE, ONE_SECOND } from '../tools/utils/timeUtils'\nimport { ONE_MEBI_BYTE, ONE_KIBI_BYTE } from '../tools/utils/byteUtils'\nimport { isServerError } from '../tools/utils/responseUtils'\nimport type { RawError } from '../domain/error/error.types'\nimport { ErrorSource } from '../domain/error/error.types'\nimport type { Payload, HttpResponse } from './httpRequest'\n\nexport const MAX_ONGOING_BYTES_COUNT = 80 * ONE_KIBI_BYTE\nexport const MAX_ONGOING_REQUESTS = 32\nexport const MAX_QUEUE_BYTES_COUNT = 3 * ONE_MEBI_BYTE\nexport const MAX_BACKOFF_TIME = ONE_MINUTE\nexport const INITIAL_BACKOFF_TIME = ONE_SECOND\n\nconst enum TransportStatus {\n  UP,\n  FAILURE_DETECTED,\n  DOWN,\n}\n\nconst enum RetryReason {\n  AFTER_SUCCESS,\n  AFTER_RESUME,\n}\n\nexport interface RetryState {\n  transportStatus: TransportStatus\n  currentBackoffTime: number\n  bandwidthMonitor: ReturnType<typeof newBandwidthMonitor>\n  queuedPayloads: ReturnType<typeof newPayloadQueue>\n  queueFullReported: boolean\n}\n\ntype SendStrategy = (payload: Payload, onResponse: (r: HttpResponse) => void) => void\n\nexport function sendWithRetryStrategy(\n  payload: Payload,\n  state: RetryState,\n  sendStrategy: SendStrategy,\n  endpointType: EndpointType,\n  reportError: (error: RawError) => void\n) {\n  if (\n    state.transportStatus === TransportStatus.UP &&\n    state.queuedPayloads.size() === 0 &&\n    state.bandwidthMonitor.canHandle(payload)\n  ) {\n    send(payload, state, sendStrategy, {\n      onSuccess: () => retryQueuedPayloads(RetryReason.AFTER_SUCCESS, state, sendStrategy, endpointType, reportError),\n      onFailure: () => {\n        state.queuedPayloads.enqueue(payload)\n        scheduleRetry(state, sendStrategy, endpointType, reportError)\n      },\n    })\n  } else {\n    state.queuedPayloads.enqueue(payload)\n  }\n}\n\nfunction scheduleRetry(\n  state: RetryState,\n  sendStrategy: SendStrategy,\n  endpointType: EndpointType,\n  reportError: (error: RawError) => void\n) {\n  if (state.transportStatus !== TransportStatus.DOWN) {\n    return\n  }\n  setTimeout(() => {\n    const payload = state.queuedPayloads.first()\n    send(payload, state, sendStrategy, {\n      onSuccess: () => {\n        state.queuedPayloads.dequeue()\n        state.currentBackoffTime = INITIAL_BACKOFF_TIME\n        retryQueuedPayloads(RetryReason.AFTER_RESUME, state, sendStrategy, endpointType, reportError)\n      },\n      onFailure: () => {\n        state.currentBackoffTime = Math.min(MAX_BACKOFF_TIME, state.currentBackoffTime * 2)\n        scheduleRetry(state, sendStrategy, endpointType, reportError)\n      },\n    })\n  }, state.currentBackoffTime)\n}\n\nfunction send(\n  payload: Payload,\n  state: RetryState,\n  sendStrategy: SendStrategy,\n  { onSuccess, onFailure }: { onSuccess: () => void; onFailure: () => void }\n) {\n  state.bandwidthMonitor.add(payload)\n  sendStrategy(payload, (response) => {\n    state.bandwidthMonitor.remove(payload)\n    if (!shouldRetryRequest(response)) {\n      state.transportStatus = TransportStatus.UP\n      onSuccess()\n    } else {\n      // do not consider transport down if another ongoing request could succeed\n      state.transportStatus =\n        state.bandwidthMonitor.ongoingRequestCount > 0 ? TransportStatus.FAILURE_DETECTED : TransportStatus.DOWN\n      payload.retry = {\n        count: payload.retry ? payload.retry.count + 1 : 1,\n        lastFailureStatus: response.status,\n      }\n      onFailure()\n    }\n  })\n}\n\nfunction retryQueuedPayloads(\n  reason: RetryReason,\n  state: RetryState,\n  sendStrategy: SendStrategy,\n  endpointType: EndpointType,\n  reportError: (error: RawError) => void\n) {\n  if (reason === RetryReason.AFTER_SUCCESS && state.queuedPayloads.isFull() && !state.queueFullReported) {\n    reportError({\n      message: `Reached max ${endpointType} events size queued for upload: ${MAX_QUEUE_BYTES_COUNT / ONE_MEBI_BYTE}MiB`,\n      source: ErrorSource.AGENT,\n      startClocks: clocksNow(),\n    })\n    state.queueFullReported = true\n  }\n  const previousQueue = state.queuedPayloads\n  state.queuedPayloads = newPayloadQueue()\n  while (previousQueue.size() > 0) {\n    sendWithRetryStrategy(previousQueue.dequeue()!, state, sendStrategy, endpointType, reportError)\n  }\n}\n\nfunction shouldRetryRequest(response: HttpResponse) {\n  return (\n    response.type !== 'opaque' &&\n    ((response.status === 0 && !navigator.onLine) ||\n      response.status === 408 ||\n      response.status === 429 ||\n      isServerError(response.status))\n  )\n}\n\nexport function newRetryState(): RetryState {\n  return {\n    transportStatus: TransportStatus.UP,\n    currentBackoffTime: INITIAL_BACKOFF_TIME,\n    bandwidthMonitor: newBandwidthMonitor(),\n    queuedPayloads: newPayloadQueue(),\n    queueFullReported: false,\n  }\n}\n\nfunction newPayloadQueue() {\n  const queue: Payload[] = []\n  return {\n    bytesCount: 0,\n    enqueue(payload: Payload) {\n      if (this.isFull()) {\n        return\n      }\n      queue.push(payload)\n      this.bytesCount += payload.bytesCount\n    },\n    first() {\n      return queue[0]\n    },\n    dequeue() {\n      const payload = queue.shift()\n      if (payload) {\n        this.bytesCount -= payload.bytesCount\n      }\n      return payload\n    },\n    size() {\n      return queue.length\n    },\n    isFull() {\n      return this.bytesCount >= MAX_QUEUE_BYTES_COUNT\n    },\n  }\n}\n\nfunction newBandwidthMonitor() {\n  return {\n    ongoingRequestCount: 0,\n    ongoingByteCount: 0,\n    canHandle(payload: Payload) {\n      return (\n        this.ongoingRequestCount === 0 ||\n        (this.ongoingByteCount + payload.bytesCount <= MAX_ONGOING_BYTES_COUNT &&\n          this.ongoingRequestCount < MAX_ONGOING_REQUESTS)\n      )\n    },\n    add(payload: Payload) {\n      this.ongoingRequestCount += 1\n      this.ongoingByteCount += payload.bytesCount\n    },\n    remove(payload: Payload) {\n      this.ongoingRequestCount -= 1\n      this.ongoingByteCount -= payload.bytesCount\n    },\n  }\n}\n","import type { Configuration, EndpointBuilder } from '../domain/configuration'\nimport type { Context } from '../tools/serialisation/context'\nimport type { Observable } from '../tools/observable'\nimport type { PageExitEvent } from '../browser/pageExitObservable'\nimport type { RawError } from '../domain/error/error.types'\nimport { Batch } from './batch'\nimport { createHttpRequest } from './httpRequest'\nimport { createFlushController } from './flushController'\n\nexport function startBatchWithReplica<T extends Context>(\n  configuration: Configuration,\n  primary: { endpoint: EndpointBuilder },\n  replica: { endpoint: EndpointBuilder; transformMessage?: (message: T) => T } | undefined,\n  reportError: (error: RawError) => void,\n  pageExitObservable: Observable<PageExitEvent>,\n  sessionExpireObservable: Observable<void>\n) {\n  const primaryBatch = createBatch(configuration, primary.endpoint)\n  const replicaBatch = replica && createBatch(configuration, replica.endpoint)\n\n  function createBatch(configuration: Configuration, endpointBuilder: EndpointBuilder) {\n    return new Batch(\n      createHttpRequest(configuration, endpointBuilder, configuration.batchBytesLimit, reportError),\n      createFlushController({\n        messagesLimit: configuration.batchMessagesLimit,\n        bytesLimit: configuration.batchBytesLimit,\n        durationLimit: configuration.flushTimeout,\n        pageExitObservable,\n        sessionExpireObservable,\n      }),\n      configuration.messageBytesLimit\n    )\n  }\n\n  return {\n    flushObservable: primaryBatch.flushController.flushObservable,\n\n    add(message: T, replicated = true) {\n      primaryBatch.add(message)\n      if (replicaBatch && replicated) {\n        replicaBatch.add(replica.transformMessage ? replica.transformMessage(message) : message)\n      }\n    },\n\n    upsert: (message: T, key: string) => {\n      primaryBatch.upsert(message, key)\n      if (replicaBatch) {\n        replicaBatch.upsert(replica.transformMessage ? replica.transformMessage(message) : message, key)\n      }\n    },\n\n    stop: () => {\n      primaryBatch.stop()\n      replicaBatch?.stop()\n    },\n  }\n}\n","import type { Context, InitConfiguration, User } from '@datadog/browser-core'\nimport {\n  CustomerDataType,\n  assign,\n  BoundedBuffer,\n  createContextManager,\n  makePublicApi,\n  monitor,\n  display,\n  deepClone,\n  canUseEventBridge,\n  timeStampNow,\n  checkUser,\n  sanitizeUser,\n  sanitize,\n  createStoredContextManager,\n  combine,\n} from '@datadog/browser-core'\nimport type { LogsInitConfiguration } from '../domain/configuration'\nimport { validateAndBuildLogsConfiguration } from '../domain/configuration'\nimport type { HandlerType, StatusType, LogsMessage } from '../domain/logger'\nimport { Logger } from '../domain/logger'\nimport type { CommonContext } from '../rawLogsEvent.types'\nimport type { startLogs } from './startLogs'\n\nexport interface LoggerConfiguration {\n  level?: StatusType\n  handler?: HandlerType | HandlerType[]\n  context?: object\n}\n\nexport type LogsPublicApi = ReturnType<typeof makeLogsPublicApi>\n\nexport type StartLogs = typeof startLogs\n\ntype StartLogsResult = ReturnType<typeof startLogs>\n\nconst LOGS_STORAGE_KEY = 'logs'\n\nexport function makeLogsPublicApi(startLogsImpl: StartLogs) {\n  let isAlreadyInitialized = false\n\n  let globalContextManager = createContextManager(CustomerDataType.GlobalContext)\n  let userContextManager = createContextManager(CustomerDataType.User)\n\n  const customLoggers: { [name: string]: Logger | undefined } = {}\n  let getInternalContextStrategy: StartLogsResult['getInternalContext'] = () => undefined\n\n  const beforeInitLoggerLog = new BoundedBuffer()\n\n  let handleLogStrategy: StartLogsResult['handleLog'] = (\n    logsMessage: LogsMessage,\n    logger: Logger,\n    savedCommonContext = deepClone(buildCommonContext()),\n    date = timeStampNow()\n  ) => {\n    beforeInitLoggerLog.add(() => handleLogStrategy(logsMessage, logger, savedCommonContext, date))\n  }\n\n  let getInitConfigurationStrategy = (): InitConfiguration | undefined => undefined\n  const mainLogger = new Logger((...params) => handleLogStrategy(...params))\n\n  function buildCommonContext(): CommonContext {\n    return {\n      view: {\n        referrer: document.referrer,\n        url: window.location.href,\n      },\n      context: globalContextManager.getContext(),\n      user: userContextManager.getContext(),\n    }\n  }\n\n  return makePublicApi({\n    logger: mainLogger,\n\n    init: monitor((initConfiguration: LogsInitConfiguration) => {\n      if (!initConfiguration) {\n        display.error('Missing configuration')\n        return\n      }\n      // This function should be available, regardless of initialization success.\n      getInitConfigurationStrategy = () => deepClone(initConfiguration)\n\n      if (canUseEventBridge()) {\n        initConfiguration = overrideInitConfigurationForBridge(initConfiguration)\n      }\n\n      if (!canInitLogs(initConfiguration)) {\n        return\n      }\n\n      const configuration = validateAndBuildLogsConfiguration(initConfiguration)\n      if (!configuration) {\n        return\n      }\n\n      if (initConfiguration.storeContextsAcrossPages) {\n        const beforeInitGlobalContext = globalContextManager.getContext()\n        globalContextManager = createStoredContextManager(\n          configuration,\n          LOGS_STORAGE_KEY,\n          CustomerDataType.GlobalContext\n        )\n        globalContextManager.setContext(combine(globalContextManager.getContext(), beforeInitGlobalContext))\n\n        const beforeInitUserContext = userContextManager.getContext()\n        userContextManager = createStoredContextManager(configuration, LOGS_STORAGE_KEY, CustomerDataType.User)\n        userContextManager.setContext(combine(userContextManager.getContext(), beforeInitUserContext))\n      }\n\n      ;({ handleLog: handleLogStrategy, getInternalContext: getInternalContextStrategy } = startLogsImpl(\n        initConfiguration,\n        configuration,\n        buildCommonContext,\n        mainLogger\n      ))\n\n      beforeInitLoggerLog.drain()\n\n      isAlreadyInitialized = true\n    }),\n\n    /** @deprecated: use getGlobalContext instead */\n    getLoggerGlobalContext: monitor(() => globalContextManager.get()),\n    getGlobalContext: monitor(() => globalContextManager.getContext()),\n\n    /** @deprecated: use setGlobalContext instead */\n    setLoggerGlobalContext: monitor((context) => globalContextManager.set(context)),\n    setGlobalContext: monitor((context) => globalContextManager.setContext(context)),\n\n    /** @deprecated: use setGlobalContextProperty instead */\n    addLoggerGlobalContext: monitor((key, value) => globalContextManager.add(key, value)),\n    setGlobalContextProperty: monitor((key, value) => globalContextManager.setContextProperty(key, value)),\n\n    /** @deprecated: use removeGlobalContextProperty instead */\n    removeLoggerGlobalContext: monitor((key) => globalContextManager.remove(key)),\n    removeGlobalContextProperty: monitor((key) => globalContextManager.removeContextProperty(key)),\n\n    clearGlobalContext: monitor(() => globalContextManager.clearContext()),\n\n    createLogger: monitor((name: string, conf: LoggerConfiguration = {}) => {\n      customLoggers[name] = new Logger(\n        (...params) => handleLogStrategy(...params),\n        sanitize(name),\n        conf.handler,\n        conf.level,\n        sanitize(conf.context) as object\n      )\n\n      return customLoggers[name]!\n    }),\n\n    getLogger: monitor((name: string) => customLoggers[name]),\n\n    getInitConfiguration: monitor(() => getInitConfigurationStrategy()),\n\n    getInternalContext: monitor((startTime?: number | undefined) => getInternalContextStrategy(startTime)),\n\n    setUser: monitor((newUser: User) => {\n      if (checkUser(newUser)) {\n        userContextManager.setContext(sanitizeUser(newUser as Context))\n      }\n    }),\n\n    getUser: monitor(() => userContextManager.getContext()),\n\n    setUserProperty: monitor((key, property) => {\n      const sanitizedProperty = sanitizeUser({ [key]: property })[key]\n      userContextManager.setContextProperty(key, sanitizedProperty)\n    }),\n\n    removeUserProperty: monitor((key) => userContextManager.removeContextProperty(key)),\n\n    clearUser: monitor(() => userContextManager.clearContext()),\n  })\n\n  function overrideInitConfigurationForBridge<C extends InitConfiguration>(initConfiguration: C): C {\n    return assign({}, initConfiguration, { clientToken: 'empty' })\n  }\n\n  function canInitLogs(initConfiguration: LogsInitConfiguration) {\n    if (isAlreadyInitialized) {\n      if (!initConfiguration.silentMultipleInit) {\n        display.error('DD_LOGS is already initialized.')\n      }\n      return false\n    }\n    return true\n  }\n}\n","import type { Context, TelemetryEvent, RawError, Observable, PageExitEvent } from '@datadog/browser-core'\nimport {\n  sendToExtension,\n  createPageExitObservable,\n  TelemetryService,\n  willSyntheticsInjectRum,\n  canUseEventBridge,\n  getEventBridge,\n  startTelemetry,\n  startBatchWithReplica,\n  isTelemetryReplicationAllowed,\n  ErrorSource,\n  addTelemetryConfiguration,\n  addTelemetryDebug,\n} from '@datadog/browser-core'\nimport { startLogsSessionManager, startLogsSessionManagerStub } from '../domain/logsSessionManager'\nimport type { LogsConfiguration, LogsInitConfiguration } from '../domain/configuration'\nimport { serializeLogsConfiguration } from '../domain/configuration'\nimport { startLogsAssembly, getRUMInternalContext } from '../domain/assembly'\nimport { startConsoleCollection } from '../domain/console/consoleCollection'\nimport { startReportCollection } from '../domain/report/reportCollection'\nimport { startNetworkErrorCollection } from '../domain/networkError/networkErrorCollection'\nimport { startRuntimeErrorCollection } from '../domain/runtimeError/runtimeErrorCollection'\nimport { LifeCycle, LifeCycleEventType } from '../domain/lifeCycle'\nimport { startLoggerCollection } from '../domain/logger/loggerCollection'\nimport type { CommonContext } from '../rawLogsEvent.types'\nimport { startLogsBatch } from '../transport/startLogsBatch'\nimport { startLogsBridge } from '../transport/startLogsBridge'\nimport type { Logger } from '../domain/logger'\nimport { StatusType } from '../domain/logger'\nimport { startInternalContext } from '../domain/internalContext'\n\nexport function startLogs(\n  initConfiguration: LogsInitConfiguration,\n  configuration: LogsConfiguration,\n  buildCommonContext: () => CommonContext,\n  mainLogger: Logger\n) {\n  const lifeCycle = new LifeCycle()\n  const cleanupTasks: Array<() => void> = []\n\n  lifeCycle.subscribe(LifeCycleEventType.LOG_COLLECTED, (log) => sendToExtension('logs', log))\n\n  const reportError = (error: RawError) => {\n    lifeCycle.notify(LifeCycleEventType.RAW_LOG_COLLECTED, {\n      rawLogsEvent: {\n        message: error.message,\n        date: error.startClocks.timeStamp,\n        error: {\n          origin: ErrorSource.AGENT, // Todo: Remove in the next major release\n        },\n        origin: ErrorSource.AGENT,\n        status: StatusType.error,\n      },\n    })\n    addTelemetryDebug('Error reported to customer', { 'error.message': error.message })\n  }\n  const pageExitObservable = createPageExitObservable(configuration)\n\n  const session =\n    configuration.sessionStoreStrategyType && !canUseEventBridge() && !willSyntheticsInjectRum()\n      ? startLogsSessionManager(configuration)\n      : startLogsSessionManagerStub(configuration)\n\n  const { telemetry, stop: stopLogsTelemetry } = startLogsTelemetry(\n    configuration,\n    reportError,\n    pageExitObservable,\n    session.expireObservable\n  )\n  cleanupTasks.push(() => stopLogsTelemetry())\n  telemetry.setContextProvider(() => ({\n    application: {\n      id: getRUMInternalContext()?.application_id,\n    },\n    session: {\n      id: session.findTrackedSession()?.id,\n    },\n    view: {\n      id: (getRUMInternalContext()?.view as Context)?.id,\n    },\n    action: {\n      id: (getRUMInternalContext()?.user_action as Context)?.id,\n    },\n  }))\n\n  startNetworkErrorCollection(configuration, lifeCycle)\n  startRuntimeErrorCollection(configuration, lifeCycle)\n  startConsoleCollection(configuration, lifeCycle)\n  startReportCollection(configuration, lifeCycle)\n  const { handleLog } = startLoggerCollection(lifeCycle)\n\n  startLogsAssembly(session, configuration, lifeCycle, buildCommonContext, mainLogger, reportError)\n\n  if (!canUseEventBridge()) {\n    const { stop: stopLogsBatch } = startLogsBatch(\n      configuration,\n      lifeCycle,\n      reportError,\n      pageExitObservable,\n      session.expireObservable\n    )\n    cleanupTasks.push(() => stopLogsBatch())\n  } else {\n    startLogsBridge(lifeCycle)\n  }\n\n  addTelemetryConfiguration(serializeLogsConfiguration(initConfiguration))\n  const internalContext = startInternalContext(session)\n\n  return {\n    handleLog,\n    getInternalContext: internalContext.get,\n    stop: () => {\n      cleanupTasks.forEach((task) => task())\n    },\n  }\n}\n\nfunction startLogsTelemetry(\n  configuration: LogsConfiguration,\n  reportError: (error: RawError) => void,\n  pageExitObservable: Observable<PageExitEvent>,\n  sessionExpireObservable: Observable<void>\n) {\n  const telemetry = startTelemetry(TelemetryService.LOGS, configuration)\n  const cleanupTasks: Array<() => void> = []\n  if (canUseEventBridge()) {\n    const bridge = getEventBridge<'internal_telemetry', TelemetryEvent>()!\n    const telemetrySubscription = telemetry.observable.subscribe((event) => bridge.send('internal_telemetry', event))\n    cleanupTasks.push(() => telemetrySubscription.unsubscribe())\n  } else {\n    const telemetryBatch = startBatchWithReplica(\n      configuration,\n      {\n        endpoint: configuration.rumEndpointBuilder,\n      },\n      configuration.replica && {\n        endpoint: configuration.replica.rumEndpointBuilder,\n      },\n      reportError,\n      pageExitObservable,\n      sessionExpireObservable\n    )\n    cleanupTasks.push(() => telemetryBatch.stop())\n    const telemetrySubscription = telemetry.observable.subscribe((event) =>\n      telemetryBatch.add(event, isTelemetryReplicationAllowed(configuration))\n    )\n    cleanupTasks.push(() => telemetrySubscription.unsubscribe())\n  }\n  return {\n    telemetry,\n    stop: () => {\n      cleanupTasks.forEach((task) => task())\n    },\n  }\n}\n","import type { Context, EventRateLimiter, RawError, RelativeTime } from '@datadog/browser-core'\nimport {\n  getSyntheticsResultId,\n  getSyntheticsTestId,\n  addTelemetryDebug,\n  willSyntheticsInjectRum,\n  ErrorSource,\n  combine,\n  createEventRateLimiter,\n  getRelativeTime,\n  isEmptyObject,\n} from '@datadog/browser-core'\nimport type { CommonContext } from '../rawLogsEvent.types'\nimport type { LogsConfiguration } from './configuration'\nimport type { LifeCycle } from './lifeCycle'\nimport { LifeCycleEventType } from './lifeCycle'\nimport type { Logger } from './logger'\nimport { STATUSES, HandlerType } from './logger'\nimport { isAuthorized } from './logger/loggerCollection'\nimport type { LogsSessionManager } from './logsSessionManager'\n\nexport function startLogsAssembly(\n  sessionManager: LogsSessionManager,\n  configuration: LogsConfiguration,\n  lifeCycle: LifeCycle,\n  buildCommonContext: () => CommonContext,\n  mainLogger: Logger, // Todo: [RUMF-1230] Remove this parameter in the next major release\n  reportError: (error: RawError) => void\n) {\n  const statusWithCustom = (STATUSES as string[]).concat(['custom'])\n  const logRateLimiters: { [key: string]: EventRateLimiter } = {}\n  statusWithCustom.forEach((status) => {\n    logRateLimiters[status] = createEventRateLimiter(status, configuration.eventRateLimiterThreshold, reportError)\n  })\n\n  lifeCycle.subscribe(\n    LifeCycleEventType.RAW_LOG_COLLECTED,\n    ({ rawLogsEvent, messageContext = undefined, savedCommonContext = undefined, logger = mainLogger }) => {\n      const startTime = getRelativeTime(rawLogsEvent.date)\n      const session = sessionManager.findTrackedSession(startTime)\n\n      if (!session) {\n        return\n      }\n\n      const commonContext = savedCommonContext || buildCommonContext()\n      const log = combine(\n        {\n          service: configuration.service,\n          session_id: session.id,\n          // Insert user first to allow overrides from global context\n          usr: !isEmptyObject(commonContext.user) ? commonContext.user : undefined,\n          view: commonContext.view,\n        },\n        commonContext.context,\n        getRUMInternalContext(startTime),\n        rawLogsEvent,\n        logger.getContext(),\n        messageContext\n      )\n\n      if (\n        // Todo: [RUMF-1230] Move this check to the logger collection in the next major release\n        !isAuthorized(rawLogsEvent.status, HandlerType.http, logger) ||\n        configuration.beforeSend?.(log) === false ||\n        (log.error?.origin !== ErrorSource.AGENT &&\n          (logRateLimiters[log.status] ?? logRateLimiters['custom']).isLimitReached())\n      ) {\n        return\n      }\n\n      lifeCycle.notify(LifeCycleEventType.LOG_COLLECTED, log)\n    }\n  )\n}\n\ninterface Rum {\n  getInternalContext?: (startTime?: RelativeTime) => Context | undefined\n}\n\ninterface BrowserWindow {\n  DD_RUM?: Rum\n  DD_RUM_SYNTHETICS?: Rum\n}\n\nlet logsSentBeforeRumInjectionTelemetryAdded = false\n\nexport function getRUMInternalContext(startTime?: RelativeTime): Context | undefined {\n  const browserWindow = window as BrowserWindow\n\n  if (willSyntheticsInjectRum()) {\n    const context = getInternalContextFromRumGlobal(browserWindow.DD_RUM_SYNTHETICS)\n    if (!context && !logsSentBeforeRumInjectionTelemetryAdded) {\n      logsSentBeforeRumInjectionTelemetryAdded = true\n      addTelemetryDebug('Logs sent before RUM is injected by the synthetics worker', {\n        testId: getSyntheticsTestId(),\n        resultId: getSyntheticsResultId(),\n      })\n    }\n    return context\n  }\n\n  return getInternalContextFromRumGlobal(browserWindow.DD_RUM)\n\n  function getInternalContextFromRumGlobal(rumGlobal?: Rum): Context | undefined {\n    if (rumGlobal && rumGlobal.getInternalContext) {\n      return rumGlobal.getInternalContext(startTime)\n    }\n  }\n}\n\nexport function resetRUMInternalContext() {\n  logsSentBeforeRumInjectionTelemetryAdded = false\n}\n","import type { Configuration, InitConfiguration, RawTelemetryConfiguration } from '@datadog/browser-core'\nimport {\n  serializeConfiguration,\n  assign,\n  ONE_KIBI_BYTE,\n  validateAndBuildConfiguration,\n  display,\n  removeDuplicates,\n  ConsoleApiName,\n  RawReportType,\n  includes,\n  objectValues,\n} from '@datadog/browser-core'\nimport type { LogsEvent } from '../logsEvent.types'\n\nexport interface LogsInitConfiguration extends InitConfiguration {\n  beforeSend?: ((event: LogsEvent) => void | boolean) | undefined\n  forwardErrorsToLogs?: boolean | undefined\n  forwardConsoleLogs?: ConsoleApiName[] | 'all' | undefined\n  forwardReports?: RawReportType[] | 'all' | undefined\n}\n\nexport type HybridInitConfiguration = Omit<LogsInitConfiguration, 'clientToken'>\n\nexport interface LogsConfiguration extends Configuration {\n  forwardErrorsToLogs: boolean\n  forwardConsoleLogs: ConsoleApiName[]\n  forwardReports: RawReportType[]\n  requestErrorResponseLengthLimit: number\n}\n\n/**\n * arbitrary value, byte precision not needed\n */\nexport const DEFAULT_REQUEST_ERROR_RESPONSE_LENGTH_LIMIT = 32 * ONE_KIBI_BYTE\n\nexport function validateAndBuildLogsConfiguration(\n  initConfiguration: LogsInitConfiguration\n): LogsConfiguration | undefined {\n  const baseConfiguration = validateAndBuildConfiguration(initConfiguration)\n\n  const forwardConsoleLogs = validateAndBuildForwardOption<ConsoleApiName>(\n    initConfiguration.forwardConsoleLogs,\n    objectValues(ConsoleApiName),\n    'Forward Console Logs'\n  )\n\n  const forwardReports = validateAndBuildForwardOption<RawReportType>(\n    initConfiguration.forwardReports,\n    objectValues(RawReportType),\n    'Forward Reports'\n  )\n\n  if (!baseConfiguration || !forwardConsoleLogs || !forwardReports) {\n    return\n  }\n\n  if (initConfiguration.forwardErrorsToLogs && !includes(forwardConsoleLogs, ConsoleApiName.error)) {\n    forwardConsoleLogs.push(ConsoleApiName.error)\n  }\n\n  return assign(\n    {\n      forwardErrorsToLogs: initConfiguration.forwardErrorsToLogs !== false,\n      forwardConsoleLogs,\n      forwardReports,\n      requestErrorResponseLengthLimit: DEFAULT_REQUEST_ERROR_RESPONSE_LENGTH_LIMIT,\n    },\n    baseConfiguration\n  )\n}\n\nexport function validateAndBuildForwardOption<T>(\n  option: readonly T[] | 'all' | undefined,\n  allowedValues: T[],\n  label: string\n): T[] | undefined {\n  if (option === undefined) {\n    return []\n  }\n\n  if (!(option === 'all' || (Array.isArray(option) && option.every((api) => includes(allowedValues, api))))) {\n    display.error(`${label} should be \"all\" or an array with allowed values \"${allowedValues.join('\", \"')}\"`)\n    return\n  }\n\n  return option === 'all' ? allowedValues : removeDuplicates<T>(option)\n}\n\nexport function serializeLogsConfiguration(configuration: LogsInitConfiguration): RawTelemetryConfiguration {\n  const baseSerializedInitConfiguration = serializeConfiguration(configuration)\n\n  return assign(\n    {\n      forward_errors_to_logs: configuration.forwardErrorsToLogs,\n      forward_console_logs: configuration.forwardConsoleLogs,\n      forward_reports: configuration.forwardReports,\n    },\n    baseSerializedInitConfiguration\n  )\n}\n","import type { Context, ClocksState, ConsoleLog } from '@datadog/browser-core'\nimport { timeStampNow, ConsoleApiName, ErrorSource, initConsoleObservable } from '@datadog/browser-core'\nimport type { LogsConfiguration } from '../configuration'\nimport type { LifeCycle } from '../lifeCycle'\nimport { LifeCycleEventType } from '../lifeCycle'\nimport { StatusType } from '../logger'\n\nexport interface ProvidedError {\n  startClocks: ClocksState\n  error: unknown\n  context?: Context\n  handlingStack: string\n}\n\nconst LogStatusForApi = {\n  [ConsoleApiName.log]: StatusType.info,\n  [ConsoleApiName.debug]: StatusType.debug,\n  [ConsoleApiName.info]: StatusType.info,\n  [ConsoleApiName.warn]: StatusType.warn,\n  [ConsoleApiName.error]: StatusType.error,\n}\nexport function startConsoleCollection(configuration: LogsConfiguration, lifeCycle: LifeCycle) {\n  const consoleSubscription = initConsoleObservable(configuration.forwardConsoleLogs).subscribe((log: ConsoleLog) => {\n    lifeCycle.notify(LifeCycleEventType.RAW_LOG_COLLECTED, {\n      rawLogsEvent: {\n        date: timeStampNow(),\n        message: log.message,\n        origin: ErrorSource.CONSOLE,\n        error:\n          log.api === ConsoleApiName.error\n            ? {\n                origin: ErrorSource.CONSOLE, // Todo: Remove in the next major release\n                stack: log.stack,\n                fingerprint: log.fingerprint,\n              }\n            : undefined,\n        status: LogStatusForApi[log.api],\n      },\n    })\n  })\n\n  return {\n    stop: () => {\n      consoleSubscription.unsubscribe()\n    },\n  }\n}\n","import type { RelativeTime } from '@datadog/browser-core'\nimport type { LogsSessionManager } from './logsSessionManager'\n\nexport interface InternalContext {\n  session_id: string | undefined\n}\n\nexport function startInternalContext(sessionManager: LogsSessionManager) {\n  return {\n    get: (startTime?: number): InternalContext | undefined => {\n      const trackedSession = sessionManager.findTrackedSession(startTime as RelativeTime)\n      if (trackedSession) {\n        return {\n          session_id: trackedSession.id,\n        }\n      }\n    },\n  }\n}\n","import { AbstractLifeCycle } from '@datadog/browser-core'\nimport type { Context } from '@datadog/browser-core'\nimport type { LogsEvent } from '../logsEvent.types'\nimport type { CommonContext, RawLogsEvent } from '../rawLogsEvent.types'\nimport type { Logger } from './logger'\n\nexport const enum LifeCycleEventType {\n  RAW_LOG_COLLECTED,\n  LOG_COLLECTED,\n}\n\ninterface LifeCycleEventMap {\n  [LifeCycleEventType.RAW_LOG_COLLECTED]: RawLogsEventCollectedData\n  [LifeCycleEventType.LOG_COLLECTED]: LogsEvent & Context\n}\n\nexport const LifeCycle = AbstractLifeCycle<LifeCycleEventMap>\nexport type LifeCycle = AbstractLifeCycle<LifeCycleEventMap>\n\nexport interface RawLogsEventCollectedData<E extends RawLogsEvent = RawLogsEvent> {\n  rawLogsEvent: E\n  messageContext?: object\n  savedCommonContext?: CommonContext\n  logger?: Logger\n}\n","import type { Context } from '@datadog/browser-core'\nimport {\n  clocksNow,\n  computeRawError,\n  ErrorHandling,\n  computeStackTrace,\n  CustomerDataType,\n  assign,\n  combine,\n  createContextManager,\n  ErrorSource,\n  monitored,\n  sanitize,\n  NonErrorPrefix,\n} from '@datadog/browser-core'\n\nimport type { LogsEvent } from '../logsEvent.types'\n\nexport interface LogsMessage {\n  message: string\n  status: StatusType\n  context?: Context\n}\n\nexport const StatusType = {\n  debug: 'debug',\n  error: 'error',\n  info: 'info',\n  warn: 'warn',\n} as const\n\nexport type StatusType = (typeof StatusType)[keyof typeof StatusType]\n\nexport const HandlerType = {\n  console: 'console',\n  http: 'http',\n  silent: 'silent',\n} as const\n\nexport type HandlerType = (typeof HandlerType)[keyof typeof HandlerType]\nexport const STATUSES = Object.keys(StatusType) as StatusType[]\n\nexport class Logger {\n  private contextManager = createContextManager(CustomerDataType.LoggerContext)\n\n  constructor(\n    private handleLogStrategy: (logsMessage: LogsMessage, logger: Logger) => void,\n    name?: string,\n    private handlerType: HandlerType | HandlerType[] = HandlerType.http,\n    private level: StatusType = StatusType.debug,\n    loggerContext: object = {}\n  ) {\n    this.contextManager.set(assign({}, loggerContext, name ? { logger: { name } } : undefined))\n  }\n\n  @monitored\n  log(message: string, messageContext?: object, status: StatusType = StatusType.info, error?: Error) {\n    let errorContext: LogsEvent['error']\n\n    if (status === StatusType.error) {\n      // Always add origin if status is error (backward compatibility - Remove in next major)\n      errorContext = { origin: ErrorSource.LOGGER }\n    }\n\n    if (error !== undefined && error !== null) {\n      const stackTrace = error instanceof Error ? computeStackTrace(error) : undefined\n      const rawError = computeRawError({\n        stackTrace,\n        originalError: error,\n        nonErrorPrefix: NonErrorPrefix.PROVIDED,\n        source: ErrorSource.LOGGER,\n        handling: ErrorHandling.HANDLED,\n        startClocks: clocksNow(),\n      })\n\n      errorContext = {\n        origin: ErrorSource.LOGGER, // Remove in next major\n        stack: rawError.stack,\n        kind: rawError.type,\n        message: rawError.message,\n      }\n    }\n\n    const sanitizedMessageContext = sanitize(messageContext) as Context\n\n    const context = errorContext\n      ? (combine({ error: errorContext }, sanitizedMessageContext) as Context)\n      : sanitizedMessageContext\n\n    this.handleLogStrategy(\n      {\n        message: sanitize(message)!,\n        context,\n        status,\n      },\n      this\n    )\n  }\n\n  debug(message: string, messageContext?: object, error?: Error) {\n    this.log(message, messageContext, StatusType.debug, error)\n  }\n\n  info(message: string, messageContext?: object, error?: Error) {\n    this.log(message, messageContext, StatusType.info, error)\n  }\n\n  warn(message: string, messageContext?: object, error?: Error) {\n    this.log(message, messageContext, StatusType.warn, error)\n  }\n\n  error(message: string, messageContext?: object, error?: Error) {\n    this.log(message, messageContext, StatusType.error, error)\n  }\n\n  setContext(context: object) {\n    this.contextManager.set(context)\n  }\n\n  getContext() {\n    return this.contextManager.get()\n  }\n\n  addContext(key: string, value: any) {\n    this.contextManager.add(key, value)\n  }\n\n  removeContext(key: string) {\n    this.contextManager.remove(key)\n  }\n\n  setHandler(handler: HandlerType | HandlerType[]) {\n    this.handlerType = handler\n  }\n\n  getHandler() {\n    return this.handlerType\n  }\n\n  setLevel(level: StatusType) {\n    this.level = level\n  }\n\n  getLevel() {\n    return this.level\n  }\n}\n","import type { Context, TimeStamp } from '@datadog/browser-core'\nimport {\n  includes,\n  combine,\n  ErrorSource,\n  timeStampNow,\n  originalConsoleMethods,\n  globalConsole,\n} from '@datadog/browser-core'\nimport type { CommonContext } from '../../rawLogsEvent.types'\nimport type { LifeCycle } from '../lifeCycle'\nimport { LifeCycleEventType } from '../lifeCycle'\nimport type { Logger, LogsMessage } from '../logger'\nimport { StatusType, HandlerType } from '../logger'\n\nexport const STATUS_PRIORITIES: { [key in StatusType]: number } = {\n  [StatusType.debug]: 0,\n  [StatusType.info]: 1,\n  [StatusType.warn]: 2,\n  [StatusType.error]: 3,\n}\n\nexport function startLoggerCollection(lifeCycle: LifeCycle) {\n  function handleLog(\n    logsMessage: LogsMessage,\n    logger: Logger,\n    savedCommonContext?: CommonContext,\n    savedDate?: TimeStamp\n  ) {\n    const messageContext = logsMessage.context\n\n    if (isAuthorized(logsMessage.status, HandlerType.console, logger)) {\n      displayInConsole(logsMessage, combine(logger.getContext(), messageContext))\n    }\n\n    lifeCycle.notify(LifeCycleEventType.RAW_LOG_COLLECTED, {\n      rawLogsEvent: {\n        date: savedDate || timeStampNow(),\n        message: logsMessage.message,\n        status: logsMessage.status,\n        origin: ErrorSource.LOGGER,\n      },\n      messageContext,\n      savedCommonContext,\n      logger,\n    })\n  }\n\n  return {\n    handleLog,\n  }\n}\n\nexport function isAuthorized(status: StatusType, handlerType: HandlerType, logger: Logger) {\n  const loggerHandler = logger.getHandler()\n  const sanitizedHandlerType = Array.isArray(loggerHandler) ? loggerHandler : [loggerHandler]\n  return (\n    STATUS_PRIORITIES[status] >= STATUS_PRIORITIES[logger.getLevel()] && includes(sanitizedHandlerType, handlerType)\n  )\n}\n\nfunction displayInConsole(logsMessage: LogsMessage, messageContext: Context | undefined) {\n  originalConsoleMethods[logsMessage.status].call(globalConsole, logsMessage.message, messageContext)\n}\n","import type { RelativeTime } from '@datadog/browser-core'\nimport { Observable, performDraw, startSessionManager } from '@datadog/browser-core'\nimport type { LogsConfiguration } from './configuration'\n\nexport const LOGS_SESSION_KEY = 'logs'\n\nexport interface LogsSessionManager {\n  findTrackedSession: (startTime?: RelativeTime) => LogsSession | undefined\n  expireObservable: Observable<void>\n}\n\nexport type LogsSession = {\n  id?: string // session can be tracked without id\n}\n\nexport const enum LoggerTrackingType {\n  NOT_TRACKED = '0',\n  TRACKED = '1',\n}\n\nexport function startLogsSessionManager(configuration: LogsConfiguration): LogsSessionManager {\n  const sessionManager = startSessionManager(configuration, LOGS_SESSION_KEY, (rawTrackingType) =>\n    computeSessionState(configuration, rawTrackingType)\n  )\n  return {\n    findTrackedSession: (startTime) => {\n      const session = sessionManager.findActiveSession(startTime)\n      return session && session.trackingType === LoggerTrackingType.TRACKED\n        ? {\n            id: session.id,\n          }\n        : undefined\n    },\n    expireObservable: sessionManager.expireObservable,\n  }\n}\n\nexport function startLogsSessionManagerStub(configuration: LogsConfiguration): LogsSessionManager {\n  const isTracked = computeTrackingType(configuration) === LoggerTrackingType.TRACKED\n  const session = isTracked ? {} : undefined\n  return {\n    findTrackedSession: () => session,\n    expireObservable: new Observable(),\n  }\n}\n\nfunction computeTrackingType(configuration: LogsConfiguration) {\n  if (!performDraw(configuration.sessionSampleRate)) {\n    return LoggerTrackingType.NOT_TRACKED\n  }\n  return LoggerTrackingType.TRACKED\n}\n\nfunction computeSessionState(configuration: LogsConfiguration, rawSessionType?: string) {\n  const trackingType = hasValidLoggerSession(rawSessionType) ? rawSessionType : computeTrackingType(configuration)\n  return {\n    trackingType,\n    isTracked: trackingType === LoggerTrackingType.TRACKED,\n  }\n}\n\nfunction hasValidLoggerSession(trackingType?: string): trackingType is LoggerTrackingType {\n  return trackingType === LoggerTrackingType.NOT_TRACKED || trackingType === LoggerTrackingType.TRACKED\n}\n","import type { FetchResolveContext, XhrCompleteContext } from '@datadog/browser-core'\nimport {\n  ErrorSource,\n  initXhrObservable,\n  RequestType,\n  initFetchObservable,\n  computeStackTrace,\n  toStackTraceString,\n  monitor,\n  noop,\n  readBytesFromStream,\n  tryToClone,\n  isServerError,\n} from '@datadog/browser-core'\nimport type { LogsConfiguration } from '../configuration'\nimport type { LifeCycle } from '../lifeCycle'\nimport { LifeCycleEventType } from '../lifeCycle'\nimport { StatusType } from '../logger'\n\nexport function startNetworkErrorCollection(configuration: LogsConfiguration, lifeCycle: LifeCycle) {\n  if (!configuration.forwardErrorsToLogs) {\n    return { stop: noop }\n  }\n\n  const xhrSubscription = initXhrObservable(configuration).subscribe((context) => {\n    if (context.state === 'complete') {\n      handleResponse(RequestType.XHR, context)\n    }\n  })\n  const fetchSubscription = initFetchObservable().subscribe((context) => {\n    if (context.state === 'resolve') {\n      handleResponse(RequestType.FETCH, context)\n    }\n  })\n\n  function handleResponse(type: RequestType, request: XhrCompleteContext | FetchResolveContext) {\n    if (!configuration.isIntakeUrl(request.url) && (isRejected(request) || isServerError(request.status))) {\n      if ('xhr' in request) {\n        computeXhrResponseData(request.xhr, configuration, onResponseDataAvailable)\n      } else if (request.response) {\n        computeFetchResponseText(request.response, configuration, onResponseDataAvailable)\n      } else if (request.error) {\n        computeFetchErrorText(request.error, configuration, onResponseDataAvailable)\n      }\n    }\n\n    function onResponseDataAvailable(responseData: unknown) {\n      lifeCycle.notify(LifeCycleEventType.RAW_LOG_COLLECTED, {\n        rawLogsEvent: {\n          message: `${format(type)} error ${request.method} ${request.url}`,\n          date: request.startClocks.timeStamp,\n          error: {\n            origin: ErrorSource.NETWORK, // Todo: Remove in the next major release\n            stack: (responseData as string) || 'Failed to load',\n          },\n          http: {\n            method: request.method as any, // Cast resource method because of case mismatch cf issue RUMF-1152\n            status_code: request.status,\n            url: request.url,\n          },\n          status: StatusType.error,\n          origin: ErrorSource.NETWORK,\n        },\n      })\n    }\n  }\n\n  return {\n    stop: () => {\n      xhrSubscription.unsubscribe()\n      fetchSubscription.unsubscribe()\n    },\n  }\n}\n\n// TODO: ideally, computeXhrResponseData should always call the callback with a string instead of\n// `unknown`. But to keep backward compatibility, in the case of XHR with a `responseType` different\n// than \"text\", the response data should be whatever `xhr.response` is. This is a bit confusing as\n// Logs event 'stack' is expected to be a string. This should be changed in a future major version\n// as it could be a breaking change.\nexport function computeXhrResponseData(\n  xhr: XMLHttpRequest,\n  configuration: LogsConfiguration,\n  callback: (responseData: unknown) => void\n) {\n  if (typeof xhr.response === 'string') {\n    callback(truncateResponseText(xhr.response, configuration))\n  } else {\n    callback(xhr.response)\n  }\n}\n\nexport function computeFetchErrorText(\n  error: Error,\n  configuration: LogsConfiguration,\n  callback: (errorText: string) => void\n) {\n  callback(truncateResponseText(toStackTraceString(computeStackTrace(error)), configuration))\n}\n\nexport function computeFetchResponseText(\n  response: Response,\n  configuration: LogsConfiguration,\n  callback: (responseText?: string) => void\n) {\n  const clonedResponse = tryToClone(response)\n  if (!clonedResponse || !clonedResponse.body) {\n    // if the clone failed or if the body is null, let's not try to read it.\n    callback()\n  } else if (!window.TextDecoder) {\n    // If the browser doesn't support TextDecoder, let's read the whole response then truncate it.\n    //\n    // This should only be the case on early versions of Edge (before they migrated to Chromium).\n    // Even if it could be possible to implement a workaround for the missing TextDecoder API (using\n    // a Blob and FileReader), we found another issue preventing us from reading only the first\n    // bytes from the response: contrary to other browsers, when reading from the cloned response,\n    // if the original response gets canceled, the cloned response is also canceled and we can't\n    // know about it.  In the following illustration, the promise returned by `reader.read()` may\n    // never be fulfilled:\n    //\n    // fetch('/').then((response) => {\n    //   const reader = response.clone().body.getReader()\n    //   readMore()\n    //   function readMore() {\n    //     reader.read().then(\n    //       (result) => {\n    //         if (result.done) {\n    //           console.log('done')\n    //         } else {\n    //           readMore()\n    //         }\n    //       },\n    //       () => console.log('error')\n    //     )\n    //   }\n    //   response.body.getReader().cancel()\n    // })\n    clonedResponse.text().then(\n      monitor((text) => callback(truncateResponseText(text, configuration))),\n      monitor((error) => callback(`Unable to retrieve response: ${error as string}`))\n    )\n  } else {\n    truncateResponseStream(\n      clonedResponse.body,\n      configuration.requestErrorResponseLengthLimit,\n      (error, responseText) => {\n        if (error) {\n          callback(`Unable to retrieve response: ${error as unknown as string}`)\n        } else {\n          callback(responseText)\n        }\n      }\n    )\n  }\n}\n\nfunction isRejected(request: { status: number; responseType?: string }) {\n  return request.status === 0 && request.responseType !== 'opaque'\n}\n\nfunction truncateResponseText(responseText: string, configuration: LogsConfiguration) {\n  if (responseText.length > configuration.requestErrorResponseLengthLimit) {\n    return `${responseText.substring(0, configuration.requestErrorResponseLengthLimit)}...`\n  }\n  return responseText\n}\n\nfunction format(type: RequestType) {\n  if (RequestType.XHR === type) {\n    return 'XHR'\n  }\n  return 'Fetch'\n}\n\nfunction truncateResponseStream(\n  stream: ReadableStream<Uint8Array>,\n  bytesLimit: number,\n  callback: (error?: Error, responseText?: string) => void\n) {\n  readBytesFromStream(\n    stream,\n    (error, bytes, limitExceeded) => {\n      if (error) {\n        callback(error)\n      } else {\n        let responseText = new TextDecoder().decode(bytes)\n        if (limitExceeded) {\n          responseText += '...'\n        }\n        callback(undefined, responseText)\n      }\n    },\n    {\n      bytesLimit,\n      collectStreamBody: true,\n    }\n  )\n}\n","import type { Context, ClocksState, RawReport } from '@datadog/browser-core'\nimport {\n  timeStampNow,\n  ErrorSource,\n  RawReportType,\n  getFileFromStackTraceString,\n  initReportObservable,\n} from '@datadog/browser-core'\nimport type { LogsConfiguration } from '../configuration'\nimport type { LifeCycle } from '../lifeCycle'\nimport { LifeCycleEventType } from '../lifeCycle'\nimport { StatusType } from '../logger'\n\nexport interface ProvidedError {\n  startClocks: ClocksState\n  error: unknown\n  context?: Context\n  handlingStack: string\n}\n\nconst LogStatusForReport = {\n  [RawReportType.cspViolation]: StatusType.error,\n  [RawReportType.intervention]: StatusType.error,\n  [RawReportType.deprecation]: StatusType.warn,\n}\n\nexport function startReportCollection(configuration: LogsConfiguration, lifeCycle: LifeCycle) {\n  const reportSubscription = initReportObservable(configuration, configuration.forwardReports).subscribe(\n    (report: RawReport) => {\n      let message = report.message\n      const status = LogStatusForReport[report.type]\n      let error\n      if (status === StatusType.error) {\n        error = {\n          kind: report.subtype,\n          origin: ErrorSource.REPORT, // Todo: Remove in the next major release\n          stack: report.stack,\n        }\n      } else if (report.stack) {\n        message += ` Found in ${getFileFromStackTraceString(report.stack)!}`\n      }\n\n      lifeCycle.notify(LifeCycleEventType.RAW_LOG_COLLECTED, {\n        rawLogsEvent: {\n          date: timeStampNow(),\n          message,\n          origin: ErrorSource.REPORT,\n          error,\n          status,\n        },\n      })\n    }\n  )\n\n  return {\n    stop: () => {\n      reportSubscription.unsubscribe()\n    },\n  }\n}\n","import type { Context, RawError, ClocksState } from '@datadog/browser-core'\nimport { noop, ErrorSource, trackRuntimeError, Observable } from '@datadog/browser-core'\nimport type { LogsConfiguration } from '../configuration'\nimport type { LifeCycle } from '../lifeCycle'\nimport { LifeCycleEventType } from '../lifeCycle'\nimport { StatusType } from '../logger'\n\nexport interface ProvidedError {\n  startClocks: ClocksState\n  error: unknown\n  context?: Context\n  handlingStack: string\n}\n\nexport function startRuntimeErrorCollection(configuration: LogsConfiguration, lifeCycle: LifeCycle) {\n  if (!configuration.forwardErrorsToLogs) {\n    return { stop: noop }\n  }\n\n  const rawErrorObservable = new Observable<RawError>()\n\n  const { stop: stopRuntimeErrorTracking } = trackRuntimeError(rawErrorObservable)\n\n  const rawErrorSubscription = rawErrorObservable.subscribe((rawError) => {\n    lifeCycle.notify(LifeCycleEventType.RAW_LOG_COLLECTED, {\n      rawLogsEvent: {\n        message: rawError.message,\n        date: rawError.startClocks.timeStamp,\n        error: {\n          kind: rawError.type,\n          origin: ErrorSource.SOURCE, // Todo: Remove in the next major release\n          stack: rawError.stack,\n        },\n        origin: ErrorSource.SOURCE,\n        status: StatusType.error,\n      },\n    })\n  })\n\n  return {\n    stop: () => {\n      stopRuntimeErrorTracking()\n      rawErrorSubscription.unsubscribe()\n    },\n  }\n}\n","import { defineGlobal, getGlobalObject } from '@datadog/browser-core'\nimport type { LogsPublicApi } from '../boot/logsPublicApi'\nimport { makeLogsPublicApi } from '../boot/logsPublicApi'\nimport { startLogs } from '../boot/startLogs'\n\nexport { Logger, LogsMessage, StatusType, HandlerType } from '../domain/logger'\nexport { LoggerConfiguration, LogsPublicApi as LogsGlobal } from '../boot/logsPublicApi'\nexport { LogsInitConfiguration } from '../domain/configuration'\nexport { LogsEvent } from '../logsEvent.types'\n\nexport const datadogLogs = makeLogsPublicApi(startLogs)\n\ninterface BrowserWindow extends Window {\n  DD_LOGS?: LogsPublicApi\n}\ndefineGlobal(getGlobalObject<BrowserWindow>(), 'DD_LOGS', datadogLogs)\n","import type { Context, Observable, PageExitEvent, RawError } from '@datadog/browser-core'\nimport { startBatchWithReplica } from '@datadog/browser-core'\nimport type { LogsConfiguration } from '../domain/configuration'\nimport type { LifeCycle } from '../domain/lifeCycle'\nimport { LifeCycleEventType } from '../domain/lifeCycle'\nimport type { LogsEvent } from '../logsEvent.types'\n\nexport function startLogsBatch(\n  configuration: LogsConfiguration,\n  lifeCycle: LifeCycle,\n  reportError: (error: RawError) => void,\n  pageExitObservable: Observable<PageExitEvent>,\n  sessionExpireObservable: Observable<void>\n) {\n  const batch = startBatchWithReplica(\n    configuration,\n    {\n      endpoint: configuration.logsEndpointBuilder,\n    },\n    configuration.replica && {\n      endpoint: configuration.replica.logsEndpointBuilder,\n    },\n    reportError,\n    pageExitObservable,\n    sessionExpireObservable\n  )\n\n  lifeCycle.subscribe(LifeCycleEventType.LOG_COLLECTED, (serverLogsEvent: LogsEvent & Context) => {\n    batch.add(serverLogsEvent)\n  })\n\n  return batch\n}\n","import type { Context } from '@datadog/browser-core'\nimport { getEventBridge } from '@datadog/browser-core'\nimport type { LifeCycle } from '../domain/lifeCycle'\nimport { LifeCycleEventType } from '../domain/lifeCycle'\nimport type { LogsEvent } from '../logsEvent.types'\n\nexport function startLogsBridge(lifeCycle: LifeCycle) {\n  const bridge = getEventBridge<'log', LogsEvent>()!\n\n  lifeCycle.subscribe(LifeCycleEventType.LOG_COLLECTED, (serverLogsEvent: LogsEvent & Context) => {\n    bridge.send('log', serverLogsEvent)\n  })\n}\n","function createCustomError(name) {\n  function CustomError(message, code) {\n    Error.captureStackTrace && Error.captureStackTrace(this, this.constructor);\n    this.message = message;\n    this.code = code;\n  }\n\n  CustomError.prototype = new Error();\n  CustomError.prototype.name = name;\n  CustomError.prototype.constructor = CustomError;\n\n  return CustomError;\n}\n\nconst LDUnexpectedResponseError = createCustomError('LaunchDarklyUnexpectedResponseError');\nconst LDInvalidEnvironmentIdError = createCustomError('LaunchDarklyInvalidEnvironmentIdError');\nconst LDInvalidUserError = createCustomError('LaunchDarklyInvalidUserError');\nconst LDInvalidEventKeyError = createCustomError('LaunchDarklyInvalidEventKeyError');\nconst LDInvalidArgumentError = createCustomError('LaunchDarklyInvalidArgumentError');\nconst LDFlagFetchError = createCustomError('LaunchDarklyFlagFetchError');\nconst LDInvalidDataError = createCustomError('LaunchDarklyInvalidDataError');\nconst LDTimeoutError = createCustomError('LaunchDarklyTimeoutError');\n\nfunction isHttpErrorRecoverable(status) {\n  if (status >= 400 && status < 500) {\n    return status === 400 || status === 408 || status === 429;\n  }\n  return true;\n}\n\nmodule.exports = {\n  LDUnexpectedResponseError,\n  LDInvalidEnvironmentIdError,\n  LDInvalidUserError,\n  LDInvalidEventKeyError,\n  LDInvalidArgumentError,\n  LDInvalidDataError,\n  LDFlagFetchError,\n  LDTimeoutError,\n  isHttpErrorRecoverable,\n};\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","'use strict';\n\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nvar hasProp = Object.prototype.hasOwnProperty;\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    var arrA = isArray(a)\n      , arrB = isArray(b)\n      , i\n      , length\n      , key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n    if (arrA != arrB) return false;\n\n    var dateA = a instanceof Date\n      , dateB = b instanceof Date;\n    if (dateA != dateB) return false;\n    if (dateA && dateB) return a.getTime() == b.getTime();\n\n    var regexpA = a instanceof RegExp\n      , regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) return false;\n    if (regexpA && regexpB) return a.toString() == b.toString();\n\n    var keys = keyList(a);\n    length = keys.length;\n\n    if (length !== keyList(b).length)\n      return false;\n\n    for (i = length; i-- !== 0;)\n      if (!hasProp.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  return a!==a && b!==b;\n};\n","const base64 = require('base64-js');\nconst fastDeepEqual = require('fast-deep-equal');\n\nconst userAttrsToStringify = ['key', 'ip', 'country', 'email', 'firstName', 'lastName', 'avatar', 'name'];\n\nfunction appendUrlPath(baseUrl, path) {\n  // Ensure that URL concatenation is done correctly regardless of whether the\n  // base URL has a trailing slash or not.\n  const trimBaseUrl = baseUrl.endsWith('/') ? baseUrl.substring(0, baseUrl.length - 1) : baseUrl;\n  return trimBaseUrl + (path.startsWith('/') ? '' : '/') + path;\n}\n\n// See http://ecmanaut.blogspot.com/2006/07/encoding-decoding-utf8-in-javascript.html\nfunction btoa(s) {\n  const escaped = unescape(encodeURIComponent(s));\n  return base64.fromByteArray(stringToBytes(escaped));\n}\n\nfunction stringToBytes(s) {\n  const b = [];\n  for (let i = 0; i < s.length; i++) {\n    b.push(s.charCodeAt(i));\n  }\n  return b;\n}\n\nfunction base64URLEncode(s) {\n  return (\n    btoa(s)\n      // eslint-disable-next-line\n      .replace(/=/g, '')\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n  );\n}\n\nfunction clone(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nfunction deepEquals(a, b) {\n  return fastDeepEqual(a, b);\n}\n\n// Events emitted in LDClient's initialize method will happen before the consumer\n// can register a listener, so defer them to next tick.\nfunction onNextTick(cb) {\n  setTimeout(cb, 0);\n}\n\n/**\n * Wrap a promise to invoke an optional callback upon resolution or rejection.\n *\n * This function assumes the callback follows the Node.js callback type: (err, value) => void\n *\n * If a callback is provided:\n *   - if the promise is resolved, invoke the callback with (null, value)\n *   - if the promise is rejected, invoke the callback with (error, null)\n *\n * @param {Promise<any>} promise\n * @param {Function} callback\n * @returns Promise<any> | undefined\n */\nfunction wrapPromiseCallback(promise, callback) {\n  const ret = promise.then(\n    value => {\n      if (callback) {\n        setTimeout(() => {\n          callback(null, value);\n        }, 0);\n      }\n      return value;\n    },\n    error => {\n      if (callback) {\n        setTimeout(() => {\n          callback(error, null);\n        }, 0);\n      } else {\n        return Promise.reject(error);\n      }\n    }\n  );\n\n  return !callback ? ret : undefined;\n}\n\n/**\n * Takes a map of flag keys to values, and returns the more verbose structure used by the\n * client stream.\n */\nfunction transformValuesToVersionedValues(flags) {\n  const ret = {};\n  for (const key in flags) {\n    if (objectHasOwnProperty(flags, key)) {\n      ret[key] = { value: flags[key], version: 0 };\n    }\n  }\n  return ret;\n}\n\n/**\n * Converts the internal flag state map to a simple map of flag keys to values.\n */\nfunction transformVersionedValuesToValues(flagsState) {\n  const ret = {};\n  for (const key in flagsState) {\n    if (objectHasOwnProperty(flagsState, key)) {\n      ret[key] = flagsState[key].value;\n    }\n  }\n  return ret;\n}\n\nfunction getLDUserAgentString(platform) {\n  const version = platform.version || '?';\n  return platform.userAgent + '/' + version;\n}\n\nfunction extend(...objects) {\n  return objects.reduce((acc, obj) => ({ ...acc, ...obj }), {});\n}\n\nfunction objectHasOwnProperty(object, name) {\n  return Object.prototype.hasOwnProperty.call(object, name);\n}\n\nfunction sanitizeContext(context) {\n  if (!context) {\n    return context;\n  }\n  let newContext;\n  // Only stringify user attributes for legacy users.\n  if (context.kind === null || context.kind === undefined) {\n    userAttrsToStringify.forEach(attr => {\n      const value = context[attr];\n      if (value !== undefined && typeof value !== 'string') {\n        newContext = newContext || { ...context };\n        newContext[attr] = String(value);\n      }\n    });\n  }\n\n  return newContext || context;\n}\n\nmodule.exports = {\n  appendUrlPath,\n  base64URLEncode,\n  btoa,\n  clone,\n  deepEquals,\n  extend,\n  getLDUserAgentString,\n  objectHasOwnProperty,\n  onNextTick,\n  sanitizeContext,\n  transformValuesToVersionedValues,\n  transformVersionedValuesToValues,\n  wrapPromiseCallback,\n};\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js'; // **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\n\nvar _nodeId;\n\nvar _clockseq; // Previous uuid creation time\n\n\nvar _lastMSecs = 0;\nvar _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  var i = buf && offset || 0;\n  var b = buf || new Array(16);\n  options = options || {};\n  var node = options.node || _nodeId;\n  var clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    var seedBytes = options.random || (options.rng || rng)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  var msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  var nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  var dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  var tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  var tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (var n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf || stringify(b);\n}\n\nexport default v1;","import validate from './validate.js';\n\nfunction parse(uuid) {\n  if (!validate(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  var v;\n  var arr = new Uint8Array(16); // Parse ########-....-....-....-............\n\n  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;\n  arr[1] = v >>> 16 & 0xff;\n  arr[2] = v >>> 8 & 0xff;\n  arr[3] = v & 0xff; // Parse ........-####-....-....-............\n\n  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;\n  arr[5] = v & 0xff; // Parse ........-....-####-....-............\n\n  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;\n  arr[7] = v & 0xff; // Parse ........-....-....-####-............\n\n  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;\n  arr[9] = v & 0xff; // Parse ........-....-....-....-############\n  // (Use \"/\" to avoid 32-bit truncation when bit-shifting high-order bytes)\n\n  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;\n  arr[11] = v / 0x100000000 & 0xff;\n  arr[12] = v >>> 24 & 0xff;\n  arr[13] = v >>> 16 & 0xff;\n  arr[14] = v >>> 8 & 0xff;\n  arr[15] = v & 0xff;\n  return arr;\n}\n\nexport default parse;","import stringify from './stringify.js';\nimport parse from './parse.js';\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  var bytes = [];\n\n  for (var i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nexport var DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport var URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function (name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = parse(namespace);\n    }\n\n    if (namespace.length !== 16) {\n      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    } // Compute hash of namespace and value, Per 4.3\n    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =\n    // hashfunc([...namespace, ... value])`\n\n\n    var bytes = new Uint8Array(16 + value.length);\n    bytes.set(namespace);\n    bytes.set(value, namespace.length);\n    bytes = hashfunc(bytes);\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (var i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return stringify(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Uint8Array(msg.length);\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes[i] = msg.charCodeAt(i);\n    }\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  var output = [];\n  var length32 = input.length * 32;\n  var hexTab = '0123456789abcdef';\n\n  for (var i = 0; i < length32; i += 8) {\n    var x = input[i >> 5] >>> i % 32 & 0xff;\n    var hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/**\n * Calculate output length with padding and bit length\n */\n\n\nfunction getOutputLength(inputLength8) {\n  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[getOutputLength(len) - 1] = len;\n  var a = 1732584193;\n  var b = -271733879;\n  var c = -1732584194;\n  var d = 271733878;\n\n  for (var i = 0; i < x.length; i += 16) {\n    var olda = a;\n    var oldb = b;\n    var oldc = c;\n    var oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  if (input.length === 0) {\n    return [];\n  }\n\n  var length8 = input.length * 8;\n  var output = new Uint32Array(getOutputLength(length8));\n\n  for (var i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  var lsw = (x & 0xffff) + (y & 0xffff);\n  var msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nexport default md5;","import v35 from './v35.js';\nimport md5 from './md5.js';\nvar v3 = v35('v3', 0x30, md5);\nexport default v3;","// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  var K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  var H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    var msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (var i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  } else if (!Array.isArray(bytes)) {\n    // Convert Array-like to Array\n    bytes = Array.prototype.slice.call(bytes);\n  }\n\n  bytes.push(0x80);\n  var l = bytes.length / 4 + 2;\n  var N = Math.ceil(l / 16);\n  var M = new Array(N);\n\n  for (var _i = 0; _i < N; ++_i) {\n    var arr = new Uint32Array(16);\n\n    for (var j = 0; j < 16; ++j) {\n      arr[j] = bytes[_i * 64 + j * 4] << 24 | bytes[_i * 64 + j * 4 + 1] << 16 | bytes[_i * 64 + j * 4 + 2] << 8 | bytes[_i * 64 + j * 4 + 3];\n    }\n\n    M[_i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (var _i2 = 0; _i2 < N; ++_i2) {\n    var W = new Uint32Array(80);\n\n    for (var t = 0; t < 16; ++t) {\n      W[t] = M[_i2][t];\n    }\n\n    for (var _t = 16; _t < 80; ++_t) {\n      W[_t] = ROTL(W[_t - 3] ^ W[_t - 8] ^ W[_t - 14] ^ W[_t - 16], 1);\n    }\n\n    var a = H[0];\n    var b = H[1];\n    var c = H[2];\n    var d = H[3];\n    var e = H[4];\n\n    for (var _t2 = 0; _t2 < 80; ++_t2) {\n      var s = Math.floor(_t2 / 20);\n      var T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[_t2] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nexport default sha1;","import v35 from './v35.js';\nimport sha1 from './sha1.js';\nvar v5 = v35('v5', 0x50, sha1);\nexport default v5;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","export default '00000000-0000-0000-0000-000000000000';","import validate from './validate.js';\n\nfunction version(uuid) {\n  if (!validate(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  return parseInt(uuid.substr(14, 1), 16);\n}\n\nexport default version;","const logLevels = ['debug', 'info', 'warn', 'error', 'none'];\n\n/**\n * A simple logger that writes to stderr.\n */\nfunction commonBasicLogger(options, formatFn) {\n  if (options && options.destination && typeof options.destination !== 'function') {\n    throw new Error('destination for basicLogger was set to a non-function');\n  }\n\n  function toConsole(methodName) {\n    // The global console variable is not guaranteed to be defined at all times in all browsers:\n    // https://www.beyondjava.net/console-log-surprises-with-internet-explorer-11-and-edge\n    return function(line) {\n      if (console && console[methodName]) {\n        console[methodName].call(console, line);\n      }\n    };\n  }\n  const destinations =\n    options && options.destination\n      ? [options.destination, options.destination, options.destination, options.destination]\n      : [toConsole('log'), toConsole('info'), toConsole('warn'), toConsole('error')];\n  const prependLevelToMessage = !!(options && options.destination); // if we're writing to console.warn, etc. we don't need the prefix\n  const prefix =\n    !options || options.prefix === undefined || options.prefix === null ? '[LaunchDarkly] ' : options.prefix;\n\n  let minLevel = 1; // default is 'info'\n  if (options && options.level) {\n    for (let i = 0; i < logLevels.length; i++) {\n      if (logLevels[i] === options.level) {\n        minLevel = i;\n      }\n    }\n  }\n\n  function write(levelIndex, levelName, args) {\n    if (args.length < 1) {\n      return;\n    }\n    let line;\n    const fullPrefix = prependLevelToMessage ? levelName + ': ' + prefix : prefix;\n    if (args.length === 1 || !formatFn) {\n      line = fullPrefix + args[0];\n    } else {\n      const tempArgs = [...args];\n      tempArgs[0] = fullPrefix + tempArgs[0];\n      line = formatFn(...tempArgs);\n    }\n    try {\n      destinations[levelIndex](line);\n    } catch (err) {\n      console &&\n        console.log &&\n        console.log(\"[LaunchDarkly] Configured logger's \" + levelName + ' method threw an exception: ' + err);\n    }\n  }\n\n  const logger = {};\n  for (let i = 0; i < logLevels.length; i++) {\n    const levelName = logLevels[i];\n    if (levelName !== 'none') {\n      if (i < minLevel) {\n        logger[levelName] = () => {};\n      } else {\n        const levelIndex = i;\n        logger[levelName] = function() {\n          // can't use arrow function with \"arguments\"\n          write(levelIndex, levelName, arguments);\n        };\n      }\n    }\n  }\n\n  return logger;\n}\n\nfunction validateLogger(logger) {\n  logLevels.forEach(level => {\n    if (level !== 'none' && (!logger[level] || typeof logger[level] !== 'function')) {\n      throw new Error('Provided logger instance must support logger.' + level + '(...) method');\n      // Note that the SDK normally does not throw exceptions to the application, but that rule\n      // does not apply to LDClient.init() which will throw an exception if the parameters are so\n      // invalid that we cannot proceed with creating the client. An invalid logger meets those\n      // criteria since the SDK calls the logger during nearly all of its operations.\n    }\n  });\n}\n\nmodule.exports = {\n  commonBasicLogger,\n  validateLogger,\n};\n","const errors = require('./errors');\n\nfunction errorString(err) {\n  if (err && err.message) {\n    return err.message;\n  }\n  if (typeof err === 'string' || err instanceof String) {\n    return err;\n  }\n  return JSON.stringify(err);\n}\n\nconst clientInitialized = function() {\n  return 'LaunchDarkly client initialized';\n};\n\nconst docLink =\n  ' Please see https://docs.launchdarkly.com/sdk/client-side/javascript#initialize-the-client for instructions on SDK initialization.';\n\nconst clientNotReady = function() {\n  return 'LaunchDarkly client is not ready';\n};\n\nconst eventCapacityExceeded = function() {\n  return 'Exceeded event queue capacity. Increase capacity to avoid dropping events.';\n};\n\nconst eventWithoutContext = function() {\n  return 'Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript';\n};\n\nconst invalidContentType = function(contentType) {\n  return 'Expected application/json content type but got \"' + contentType + '\"';\n};\n\nconst invalidKey = function() {\n  return 'Event key must be a string';\n};\n\nconst localStorageUnavailable = function(err) {\n  return 'local storage is unavailable: ' + errorString(err);\n};\n\nconst networkError = e => 'network error' + (e ? ' (' + e + ')' : '');\n\n// We should remove unknownCustomEventKey in the future - see comments in track() in index.js\nconst unknownCustomEventKey = function(key) {\n  return 'Custom event \"' + key + '\" does not exist';\n};\n\nconst environmentNotFound = function() {\n  return 'Environment not found. Double check that you specified a valid environment/client-side ID.' + docLink;\n};\n\nconst environmentNotSpecified = function() {\n  return 'No environment/client-side ID was specified.' + docLink;\n};\n\nconst errorFetchingFlags = function(err) {\n  return 'Error fetching flag settings: ' + errorString(err);\n};\n\nconst contextNotSpecified = function() {\n  return 'No context specified.' + docLink;\n};\n\nconst invalidContext = function() {\n  return 'Invalid context specified.' + docLink;\n};\n\nconst invalidData = function() {\n  return 'Invalid data received from LaunchDarkly; connection may have been interrupted';\n};\n\nconst bootstrapOldFormat = function() {\n  return (\n    'LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. ' +\n    'Events may not be sent correctly.' +\n    docLink\n  );\n};\n\nconst bootstrapInvalid = function() {\n  return 'LaunchDarkly bootstrap data is not available because the back end could not read the flags.';\n};\n\nconst deprecated = function(oldName, newName) {\n  if (newName) {\n    return '\"' + oldName + '\" is deprecated, please use \"' + newName + '\"';\n  }\n  return '\"' + oldName + '\" is deprecated';\n};\n\nconst httpErrorMessage = function(status, context, retryMessage) {\n  return (\n    'Received error ' +\n    status +\n    (status === 401 ? ' (invalid SDK key)' : '') +\n    ' for ' +\n    context +\n    ' - ' +\n    (errors.isHttpErrorRecoverable(status) ? retryMessage : 'giving up permanently')\n  );\n};\n\nconst httpUnavailable = function() {\n  return 'Cannot make HTTP requests in this environment.' + docLink;\n};\n\nconst identifyDisabled = function() {\n  return 'identify() has no effect here; it must be called on the main client instance';\n};\n\nconst streamClosing = function() {\n  return 'Closing stream connection';\n};\n\nconst streamConnecting = function(url) {\n  return 'Opening stream connection to ' + url;\n};\n\nconst streamError = function(err, streamReconnectDelay) {\n  return (\n    'Error on stream connection: ' +\n    errorString(err) +\n    ', will continue retrying after ' +\n    streamReconnectDelay +\n    ' milliseconds.'\n  );\n};\n\nconst unknownOption = name => 'Ignoring unknown config option \"' + name + '\"';\n\nconst unrecoverableStreamError = err => `Error on stream connection ${errorString(err)}, giving up permanently`;\n\nconst wrongOptionType = (name, expectedType, actualType) =>\n  'Config option \"' + name + '\" should be of type ' + expectedType + ', got ' + actualType + ', using default value';\n\nconst wrongOptionTypeBoolean = (name, actualType) =>\n  'Config option \"' + name + '\" should be a boolean, got ' + actualType + ', converting to boolean';\n\nconst optionBelowMinimum = (name, value, minimum) =>\n  'Config option \"' + name + '\" was set to ' + value + ', changing to minimum value of ' + minimum;\n\nconst debugPolling = function(url) {\n  return 'polling for feature flags at ' + url;\n};\n\nconst debugStreamPing = function() {\n  return 'received ping message from stream';\n};\n\nconst debugStreamPut = function() {\n  return 'received streaming update for all flags';\n};\n\nconst debugStreamPatch = function(key) {\n  return 'received streaming update for flag \"' + key + '\"';\n};\n\nconst debugStreamPatchIgnored = function(key) {\n  return 'received streaming update for flag \"' + key + '\" but ignored due to version check';\n};\n\nconst debugStreamDelete = function(key) {\n  return 'received streaming deletion for flag \"' + key + '\"';\n};\n\nconst debugStreamDeleteIgnored = function(key) {\n  return 'received streaming deletion for flag \"' + key + '\" but ignored due to version check';\n};\n\nconst debugEnqueueingEvent = function(kind) {\n  return 'enqueueing \"' + kind + '\" event';\n};\n\nconst debugPostingEvents = function(count) {\n  return 'sending ' + count + ' events';\n};\n\nconst debugPostingDiagnosticEvent = function(event) {\n  return 'sending diagnostic event (' + event.kind + ')';\n};\n\nconst invalidInspector = (type, name) => `an inspector: \"${name}\" of an invalid type (${type}) was configured`;\n\nconst inspectorMethodError = (type, name) => `an inspector: \"${name}\" of type: \"${type}\" generated an exception`;\n\nconst invalidTagValue = name => `Config option \"${name}\" must only contain letters, numbers, ., _ or -.`;\n\nconst tagValueTooLong = name => `Value of \"${name}\" was longer than 64 characters and was discarded.`;\n\nconst invalidMetricValue = badType =>\n  `The track function was called with a non-numeric \"metricValue\" (${badType}), only numeric metric values are supported.`;\n\nmodule.exports = {\n  bootstrapInvalid,\n  bootstrapOldFormat,\n  clientInitialized,\n  clientNotReady,\n  debugEnqueueingEvent,\n  debugPostingDiagnosticEvent,\n  debugPostingEvents,\n  debugStreamDelete,\n  debugStreamDeleteIgnored,\n  debugStreamPatch,\n  debugStreamPatchIgnored,\n  debugStreamPing,\n  debugPolling,\n  debugStreamPut,\n  deprecated,\n  environmentNotFound,\n  environmentNotSpecified,\n  errorFetchingFlags,\n  eventCapacityExceeded,\n  eventWithoutContext,\n  httpErrorMessage,\n  httpUnavailable,\n  identifyDisabled,\n  inspectorMethodError,\n  invalidContentType,\n  invalidData,\n  invalidInspector,\n  invalidKey,\n  invalidMetricValue,\n  invalidContext,\n  invalidTagValue,\n  localStorageUnavailable,\n  networkError,\n  optionBelowMinimum,\n  streamClosing,\n  streamConnecting,\n  streamError,\n  tagValueTooLong,\n  unknownCustomEventKey,\n  unknownOption,\n  contextNotSpecified,\n  unrecoverableStreamError,\n  wrongOptionType,\n  wrongOptionTypeBoolean,\n};\n","const errors = require('./errors');\nconst { validateLogger } = require('./loggers');\nconst messages = require('./messages');\nconst utils = require('./utils');\n\n// baseOptionDefs should contain an entry for each supported configuration option in the common package.\n// Each entry can have three properties:\n// - \"default\": the default value if any\n// - \"type\": a type constraint used if the type can't be inferred from the default value). The allowable\n//   values are \"boolean\", \"string\", \"number\", \"array\", \"object\", \"function\", or several of these OR'd\n//   together with \"|\" (\"function|object\").\n// - \"minimum\": minimum value if any for numeric properties\n//\n// The extraOptionDefs parameter to validate() uses the same format.\nconst baseOptionDefs = {\n  baseUrl: { default: 'https://app.launchdarkly.com' },\n  streamUrl: { default: 'https://clientstream.launchdarkly.com' },\n  eventsUrl: { default: 'https://events.launchdarkly.com' },\n  sendEvents: { default: true },\n  streaming: { type: 'boolean' }, // default for this is undefined, which is different from false\n  sendLDHeaders: { default: true },\n  requestHeaderTransform: { type: 'function' },\n  sendEventsOnlyForVariation: { default: false },\n  useReport: { default: false },\n  evaluationReasons: { default: false },\n  eventCapacity: { default: 100, minimum: 1 },\n  flushInterval: { default: 2000, minimum: 2000 },\n  samplingInterval: { default: 0, minimum: 0 },\n  streamReconnectDelay: { default: 1000, minimum: 0 },\n  allAttributesPrivate: { default: false },\n  privateAttributes: { default: [] },\n  bootstrap: { type: 'string|object' },\n  diagnosticRecordingInterval: { default: 900000, minimum: 2000 },\n  diagnosticOptOut: { default: false },\n  wrapperName: { type: 'string' },\n  wrapperVersion: { type: 'string' },\n  stateProvider: { type: 'object' }, // not a public option, used internally\n  application: { validator: applicationConfigValidator },\n  inspectors: { default: [] },\n};\n\n/**\n * Expression to validate characters that are allowed in tag keys and values.\n */\nconst allowedTagCharacters = /^(\\w|\\.|-)+$/;\n\nfunction canonicalizeUrl(url) {\n  return url && url.replace(/\\/+$/, '');\n}\n\n/**\n * Verify that a value meets the requirements for a tag value.\n * @param {string} tagValue\n * @param {Object} logger\n */\nfunction validateTagValue(name, tagValue, logger) {\n  if (typeof tagValue !== 'string' || !tagValue.match(allowedTagCharacters)) {\n    logger.warn(messages.invalidTagValue(name));\n    return undefined;\n  }\n  if (tagValue.length > 64) {\n    logger.warn(messages.tagValueTooLong(name));\n    return undefined;\n  }\n  return tagValue;\n}\n\nfunction applicationConfigValidator(name, value, logger) {\n  const validated = {};\n  if (value.id) {\n    validated.id = validateTagValue(`${name}.id`, value.id, logger);\n  }\n  if (value.version) {\n    validated.version = validateTagValue(`${name}.version`, value.version, logger);\n  }\n  return validated;\n}\n\nfunction validate(options, emitter, extraOptionDefs, logger) {\n  const optionDefs = utils.extend({ logger: { default: logger } }, baseOptionDefs, extraOptionDefs);\n\n  const deprecatedOptions = {\n    // As of the latest major version, there are no deprecated options. Next time we deprecate\n    // something, add an item here where the property name is the deprecated name, and the\n    // property value is the preferred name if any, or null/undefined if there is no replacement.\n  };\n\n  function checkDeprecatedOptions(config) {\n    const opts = config;\n    Object.keys(deprecatedOptions).forEach(oldName => {\n      if (opts[oldName] !== undefined) {\n        const newName = deprecatedOptions[oldName];\n        logger && logger.warn(messages.deprecated(oldName, newName));\n        if (newName) {\n          if (opts[newName] === undefined) {\n            opts[newName] = opts[oldName];\n          }\n          delete opts[oldName];\n        }\n      }\n    });\n  }\n\n  function applyDefaults(config) {\n    // This works differently from utils.extend() in that it *will not* override a default value\n    // if the provided value is explicitly set to null. This provides backward compatibility\n    // since in the past we only used the provided values if they were truthy.\n    const ret = utils.extend({}, config);\n    Object.keys(optionDefs).forEach(name => {\n      if (ret[name] === undefined || ret[name] === null) {\n        ret[name] = optionDefs[name] && optionDefs[name].default;\n      }\n    });\n    return ret;\n  }\n\n  function validateTypesAndNames(config) {\n    const ret = utils.extend({}, config);\n    const typeDescForValue = value => {\n      if (value === null) {\n        return 'any';\n      }\n      if (value === undefined) {\n        return undefined;\n      }\n      if (Array.isArray(value)) {\n        return 'array';\n      }\n      const t = typeof value;\n      if (t === 'boolean' || t === 'string' || t === 'number' || t === 'function') {\n        return t;\n      }\n      return 'object';\n    };\n    Object.keys(config).forEach(name => {\n      const value = config[name];\n      if (value !== null && value !== undefined) {\n        const optionDef = optionDefs[name];\n        if (optionDef === undefined) {\n          reportArgumentError(messages.unknownOption(name));\n        } else {\n          const expectedType = optionDef.type || typeDescForValue(optionDef.default);\n          const validator = optionDef.validator;\n          if (validator) {\n            const validated = validator(name, config[name], logger);\n            if (validated !== undefined) {\n              ret[name] = validated;\n            } else {\n              delete ret[name];\n            }\n          } else if (expectedType !== 'any') {\n            const allowedTypes = expectedType.split('|');\n            const actualType = typeDescForValue(value);\n            if (allowedTypes.indexOf(actualType) < 0) {\n              if (expectedType === 'boolean') {\n                ret[name] = !!value;\n                reportArgumentError(messages.wrongOptionTypeBoolean(name, actualType));\n              } else {\n                reportArgumentError(messages.wrongOptionType(name, expectedType, actualType));\n                ret[name] = optionDef.default;\n              }\n            } else {\n              if (actualType === 'number' && optionDef.minimum !== undefined && value < optionDef.minimum) {\n                reportArgumentError(messages.optionBelowMinimum(name, value, optionDef.minimum));\n                ret[name] = optionDef.minimum;\n              }\n            }\n          }\n        }\n      }\n    });\n\n    ret.baseUrl = canonicalizeUrl(ret.baseUrl);\n    ret.streamUrl = canonicalizeUrl(ret.streamUrl);\n    ret.eventsUrl = canonicalizeUrl(ret.eventsUrl);\n\n    return ret;\n  }\n\n  function reportArgumentError(message) {\n    utils.onNextTick(() => {\n      emitter && emitter.maybeReportError(new errors.LDInvalidArgumentError(message));\n    });\n  }\n\n  let config = utils.extend({}, options || {});\n\n  checkDeprecatedOptions(config);\n\n  config = applyDefaults(config);\n  config = validateTypesAndNames(config);\n  validateLogger(config.logger);\n\n  return config;\n}\n\n/**\n * Get tags for the specified configuration.\n *\n * If any additional tags are added to the configuration, then the tags from\n * this method should be extended with those.\n * @param {Object} config The already valiated configuration.\n * @returns {Object} The tag configuration.\n */\nfunction getTags(config) {\n  const tags = {};\n  if (config) {\n    if (config.application && config.application.id !== undefined && config.application.id !== null) {\n      tags['application-id'] = [config.application.id];\n    }\n    if (config.application && config.application.version !== undefined && config.application.id !== null) {\n      tags['application-version'] = [config.application.version];\n    }\n  }\n\n  return tags;\n}\n\nmodule.exports = {\n  baseOptionDefs,\n  validate,\n  getTags,\n};\n","const { getLDUserAgentString } = require('./utils');\nconst configuration = require('./configuration');\n\nfunction getLDHeaders(platform, options) {\n  if (options && !options.sendLDHeaders) {\n    return {};\n  }\n  const h = {};\n  h[platform.userAgentHeaderName || 'User-Agent'] = getLDUserAgentString(platform);\n  if (options && options.wrapperName) {\n    h['X-LaunchDarkly-Wrapper'] = options.wrapperVersion\n      ? options.wrapperName + '/' + options.wrapperVersion\n      : options.wrapperName;\n  }\n  const tags = configuration.getTags(options);\n  const tagKeys = Object.keys(tags);\n  if (tagKeys.length) {\n    h['x-launchdarkly-tags'] = tagKeys\n      .sort()\n      .map(key =>\n        Array.isArray(tags[key]) ? tags[key].sort().map(value => `${key}/${value}`) : [`${key}/${tags[key]}`]\n      )\n      .reduce((flattened, item) => flattened.concat(item), [])\n      .join(' ');\n  }\n  return h;\n}\n\nfunction transformHeaders(headers, options) {\n  if (!options || !options.requestHeaderTransform) {\n    return headers;\n  }\n  return options.requestHeaderTransform({ ...headers });\n}\n\nmodule.exports = {\n  getLDHeaders,\n  transformHeaders,\n};\n","const errors = require('./errors');\nconst utils = require('./utils');\nconst { v1: uuidv1 } = require('uuid');\nconst { getLDHeaders, transformHeaders } = require('./headers');\n\nfunction EventSender(platform, environmentId, options) {\n  const baseHeaders = utils.extend({ 'Content-Type': 'application/json' }, getLDHeaders(platform, options));\n  const sender = {};\n\n  function getResponseInfo(result) {\n    const ret = { status: result.status };\n    const dateStr = result.header('date');\n    if (dateStr) {\n      const time = Date.parse(dateStr);\n      if (time) {\n        ret.serverTime = time;\n      }\n    }\n    return ret;\n  }\n\n  sender.sendEvents = (events, url, isDiagnostic) => {\n    if (!platform.httpRequest) {\n      return Promise.resolve();\n    }\n\n    const jsonBody = JSON.stringify(events);\n    const payloadId = isDiagnostic ? null : uuidv1();\n\n    function doPostRequest(canRetry) {\n      const headers = isDiagnostic\n        ? baseHeaders\n        : utils.extend({}, baseHeaders, {\n            'X-LaunchDarkly-Event-Schema': '4',\n            'X-LaunchDarkly-Payload-ID': payloadId,\n          });\n      return platform\n        .httpRequest('POST', url, transformHeaders(headers, options), jsonBody)\n        .promise.then(result => {\n          if (!result) {\n            // This was a response from a fire-and-forget request, so we won't have a status.\n            return;\n          }\n          if (result.status >= 400 && errors.isHttpErrorRecoverable(result.status) && canRetry) {\n            return doPostRequest(false);\n          } else {\n            return getResponseInfo(result);\n          }\n        })\n        .catch(() => {\n          if (canRetry) {\n            return doPostRequest(false);\n          }\n          return Promise.reject();\n        });\n    }\n\n    return doPostRequest(true).catch(() => {});\n  };\n\n  return sender;\n}\n\nmodule.exports = EventSender;\n","/**\n * Validate a context kind.\n * @param {string} kind\n * @returns true if the kind is valid.\n */\nconst { commonBasicLogger } = require('./loggers');\n\nfunction validKind(kind) {\n  return typeof kind === 'string' && kind !== 'kind' && kind.match(/^(\\w|\\.|-)+$/);\n}\n\n/**\n * Perform a check of basic context requirements.\n * @param {Object} context\n * @param {boolean} allowLegacyKey If true, then a legacy user can have an\n * empty or non-string key. A legacy user is a context without a kind.\n * @returns true if the context meets basic requirements.\n */\nfunction checkContext(context, allowLegacyKey) {\n  if (context) {\n    if (allowLegacyKey && (context.kind === undefined || context.kind === null)) {\n      return context.key !== undefined && context.key !== null;\n    }\n    const key = context.key;\n    const kind = context.kind === undefined ? 'user' : context.kind;\n    const kindValid = validKind(kind);\n    const keyValid = kind === 'multi' || (key !== undefined && key !== null && key !== '');\n    if (kind === 'multi') {\n      const kinds = Object.keys(context).filter(key => key !== 'kind');\n      return (\n        keyValid &&\n        kinds.every(key => validKind(key)) &&\n        kinds.every(key => {\n          const contextKey = context[key].key;\n          return contextKey !== undefined && contextKey !== null && contextKey !== '';\n        })\n      );\n    }\n    return keyValid && kindValid;\n  }\n  return false;\n}\n\n/**\n * For a given context get a list of context kinds.\n * @param {Object} context\n * @returns A list of kinds in the context.\n */\nfunction getContextKinds(context) {\n  if (context) {\n    if (context.kind === null || context.kind === undefined) {\n      return ['user'];\n    }\n    if (context.kind !== 'multi') {\n      return [context.kind];\n    }\n    return Object.keys(context).filter(kind => kind !== 'kind');\n  }\n  return [];\n}\n\n/**\n * The partial URL encoding is needed because : is a valid character in context keys.\n *\n * Partial encoding is the replacement of all colon (:) characters with the URL\n * encoded equivalent (%3A) and all percent (%) characters with the URL encoded\n * equivalent (%25).\n * @param {string} key The key to encode.\n * @returns {string} Partially URL encoded key.\n */\nfunction encodeKey(key) {\n  if (key.includes('%') || key.includes(':')) {\n    return key.replace(/%/g, '%25').replace(/:/g, '%3A');\n  }\n  return key;\n}\n\nfunction getCanonicalKey(context) {\n  if (context) {\n    if ((context.kind === undefined || context.kind === null || context.kind === 'user') && context.key) {\n      return context.key;\n    } else if (context.kind !== 'multi' && context.key) {\n      return `${context.kind}:${encodeKey(context.key)}`;\n    } else if (context.kind === 'multi') {\n      return Object.keys(context)\n        .sort()\n        .filter(key => key !== 'kind')\n        .map(key => `${key}:${encodeKey(context[key].key)}`)\n        .join(':');\n    }\n  }\n}\n\nfunction getContextKeys(context, logger = commonBasicLogger()) {\n  if (!context) {\n    return undefined;\n  }\n\n  const keys = {};\n  const { kind, key } = context;\n\n  switch (kind) {\n    case undefined:\n      keys.user = `${key}`;\n      break;\n    case 'multi':\n      Object.entries(context)\n        .filter(([key]) => key !== 'kind')\n        .forEach(([key, value]) => {\n          if (value && value.key) {\n            keys[key] = value.key;\n          }\n        });\n      break;\n    case null:\n      logger.warn(`null is not a valid context kind: ${context}`);\n      break;\n    case '':\n      logger.warn(`'' is not a valid context kind: ${context}`);\n      break;\n    default:\n      keys[kind] = `${key}`;\n      break;\n  }\n\n  return keys;\n}\n\nmodule.exports = {\n  checkContext,\n  getContextKeys,\n  getContextKinds,\n  getCanonicalKey,\n};\n","const { getContextKinds } = require('./context');\n\nfunction getKinds(event) {\n  if (event.context) {\n    return getContextKinds(event.context);\n  }\n  if (event.contextKeys) {\n    return Object.keys(event.contextKeys);\n  }\n  return [];\n}\n\nfunction EventSummarizer() {\n  const es = {};\n\n  let startDate = 0,\n    endDate = 0,\n    counters = {},\n    contextKinds = {};\n\n  es.summarizeEvent = event => {\n    if (event.kind === 'feature') {\n      const counterKey =\n        event.key +\n        ':' +\n        (event.variation !== null && event.variation !== undefined ? event.variation : '') +\n        ':' +\n        (event.version !== null && event.version !== undefined ? event.version : '');\n      const counterVal = counters[counterKey];\n      let kinds = contextKinds[event.key];\n      if (!kinds) {\n        kinds = new Set();\n        contextKinds[event.key] = kinds;\n      }\n      getKinds(event).forEach(kind => kinds.add(kind));\n\n      if (counterVal) {\n        counterVal.count = counterVal.count + 1;\n      } else {\n        counters[counterKey] = {\n          count: 1,\n          key: event.key,\n          version: event.version,\n          variation: event.variation,\n          value: event.value,\n          default: event.default,\n        };\n      }\n      if (startDate === 0 || event.creationDate < startDate) {\n        startDate = event.creationDate;\n      }\n      if (event.creationDate > endDate) {\n        endDate = event.creationDate;\n      }\n    }\n  };\n\n  es.getSummary = () => {\n    const flagsOut = {};\n    let empty = true;\n    for (const c of Object.values(counters)) {\n      let flag = flagsOut[c.key];\n      if (!flag) {\n        flag = {\n          default: c.default,\n          counters: [],\n          contextKinds: [...contextKinds[c.key]],\n        };\n        flagsOut[c.key] = flag;\n      }\n      const counterOut = {\n        value: c.value,\n        count: c.count,\n      };\n      if (c.variation !== undefined && c.variation !== null) {\n        counterOut.variation = c.variation;\n      }\n      if (c.version !== undefined && c.version !== null) {\n        counterOut.version = c.version;\n      } else {\n        counterOut.unknown = true;\n      }\n      flag.counters.push(counterOut);\n      empty = false;\n    }\n    return empty\n      ? null\n      : {\n          startDate,\n          endDate,\n          features: flagsOut,\n        };\n  };\n\n  es.clearSummary = () => {\n    startDate = 0;\n    endDate = 0;\n    counters = {};\n    contextKinds = {};\n  };\n\n  return es;\n}\n\nmodule.exports = EventSummarizer;\n","/**\n * Take a key string and escape the characters to allow it to be used as a reference.\n * @param {string} key\n * @returns {string} The processed key.\n */\nfunction processEscapeCharacters(key) {\n  return key.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n\n/**\n * @param {string} reference The reference to get the components of.\n * @returns {string[]} The components of the reference. Escape characters will be converted to their representative values.\n */\nfunction getComponents(reference) {\n  const referenceWithoutPrefix = reference.startsWith('/') ? reference.substring(1) : reference;\n  return referenceWithoutPrefix\n    .split('/')\n    .map(component => (component.indexOf('~') >= 0 ? component.replace(/~1/g, '/').replace(/~0/g, '~') : component));\n}\n\n/**\n * @param {string} reference The reference to check if it is a literal.\n * @returns true if the reference is a literal.\n */\nfunction isLiteral(reference) {\n  return !reference.startsWith('/');\n}\n\n/**\n * Compare two references and determine if they are equivalent.\n * @param {string} a\n * @param {string} b\n */\nfunction compare(a, b) {\n  const aIsLiteral = isLiteral(a);\n  const bIsLiteral = isLiteral(b);\n  if (aIsLiteral && bIsLiteral) {\n    return a === b;\n  }\n  if (aIsLiteral) {\n    const bComponents = getComponents(b);\n    if (bComponents.length !== 1) {\n      return false;\n    }\n    return a === bComponents[0];\n  }\n  if (bIsLiteral) {\n    const aComponents = getComponents(a);\n    if (aComponents.length !== 1) {\n      return false;\n    }\n    return b === aComponents[0];\n  }\n  return a === b;\n}\n\n/**\n * @param {string} a\n * @param {string} b\n * @returns The two strings joined by '/'.\n */\nfunction join(a, b) {\n  return `${a}/${b}`;\n}\n\n/**\n * There are cases where a field could have been named with a preceeding '/'.\n * If that attribute was private, then the literal would appear to be a reference.\n * This method can be used to convert a literal to a reference in such situations.\n * @param {string} literal The literal to convert to a reference.\n * @returns A literal which has been converted to a reference.\n */\nfunction literalToReference(literal) {\n  return `/${processEscapeCharacters(literal)}`;\n}\n\n/**\n * Clone an object excluding the values referenced by a list of references.\n * @param {Object} target The object to clone.\n * @param {string[]} references A list of references from the cloned object.\n * @returns {{cloned: Object, excluded: string[]}} The cloned object and a list of excluded values.\n */\nfunction cloneExcluding(target, references) {\n  const stack = [];\n  const cloned = {};\n  const excluded = [];\n\n  stack.push(\n    ...Object.keys(target).map(key => ({\n      key,\n      ptr: literalToReference(key),\n      source: target,\n      parent: cloned,\n      visited: [target],\n    }))\n  );\n\n  while (stack.length) {\n    const item = stack.pop();\n    if (!references.some(ptr => compare(ptr, item.ptr))) {\n      const value = item.source[item.key];\n\n      // Handle null because it overlaps with object, which we will want to handle later.\n      if (value === null) {\n        item.parent[item.key] = value;\n      } else if (Array.isArray(value)) {\n        item.parent[item.key] = [...value];\n      } else if (typeof value === 'object') {\n        //Arrays and null must already be handled.\n\n        //Prevent cycles by not visiting the same object\n        //with in the same branch. Parallel branches\n        //may contain the same object.\n        if (item.visited.includes(value)) {\n          continue;\n        }\n\n        item.parent[item.key] = {};\n\n        stack.push(\n          ...Object.keys(value).map(key => ({\n            key,\n            ptr: join(item.ptr, processEscapeCharacters(key)),\n            source: value,\n            parent: item.parent[item.key],\n            visited: [...item.visited, value],\n          }))\n        );\n      } else {\n        item.parent[item.key] = value;\n      }\n    } else {\n      excluded.push(item.ptr);\n    }\n  }\n  return { cloned, excluded: excluded.sort() };\n}\n\nmodule.exports = {\n  cloneExcluding,\n  compare,\n  literalToReference,\n};\n","const AttributeReference = require('./attributeReference');\n\nfunction ContextFilter(config) {\n  const filter = {};\n\n  const allAttributesPrivate = config.allAttributesPrivate;\n  const privateAttributes = config.privateAttributes || [];\n\n  // These attributes cannot be removed via a private attribute.\n  const protectedAttributes = ['key', 'kind', '_meta', 'anonymous'];\n\n  const legacyTopLevelCopyAttributes = ['name', 'ip', 'firstName', 'lastName', 'email', 'avatar', 'country'];\n\n  /**\n   * For the given context and configuration get a list of attributes to filter.\n   * @param {Object} context\n   * @returns {string[]} A list of the attributes to filter.\n   */\n  const getAttributesToFilter = (context, redactAnonymous) =>\n    (allAttributesPrivate || (redactAnonymous && context.anonymous)\n      ? Object.keys(context)\n      : [...privateAttributes, ...((context._meta && context._meta.privateAttributes) || [])]\n    ).filter(attr => !protectedAttributes.some(protectedAttr => AttributeReference.compare(attr, protectedAttr)));\n\n  /**\n   * @param {Object} context\n   * @param {boolean} redactAnonymous\n   * @returns {Object} A copy of the context with private attributes removed,\n   * and the redactedAttributes meta populated.\n   */\n  const filterSingleKind = (context, redactAnonymous) => {\n    if (typeof context !== 'object' || context === null || Array.isArray(context)) {\n      return undefined;\n    }\n\n    const { cloned, excluded } = AttributeReference.cloneExcluding(\n      context,\n      getAttributesToFilter(context, redactAnonymous)\n    );\n    cloned.key = String(cloned.key);\n    if (excluded.length) {\n      if (!cloned._meta) {\n        cloned._meta = {};\n      }\n      cloned._meta.redactedAttributes = excluded;\n    }\n    if (cloned._meta) {\n      delete cloned._meta['privateAttributes'];\n      if (Object.keys(cloned._meta).length === 0) {\n        delete cloned._meta;\n      }\n    }\n    // Make sure anonymous is boolean if present.\n    // Null counts as present, and would be falsy, which is the default.\n    if (cloned.anonymous !== undefined) {\n      cloned.anonymous = !!cloned.anonymous;\n    }\n\n    return cloned;\n  };\n\n  /**\n   * @param {Object} context\n   * @param {boolean} redactAnonymous\n   * @returns {Object} A copy of the context with the private attributes removed,\n   * and the redactedAttributes meta populated for each sub-context.\n   */\n  const filterMultiKind = (context, redactAnonymous) => {\n    const filtered = {\n      kind: context.kind,\n    };\n    const contextKeys = Object.keys(context);\n\n    for (const contextKey of contextKeys) {\n      if (contextKey !== 'kind') {\n        const filteredContext = filterSingleKind(context[contextKey], redactAnonymous);\n        if (filteredContext) {\n          filtered[contextKey] = filteredContext;\n        }\n      }\n    }\n    return filtered;\n  };\n\n  /**\n   * Convert the LDUser object into an LDContext object.\n   * @param {Object} user The LDUser to produce an LDContext for.\n   * @returns {Object} A single kind context based on the provided user.\n   */\n  const legacyToSingleKind = user => {\n    const filtered = {\n      /* Destructure custom items into the top level.\n         Duplicate keys will be overridden by previously\n         top level items.\n      */\n      ...(user.custom || {}),\n\n      // Implicity a user kind.\n      kind: 'user',\n\n      key: user.key,\n    };\n\n    if (user.anonymous !== undefined) {\n      filtered.anonymous = !!user.anonymous;\n    }\n\n    // Copy top level keys and convert them to strings.\n    // Remove keys that may have been destructured from `custom`.\n    for (const key of legacyTopLevelCopyAttributes) {\n      delete filtered[key];\n      if (user[key] !== undefined && user[key] !== null) {\n        filtered[key] = String(user[key]);\n      }\n    }\n\n    if (user.privateAttributeNames !== undefined && user.privateAttributeNames !== null) {\n      filtered._meta = filtered._meta || {};\n      // If any private attributes started with '/' we need to convert them to references, otherwise the '/' will\n      // cause the literal to incorrectly be treated as a reference.\n      filtered._meta.privateAttributes = user.privateAttributeNames.map(literal =>\n        literal.startsWith('/') ? AttributeReference.literalToReference(literal) : literal\n      );\n    }\n\n    return filtered;\n  };\n\n  filter.filter = (context, redactAnonymous = false) => {\n    if (context.kind === undefined || context.kind === null) {\n      return filterSingleKind(legacyToSingleKind(context), redactAnonymous);\n    } else if (context.kind === 'multi') {\n      return filterMultiKind(context, redactAnonymous);\n    } else {\n      return filterSingleKind(context, redactAnonymous);\n    }\n  };\n\n  return filter;\n}\n\nmodule.exports = ContextFilter;\n","const EventSender = require('./EventSender');\nconst EventSummarizer = require('./EventSummarizer');\nconst ContextFilter = require('./ContextFilter');\nconst errors = require('./errors');\nconst messages = require('./messages');\nconst utils = require('./utils');\nconst { getContextKeys } = require('./context');\n\nfunction EventProcessor(\n  platform,\n  options,\n  environmentId,\n  diagnosticsAccumulator = null,\n  emitter = null,\n  sender = null\n) {\n  const processor = {};\n  const eventSender = sender || EventSender(platform, environmentId, options);\n  const mainEventsUrl = utils.appendUrlPath(options.eventsUrl, '/events/bulk/' + environmentId);\n  const summarizer = EventSummarizer();\n  const contextFilter = ContextFilter(options);\n  const samplingInterval = options.samplingInterval;\n  const eventCapacity = options.eventCapacity;\n  const flushInterval = options.flushInterval;\n  const logger = options.logger;\n  let queue = [];\n  let lastKnownPastTime = 0;\n  let disabled = false;\n  let exceededCapacity = false;\n  let flushTimer;\n\n  function shouldSampleEvent() {\n    return samplingInterval === 0 || Math.floor(Math.random() * samplingInterval) === 0;\n  }\n\n  function shouldDebugEvent(e) {\n    if (e.debugEventsUntilDate) {\n      // The \"last known past time\" comes from the last HTTP response we got from the server.\n      // In case the client's time is set wrong, at least we know that any expiration date\n      // earlier than that point is definitely in the past.  If there's any discrepancy, we\n      // want to err on the side of cutting off event debugging sooner.\n      return e.debugEventsUntilDate > lastKnownPastTime && e.debugEventsUntilDate > new Date().getTime();\n    }\n    return false;\n  }\n\n  // Transform an event from its internal format to the format we use when sending a payload.\n  function makeOutputEvent(e) {\n    const ret = utils.extend({}, e);\n    if (e.kind === 'identify') {\n      // identify events always have an inline context\n      ret.context = contextFilter.filter(e.context);\n    } else if (e.kind === 'feature') {\n      // feature events always have an inline context\n      ret.context = contextFilter.filter(e.context, true);\n    } else {\n      ret.contextKeys = getContextKeysFromEvent(e);\n      delete ret['context'];\n    }\n    if (e.kind === 'feature') {\n      delete ret['trackEvents'];\n      delete ret['debugEventsUntilDate'];\n    }\n    return ret;\n  }\n\n  function getContextKeysFromEvent(event) {\n    return getContextKeys(event.context, logger);\n  }\n\n  function addToOutbox(event) {\n    if (queue.length < eventCapacity) {\n      queue.push(event);\n      exceededCapacity = false;\n    } else {\n      if (!exceededCapacity) {\n        exceededCapacity = true;\n        logger.warn(messages.eventCapacityExceeded());\n      }\n      if (diagnosticsAccumulator) {\n        // For diagnostic events, we track how many times we had to drop an event due to exceeding the capacity.\n        diagnosticsAccumulator.incrementDroppedEvents();\n      }\n    }\n  }\n\n  processor.enqueue = function(event) {\n    if (disabled) {\n      return;\n    }\n    let addFullEvent = false;\n    let addDebugEvent = false;\n\n    // Add event to the summary counters if appropriate\n    summarizer.summarizeEvent(event);\n\n    // Decide whether to add the event to the payload. Feature events may be added twice, once for\n    // the event (if tracked) and once for debugging.\n    if (event.kind === 'feature') {\n      if (shouldSampleEvent()) {\n        addFullEvent = !!event.trackEvents;\n        addDebugEvent = shouldDebugEvent(event);\n      }\n    } else {\n      addFullEvent = shouldSampleEvent();\n    }\n\n    if (addFullEvent) {\n      addToOutbox(makeOutputEvent(event));\n    }\n    if (addDebugEvent) {\n      const debugEvent = utils.extend({}, event, { kind: 'debug' });\n      debugEvent.context = contextFilter.filter(debugEvent.context);\n      delete debugEvent['trackEvents'];\n      delete debugEvent['debugEventsUntilDate'];\n      addToOutbox(debugEvent);\n    }\n  };\n\n  processor.flush = function() {\n    if (disabled) {\n      return Promise.resolve();\n    }\n    const eventsToSend = queue;\n    const summary = summarizer.getSummary();\n    summarizer.clearSummary();\n    if (summary) {\n      summary.kind = 'summary';\n      eventsToSend.push(summary);\n    }\n    if (diagnosticsAccumulator) {\n      // For diagnostic events, we record how many events were in the queue at the last flush (since \"how\n      // many events happened to be in the queue at the moment we decided to send a diagnostic event\" would\n      // not be a very useful statistic).\n      diagnosticsAccumulator.setEventsInLastBatch(eventsToSend.length);\n    }\n    if (eventsToSend.length === 0) {\n      return Promise.resolve();\n    }\n    queue = [];\n    logger.debug(messages.debugPostingEvents(eventsToSend.length));\n    return eventSender.sendEvents(eventsToSend, mainEventsUrl).then(responseInfo => {\n      if (responseInfo) {\n        if (responseInfo.serverTime) {\n          lastKnownPastTime = responseInfo.serverTime;\n        }\n        if (!errors.isHttpErrorRecoverable(responseInfo.status)) {\n          disabled = true;\n        }\n        if (responseInfo.status >= 400) {\n          utils.onNextTick(() => {\n            emitter.maybeReportError(\n              new errors.LDUnexpectedResponseError(\n                messages.httpErrorMessage(responseInfo.status, 'event posting', 'some events were dropped')\n              )\n            );\n          });\n        }\n      }\n    });\n  };\n\n  processor.start = function() {\n    const flushTick = () => {\n      processor.flush();\n      flushTimer = setTimeout(flushTick, flushInterval);\n    };\n    flushTimer = setTimeout(flushTick, flushInterval);\n  };\n\n  processor.stop = function() {\n    clearTimeout(flushTimer);\n  };\n\n  return processor;\n}\n\nmodule.exports = EventProcessor;\n","function EventEmitter(logger) {\n  const emitter = {};\n  const events = {};\n\n  const listeningTo = event => !!events[event];\n\n  emitter.on = function(event, handler, context) {\n    events[event] = events[event] || [];\n    events[event] = events[event].concat({\n      handler: handler,\n      context: context,\n    });\n  };\n\n  emitter.off = function(event, handler, context) {\n    if (!events[event]) {\n      return;\n    }\n    for (let i = 0; i < events[event].length; i++) {\n      if (events[event][i].handler === handler && events[event][i].context === context) {\n        events[event] = events[event].slice(0, i).concat(events[event].slice(i + 1));\n      }\n    }\n  };\n\n  emitter.emit = function(event) {\n    if (!events[event]) {\n      return;\n    }\n    // Copy the list of handlers before iterating, in case any handler adds or removes another handler.\n    // Any such changes should not affect what we do here-- we want to notify every handler that existed\n    // at the moment that the event was fired.\n    const copiedHandlers = events[event].slice(0);\n    for (let i = 0; i < copiedHandlers.length; i++) {\n      copiedHandlers[i].handler.apply(copiedHandlers[i].context, Array.prototype.slice.call(arguments, 1));\n    }\n  };\n\n  emitter.getEvents = function() {\n    return Object.keys(events);\n  };\n\n  emitter.getEventListenerCount = function(event) {\n    return events[event] ? events[event].length : 0;\n  };\n\n  emitter.maybeReportError = function(error) {\n    if (!error) {\n      return;\n    }\n    if (listeningTo('error')) {\n      this.emit('error', error);\n    } else {\n      (logger || console).error(error.message);\n    }\n  };\n  return emitter;\n}\n\nmodule.exports = EventEmitter;\n","// This file provides an abstraction of the client's startup state.\n//\n// Startup can either succeed or fail exactly once; calling signalSuccess() or signalFailure()\n// after that point has no effect.\n//\n// On success, we fire both an \"initialized\" event and a \"ready\" event. Both the waitForInitialization()\n// promise and the waitUntilReady() promise are resolved in this case.\n//\n// On failure, we fire both a \"failed\" event (with the error as a parameter) and a \"ready\" event.\n// The waitForInitialization() promise is rejected, but the waitUntilReady() promise is resolved.\n//\n// To complicate things, we must *not* create the waitForInitialization() promise unless it is\n// requested, because otherwise failures would cause an *unhandled* rejection which can be a\n// serious problem in some environments. So we use a somewhat roundabout system for tracking the\n// initialization state and lazily creating this promise.\n\nconst readyEvent = 'ready',\n  successEvent = 'initialized',\n  failureEvent = 'failed';\n\nfunction InitializationStateTracker(eventEmitter) {\n  let succeeded = false,\n    failed = false,\n    failureValue = null,\n    initializationPromise = null;\n\n  const readyPromise = new Promise(resolve => {\n    const onReady = () => {\n      eventEmitter.off(readyEvent, onReady); // we can't use \"once\" because it's not available on some JS platforms\n      resolve();\n    };\n    eventEmitter.on(readyEvent, onReady);\n  }).catch(() => {}); // this Promise should never be rejected, but the catch handler is a safety measure\n\n  return {\n    getInitializationPromise: () => {\n      if (initializationPromise) {\n        return initializationPromise;\n      }\n      if (succeeded) {\n        return Promise.resolve();\n      }\n      if (failed) {\n        return Promise.reject(failureValue);\n      }\n      initializationPromise = new Promise((resolve, reject) => {\n        const onSuccess = () => {\n          eventEmitter.off(successEvent, onSuccess);\n          resolve();\n        };\n        const onFailure = err => {\n          eventEmitter.off(failureEvent, onFailure);\n          reject(err);\n        };\n        eventEmitter.on(successEvent, onSuccess);\n        eventEmitter.on(failureEvent, onFailure);\n      });\n      return initializationPromise;\n    },\n\n    getReadyPromise: () => readyPromise,\n\n    signalSuccess: () => {\n      if (!succeeded && !failed) {\n        succeeded = true;\n        eventEmitter.emit(successEvent);\n        eventEmitter.emit(readyEvent);\n      }\n    },\n\n    signalFailure: err => {\n      if (!succeeded && !failed) {\n        failed = true;\n        failureValue = err;\n        eventEmitter.emit(failureEvent, err);\n        eventEmitter.emit(readyEvent);\n      }\n      eventEmitter.maybeReportError(err); // the \"error\" event can be emitted more than once, unlike the others\n    },\n  };\n}\n\nmodule.exports = InitializationStateTracker;\n","const utils = require('./utils');\n\nfunction PersistentFlagStore(storage, environment, hash, ident) {\n  const store = {};\n\n  function getFlagsKey() {\n    let key = '';\n    const context = ident.getContext();\n    if (context) {\n      key = hash || utils.btoa(JSON.stringify(context));\n    }\n    return 'ld:' + environment + ':' + key;\n  }\n\n  // Returns a Promise which will be resolved with a parsed JSON value if a stored value was available,\n  // or resolved with null if there was no value or if storage was not available.\n  store.loadFlags = () =>\n    storage.get(getFlagsKey()).then(dataStr => {\n      if (dataStr === null || dataStr === undefined) {\n        return null;\n      }\n      try {\n        let data = JSON.parse(dataStr);\n        if (data) {\n          const schema = data.$schema;\n          if (schema === undefined || schema < 1) {\n            data = utils.transformValuesToVersionedValues(data);\n          } else {\n            delete data['$schema'];\n          }\n        }\n        return data;\n      } catch (ex) {\n        return store.clearFlags().then(() => null);\n      }\n    });\n\n  // Resolves with true if successful, or false if storage is unavailable. Never rejects.\n  store.saveFlags = flags => {\n    const data = utils.extend({}, flags, { $schema: 1 });\n    return storage.set(getFlagsKey(), JSON.stringify(data));\n  };\n\n  // Resolves with true if successful, or false if storage is unavailable. Never rejects.\n  store.clearFlags = () => storage.clear(getFlagsKey());\n\n  return store;\n}\n\nmodule.exports = PersistentFlagStore;\n","const messages = require('./messages');\n\n// The localStorageProvider is provided by the platform object. It should have the following\n// methods, each of which should return a Promise:\n// - get(key): Gets the string value, if any, for the given key\n// - set(key, value): Stores a string value for the given key\n// - remove(key): Removes the given key\n//\n// Storage is just a light wrapper of the localStorageProvider, adding error handling and\n// ensuring that we don't call it if it's unavailable. The get method will simply resolve\n// with an undefined value if there is an error or if there is no localStorageProvider.\n// None of the promises returned by Storage will ever be rejected.\n//\n// It is always possible that the underlying platform storage mechanism might fail or be\n// disabled. If so, it's likely that it will keep failing, so we will only log one warning\n// instead of repetitive warnings.\nfunction PersistentStorage(localStorageProvider, logger) {\n  const storage = {};\n  let loggedError = false;\n\n  const logError = err => {\n    if (!loggedError) {\n      loggedError = true;\n      logger.warn(messages.localStorageUnavailable(err));\n    }\n  };\n\n  storage.isEnabled = () => !!localStorageProvider;\n\n  // Resolves with a value, or undefined if storage is unavailable. Never rejects.\n  storage.get = key =>\n    new Promise(resolve => {\n      if (!localStorageProvider) {\n        resolve(undefined);\n        return;\n      }\n      localStorageProvider\n        .get(key)\n        .then(resolve)\n        .catch(err => {\n          logError(err);\n          resolve(undefined);\n        });\n    });\n\n  // Resolves with true if successful, or false if storage is unavailable. Never rejects.\n  storage.set = (key, value) =>\n    new Promise(resolve => {\n      if (!localStorageProvider) {\n        resolve(false);\n        return;\n      }\n      localStorageProvider\n        .set(key, value)\n        .then(() => resolve(true))\n        .catch(err => {\n          logError(err);\n          resolve(false);\n        });\n    });\n\n  // Resolves with true if successful, or false if storage is unavailable. Never rejects.\n  storage.clear = key =>\n    new Promise(resolve => {\n      if (!localStorageProvider) {\n        resolve(false);\n        return;\n      }\n      localStorageProvider\n        .clear(key)\n        .then(() => resolve(true))\n        .catch(err => {\n          logError(err);\n          resolve(false);\n        });\n    });\n\n  return storage;\n}\n\nmodule.exports = PersistentStorage;\n","const messages = require('./messages');\nconst { appendUrlPath, base64URLEncode, objectHasOwnProperty } = require('./utils');\nconst { getLDHeaders, transformHeaders } = require('./headers');\nconst { isHttpErrorRecoverable } = require('./errors');\n\n// The underlying event source implementation is abstracted via the platform object, which should\n// have these three properties:\n// eventSourceFactory(): a function that takes a URL and optional config object and returns an object\n//   with the same methods as the regular HTML5 EventSource object. The properties in the config\n//   object are those supported by the launchdarkly-eventsource package; browser EventSource\n//   implementations don't have any config options.\n// eventSourceIsActive(): a function that takes an EventSource-compatible object and returns true if\n//   it is in an active state (connected or connecting).\n// eventSourceAllowsReport: true if REPORT is supported.\n\n// The read timeout for the stream is a fixed value that is set to be slightly longer than the expected\n// interval between heartbeats from the LaunchDarkly streaming server. If this amount of time elapses\n// with no new data, the connection will be cycled.\nconst streamReadTimeoutMillis = 5 * 60 * 1000; // 5 minutes\nconst maxRetryDelay = 30 * 1000; // Maximum retry delay 30 seconds.\nconst jitterRatio = 0.5; // Delay should be 50%-100% of calculated time.\n\nfunction Stream(platform, config, environment, diagnosticsAccumulator) {\n  const baseUrl = config.streamUrl;\n  const logger = config.logger;\n  const stream = {};\n  const evalUrlPrefix = appendUrlPath(baseUrl, '/eval/' + environment);\n  const useReport = config.useReport;\n  const withReasons = config.evaluationReasons;\n  const baseReconnectDelay = config.streamReconnectDelay;\n  const headers = getLDHeaders(platform, config);\n  let firstConnectionErrorLogged = false;\n  let es = null;\n  let reconnectTimeoutReference = null;\n  let connectionAttemptStartTime;\n  let context = null;\n  let hash = null;\n  let handlers = null;\n  let retryCount = 0;\n\n  function backoff() {\n    const delay = baseReconnectDelay * Math.pow(2, retryCount);\n    return delay > maxRetryDelay ? maxRetryDelay : delay;\n  }\n\n  function jitter(computedDelayMillis) {\n    return computedDelayMillis - Math.trunc(Math.random() * jitterRatio * computedDelayMillis);\n  }\n\n  function getNextRetryDelay() {\n    const delay = jitter(backoff());\n    retryCount += 1;\n    return delay;\n  }\n\n  stream.connect = function(newContext, newHash, newHandlers) {\n    context = newContext;\n    hash = newHash;\n    handlers = {};\n    for (const key in newHandlers || {}) {\n      handlers[key] = function(e) {\n        // Reset the state for logging the first connection error so that the first\n        // connection error following a successful connection will once again be logged.\n        // We will decorate *all* handlers to do this to keep this abstraction agnostic\n        // for different stream implementations.\n        firstConnectionErrorLogged = false;\n        logConnectionResult(true);\n        newHandlers[key] && newHandlers[key](e);\n      };\n    }\n    tryConnect();\n  };\n\n  stream.disconnect = function() {\n    clearTimeout(reconnectTimeoutReference);\n    reconnectTimeoutReference = null;\n    closeConnection();\n  };\n\n  stream.isConnected = function() {\n    return !!(es && platform.eventSourceIsActive && platform.eventSourceIsActive(es));\n  };\n\n  function handleError(err) {\n    // The event source may not produce a status. But the LaunchDarkly\n    // polyfill can. If we can get the status, then we should stop retrying\n    // on certain error codes.\n    if (err.status && typeof err.status === 'number' && !isHttpErrorRecoverable(err.status)) {\n      // If we encounter an unrecoverable condition, then we do not want to\n      // retry anymore.\n      closeConnection();\n      logger.error(messages.unrecoverableStreamError(err));\n      // Ensure any pending retry attempts are not done.\n      if (reconnectTimeoutReference) {\n        clearTimeout(reconnectTimeoutReference);\n        reconnectTimeoutReference = null;\n      }\n      return;\n    }\n\n    const delay = getNextRetryDelay();\n\n    if (!firstConnectionErrorLogged) {\n      logger.warn(messages.streamError(err, delay));\n      firstConnectionErrorLogged = true;\n    }\n    logConnectionResult(false);\n    closeConnection();\n    tryConnect(delay);\n  }\n\n  function tryConnect(delay) {\n    if (!reconnectTimeoutReference) {\n      if (delay) {\n        reconnectTimeoutReference = setTimeout(openConnection, delay);\n      } else {\n        openConnection();\n      }\n    }\n  }\n\n  function openConnection() {\n    reconnectTimeoutReference = null;\n    let url;\n    let query = '';\n    const options = { headers, readTimeoutMillis: streamReadTimeoutMillis };\n    if (platform.eventSourceFactory) {\n      if (hash !== null && hash !== undefined) {\n        query = 'h=' + hash;\n      }\n      if (useReport) {\n        if (platform.eventSourceAllowsReport) {\n          url = evalUrlPrefix;\n          options.method = 'REPORT';\n          options.headers['Content-Type'] = 'application/json';\n          options.body = JSON.stringify(context);\n        } else {\n          // if we can't do REPORT, fall back to the old ping-based stream\n          url = appendUrlPath(baseUrl, '/ping/' + environment);\n          query = '';\n        }\n      } else {\n        url = evalUrlPrefix + '/' + base64URLEncode(JSON.stringify(context));\n      }\n      options.headers = transformHeaders(options.headers, config);\n      if (withReasons) {\n        query = query + (query ? '&' : '') + 'withReasons=true';\n      }\n      url = url + (query ? '?' : '') + query;\n\n      closeConnection();\n      logger.info(messages.streamConnecting(url));\n      logConnectionStarted();\n\n      es = platform.eventSourceFactory(url, options);\n      for (const key in handlers) {\n        if (objectHasOwnProperty(handlers, key)) {\n          es.addEventListener(key, handlers[key]);\n        }\n      }\n\n      es.onerror = handleError;\n\n      es.onopen = () => {\n        // If the connection is a success, then reset the retryCount.\n        retryCount = 0;\n      };\n    }\n  }\n\n  function closeConnection() {\n    if (es) {\n      logger.info(messages.streamClosing());\n      es.close();\n      es = null;\n    }\n  }\n\n  function logConnectionStarted() {\n    connectionAttemptStartTime = new Date().getTime();\n  }\n\n  function logConnectionResult(success) {\n    if (connectionAttemptStartTime && diagnosticsAccumulator) {\n      diagnosticsAccumulator.recordStreamInit(\n        connectionAttemptStartTime,\n        !success,\n        new Date().getTime() - connectionAttemptStartTime\n      );\n    }\n    connectionAttemptStartTime = null;\n  }\n\n  return stream;\n}\n\nmodule.exports = Stream;\n","// This function allows a series of Promises to be coalesced such that only the most recently\n// added one actually matters. For instance, if several HTTP requests are made to the same\n// endpoint and we want to ensure that whoever made each one always gets the latest data, each\n// can be passed to addPromise (on the same coalescer) and each caller can wait on the\n// coalescer.resultPromise; all three will then receive the result (or error) from the *last*\n// request, and the results of the first two will be discarded.\n//\n// The cancelFn callback, if present, will be called whenever an existing promise is being\n// discarded. This can be used for instance to abort an HTTP request that's now obsolete.\n//\n// The finallyFn callback, if present, is called on completion of the whole thing. This is\n// different from calling coalescer.resultPromise.finally() because it is executed before any\n// other handlers. Its purpose is to tell the caller that this coalescer should no longer be used.\n\nfunction promiseCoalescer(finallyFn) {\n  let currentPromise;\n  let currentCancelFn;\n  let finalResolve;\n  let finalReject;\n\n  const coalescer = {};\n\n  coalescer.addPromise = (p, cancelFn) => {\n    currentPromise = p;\n    currentCancelFn && currentCancelFn();\n    currentCancelFn = cancelFn;\n\n    p.then(\n      result => {\n        if (currentPromise === p) {\n          finalResolve(result);\n          finallyFn && finallyFn();\n        }\n      },\n      error => {\n        if (currentPromise === p) {\n          finalReject(error);\n          finallyFn && finallyFn();\n        }\n      }\n    );\n  };\n\n  coalescer.resultPromise = new Promise((resolve, reject) => {\n    finalResolve = resolve;\n    finalReject = reject;\n  });\n\n  return coalescer;\n}\n\nmodule.exports = promiseCoalescer;\n","const utils = require('./utils');\nconst errors = require('./errors');\nconst messages = require('./messages');\nconst promiseCoalescer = require('./promiseCoalescer');\nconst { transformHeaders, getLDHeaders } = require('./headers');\n\nconst jsonContentType = 'application/json';\n\nfunction getResponseError(result) {\n  if (result.status === 404) {\n    return new errors.LDInvalidEnvironmentIdError(messages.environmentNotFound());\n  } else {\n    return new errors.LDFlagFetchError(messages.errorFetchingFlags(result.statusText || String(result.status)));\n  }\n}\n\nfunction Requestor(platform, options, environment) {\n  const baseUrl = options.baseUrl;\n  const useReport = options.useReport;\n  const withReasons = options.evaluationReasons;\n  const logger = options.logger;\n\n  const requestor = {};\n\n  const activeRequests = {}; // map of URLs to promiseCoalescers\n\n  function fetchJSON(endpoint, body) {\n    if (!platform.httpRequest) {\n      return new Promise((resolve, reject) => {\n        reject(new errors.LDFlagFetchError(messages.httpUnavailable()));\n      });\n    }\n\n    const method = body ? 'REPORT' : 'GET';\n    const headers = getLDHeaders(platform, options);\n    if (body) {\n      headers['Content-Type'] = jsonContentType;\n    }\n\n    let coalescer = activeRequests[endpoint];\n    if (!coalescer) {\n      coalescer = promiseCoalescer(() => {\n        // this will be called once there are no more active requests for the same endpoint\n        delete activeRequests[endpoint];\n      });\n      activeRequests[endpoint] = coalescer;\n    }\n\n    const req = platform.httpRequest(method, endpoint, transformHeaders(headers, options), body);\n    const p = req.promise.then(\n      result => {\n        if (result.status === 200) {\n          // We're using substring here because using startsWith would require a polyfill in IE.\n          if (\n            result.header('content-type') &&\n            result.header('content-type').substring(0, jsonContentType.length) === jsonContentType\n          ) {\n            return JSON.parse(result.body);\n          } else {\n            const message = messages.invalidContentType(result.header('content-type') || '');\n            return Promise.reject(new errors.LDFlagFetchError(message));\n          }\n        } else {\n          return Promise.reject(getResponseError(result));\n        }\n      },\n      e => Promise.reject(new errors.LDFlagFetchError(messages.networkError(e)))\n    );\n    coalescer.addPromise(p, () => {\n      // this will be called if another request for the same endpoint supersedes this one\n      req.cancel && req.cancel();\n    });\n    return coalescer.resultPromise;\n  }\n\n  // Performs a GET request to an arbitrary path under baseUrl. Returns a Promise which will resolve\n  // with the parsed JSON response, or will be rejected if the request failed.\n  requestor.fetchJSON = function(path) {\n    return fetchJSON(utils.appendUrlPath(baseUrl, path), null);\n  };\n\n  // Requests the current state of all flags for the given context from LaunchDarkly. Returns a Promise\n  // which will resolve with the parsed JSON response, or will be rejected if the request failed.\n  requestor.fetchFlagSettings = function(context, hash) {\n    let data;\n    let endpoint;\n    let query = '';\n    let body;\n\n    if (useReport) {\n      endpoint = [baseUrl, '/sdk/evalx/', environment, '/context'].join('');\n      body = JSON.stringify(context);\n    } else {\n      data = utils.base64URLEncode(JSON.stringify(context));\n      endpoint = [baseUrl, '/sdk/evalx/', environment, '/contexts/', data].join('');\n    }\n    if (hash) {\n      query = 'h=' + hash;\n    }\n    if (withReasons) {\n      query = query + (query ? '&' : '') + 'withReasons=true';\n    }\n    endpoint = endpoint + (query ? '?' : '') + query;\n    logger.debug(messages.debugPolling(endpoint));\n\n    return fetchJSON(endpoint, body);\n  };\n\n  return requestor;\n}\n\nmodule.exports = Requestor;\n","const utils = require('./utils');\n\nfunction Identity(initialContext, onChange) {\n  const ident = {};\n  let context;\n\n  ident.setContext = function(c) {\n    context = utils.sanitizeContext(c);\n    if (context && onChange) {\n      onChange(utils.clone(context));\n    }\n  };\n\n  ident.getContext = function() {\n    return context ? utils.clone(context) : null;\n  };\n\n  if (initialContext) {\n    ident.setContext(initialContext);\n  }\n\n  return ident;\n}\n\nmodule.exports = Identity;\n","const { v1: uuidv1 } = require('uuid');\nconst { getContextKinds } = require('./context');\n\nconst errors = require('./errors');\nconst messages = require('./messages');\nconst utils = require('./utils');\n\nconst ldUserIdKey = 'ld:$anonUserId';\n\n/**\n * Create an object which can process a context and populate any required keys\n * for anonymous objects.\n *\n * @param {Object} persistentStorage The persistent storage from which to store\n * and access persisted anonymous context keys.\n * @returns An AnonymousContextProcessor.\n */\nfunction AnonymousContextProcessor(persistentStorage) {\n  function getContextKeyIdString(kind) {\n    if (kind === undefined || kind === null || kind === 'user') {\n      return ldUserIdKey;\n    }\n    return `ld:$contextKey:${kind}`;\n  }\n\n  function getCachedContextKey(kind) {\n    return persistentStorage.get(getContextKeyIdString(kind));\n  }\n\n  function setCachedContextKey(id, kind) {\n    return persistentStorage.set(getContextKeyIdString(kind), id);\n  }\n\n  /**\n   * Process a single kind context, or a single context within a multi-kind context.\n   * @param {string} kind The kind of the context. Independent because the kind is not prevent\n   * within a context in a multi-kind context.\n   * @param {Object} context\n   * @returns {Promise} a promise that resolves to a processed contexts, or rejects\n   * a context which cannot be processed.\n   */\n  function processSingleKindContext(kind, context) {\n    // We are working on a copy of an original context, so we want to re-assign\n    // versus duplicating it again.\n\n    /* eslint-disable no-param-reassign */\n    if (context.key !== null && context.key !== undefined) {\n      context.key = context.key.toString();\n      return Promise.resolve(context);\n    }\n\n    if (context.anonymous) {\n      // If the key doesn't exist, then the persistent storage will resolve\n      // with undefined.\n      return getCachedContextKey(kind).then(cachedId => {\n        if (cachedId) {\n          context.key = cachedId;\n          return context;\n        } else {\n          const id = uuidv1();\n          context.key = id;\n          return setCachedContextKey(id, kind).then(() => context);\n        }\n      });\n    } else {\n      return Promise.reject(new errors.LDInvalidUserError(messages.invalidContext()));\n    }\n    /* eslint-enable no-param-reassign */\n  }\n\n  /**\n   * Process the context, returning a Promise that resolves to the processed context, or rejects if there is an error.\n   * @param {Object} context\n   * @returns {Promise} A promise which resolves to a processed context, or a rejection if the context cannot be\n   * processed. The context should still be checked for overall validity after being processed.\n   */\n  this.processContext = context => {\n    if (!context) {\n      return Promise.reject(new errors.LDInvalidUserError(messages.contextNotSpecified()));\n    }\n\n    const processedContext = utils.clone(context);\n\n    if (context.kind === 'multi') {\n      const kinds = getContextKinds(processedContext);\n\n      return Promise.all(kinds.map(kind => processSingleKindContext(kind, processedContext[kind]))).then(\n        () => processedContext\n      );\n    }\n    return processSingleKindContext(context.kind, processedContext);\n  };\n}\n\nmodule.exports = AnonymousContextProcessor;\n","const { v1: uuidv1 } = require('uuid');\n// Note that in the diagnostic events spec, these IDs are to be generated with UUID v4. However,\n// in JS we were already using v1 for unique context keys, so to avoid bringing in two packages we\n// will use v1 here as well.\n\nconst { baseOptionDefs } = require('./configuration');\nconst messages = require('./messages');\nconst { appendUrlPath } = require('./utils');\n\nfunction DiagnosticId(sdkKey) {\n  const ret = {\n    diagnosticId: uuidv1(),\n  };\n  if (sdkKey) {\n    ret.sdkKeySuffix = sdkKey.length > 6 ? sdkKey.substring(sdkKey.length - 6) : sdkKey;\n  }\n  return ret;\n}\n\n// A stateful object holding statistics that will go into diagnostic events.\n\nfunction DiagnosticsAccumulator(startTime) {\n  let dataSinceDate, droppedEvents, eventsInLastBatch, streamInits;\n\n  function reset(time) {\n    dataSinceDate = time;\n    droppedEvents = 0;\n    eventsInLastBatch = 0;\n    streamInits = [];\n  }\n\n  reset(startTime);\n\n  return {\n    getProps: () => ({\n      dataSinceDate,\n      droppedEvents,\n      eventsInLastBatch,\n      streamInits,\n      // omit deduplicatedUsers for the JS SDKs because they don't deduplicate users\n    }),\n    setProps: props => {\n      dataSinceDate = props.dataSinceDate;\n      droppedEvents = props.droppedEvents || 0;\n      eventsInLastBatch = props.eventsInLastBatch || 0;\n      streamInits = props.streamInits || [];\n    },\n    incrementDroppedEvents: () => {\n      droppedEvents++;\n    },\n    setEventsInLastBatch: n => {\n      eventsInLastBatch = n;\n    },\n    recordStreamInit: (timestamp, failed, durationMillis) => {\n      const info = { timestamp, failed, durationMillis };\n      streamInits.push(info);\n    },\n    reset,\n  };\n}\n\n// An object that maintains information that will go into diagnostic events, and knows how to format\n// those events. It is instantiated by the SDK client, and shared with the event processor.\n//\n// The JS-based SDKs have two modes for diagnostic events. By default, the behavior is basically the\n// same as the server-side SDKs: a \"diagnostic-init\" event is sent on startup, and then \"diagnostic\"\n// events with operating statistics are sent periodically. However, in a browser environment this is\n// undesirable because the page may be reloaded frequently. In that case, setting the property\n// \"platform.diagnosticUseCombinedEvent\" to true enables an alternate mode in which a combination of\n// both kinds of event is sent at intervals, relative to the last time this was done (if any) which\n// is cached in local storage.\n\nfunction DiagnosticsManager(\n  platform,\n  persistentStorage,\n  accumulator,\n  eventSender,\n  environmentId,\n  config,\n  diagnosticId\n) {\n  const combinedMode = !!platform.diagnosticUseCombinedEvent;\n  const localStorageKey = 'ld:' + environmentId + ':$diagnostics';\n  const diagnosticEventsUrl = appendUrlPath(config.eventsUrl, '/events/diagnostic/' + environmentId);\n  const periodicInterval = config.diagnosticRecordingInterval;\n  const acc = accumulator;\n  const initialEventSamplingInterval = 4; // used only in combined mode - see start()\n  let streamingEnabled = !!config.streaming;\n  let eventSentTime;\n  let periodicTimer;\n  const manager = {};\n\n  function makeInitProperties() {\n    return {\n      sdk: makeSdkData(),\n      configuration: makeConfigData(),\n      platform: platform.diagnosticPlatformData,\n    };\n  }\n\n  // Send a diagnostic event and do not wait for completion.\n  function sendDiagnosticEvent(event) {\n    config.logger && config.logger.debug(messages.debugPostingDiagnosticEvent(event));\n    eventSender\n      .sendEvents(event, diagnosticEventsUrl, true)\n      .then(() => undefined)\n      .catch(() => undefined);\n  }\n\n  function loadProperties(callback) {\n    if (!persistentStorage.isEnabled()) {\n      return callback(false); // false indicates that local storage is not available\n    }\n    persistentStorage\n      .get(localStorageKey)\n      .then(data => {\n        if (data) {\n          try {\n            const props = JSON.parse(data);\n            acc.setProps(props);\n            eventSentTime = props.dataSinceDate;\n          } catch (e) {\n            // disregard malformed cached data\n          }\n        }\n        callback(true);\n      })\n      .catch(() => {\n        callback(false);\n      });\n  }\n\n  function saveProperties() {\n    if (persistentStorage.isEnabled()) {\n      const props = { ...acc.getProps() };\n      persistentStorage.set(localStorageKey, JSON.stringify(props));\n    }\n  }\n\n  // Creates the initial event that is sent by the event processor when the SDK starts up. This will not\n  // be repeated during the lifetime of the SDK client. In combined mode, we don't send this.\n  function createInitEvent() {\n    return {\n      kind: 'diagnostic-init',\n      id: diagnosticId,\n      creationDate: acc.getProps().dataSinceDate,\n      ...makeInitProperties(),\n    };\n  }\n\n  // Creates a periodic event containing time-dependent stats, and resets the state of the manager with\n  // regard to those stats. In combined mode (browser SDK) this also contains the configuration data.\n  function createPeriodicEventAndReset() {\n    const currentTime = new Date().getTime();\n    let ret = {\n      kind: combinedMode ? 'diagnostic-combined' : 'diagnostic',\n      id: diagnosticId,\n      creationDate: currentTime,\n      ...acc.getProps(),\n    };\n    if (combinedMode) {\n      ret = { ...ret, ...makeInitProperties() };\n    }\n    acc.reset(currentTime);\n    return ret;\n  }\n\n  function sendPeriodicEvent() {\n    sendDiagnosticEvent(createPeriodicEventAndReset());\n    periodicTimer = setTimeout(sendPeriodicEvent, periodicInterval);\n    eventSentTime = new Date().getTime();\n    if (combinedMode) {\n      saveProperties();\n    }\n  }\n\n  function makeSdkData() {\n    const sdkData = { ...platform.diagnosticSdkData };\n    if (config.wrapperName) {\n      sdkData.wrapperName = config.wrapperName;\n    }\n    if (config.wrapperVersion) {\n      sdkData.wrapperVersion = config.wrapperVersion;\n    }\n    return sdkData;\n  }\n\n  function makeConfigData() {\n    const configData = {\n      customBaseURI: config.baseUrl !== baseOptionDefs.baseUrl.default,\n      customStreamURI: config.streamUrl !== baseOptionDefs.streamUrl.default,\n      customEventsURI: config.eventsUrl !== baseOptionDefs.eventsUrl.default,\n      eventsCapacity: config.eventCapacity,\n      eventsFlushIntervalMillis: config.flushInterval,\n      reconnectTimeMillis: config.streamReconnectDelay,\n      streamingDisabled: !streamingEnabled,\n      allAttributesPrivate: !!config.allAttributesPrivate,\n      diagnosticRecordingIntervalMillis: config.diagnosticRecordingInterval,\n      // The following extra properties are only provided by client-side JS SDKs:\n      usingSecureMode: !!config.hash,\n      bootstrapMode: !!config.bootstrap,\n      fetchGoalsDisabled: !config.fetchGoals,\n      sendEventsOnlyForVariation: !!config.sendEventsOnlyForVariation,\n    };\n    // Client-side JS SDKs do not have the following properties which other SDKs have:\n    // connectTimeoutMillis\n    // pollingIntervalMillis\n    // samplingInterval\n    // socketTimeoutMillis\n    // startWaitMillis\n    // userKeysCapacity\n    // userKeysFlushIntervalMillis\n    // usingProxy\n    // usingProxyAuthenticator\n    // usingRelayDaemon\n\n    return configData;\n  }\n\n  // Called when the SDK is starting up. Either send an init event immediately, or, in the alternate\n  // mode, check for cached local storage properties and send an event only if we haven't done so\n  // recently.\n  manager.start = () => {\n    if (combinedMode) {\n      loadProperties(localStorageAvailable => {\n        if (localStorageAvailable) {\n          const nextEventTime = (eventSentTime || 0) + periodicInterval;\n          const timeNow = new Date().getTime();\n          if (timeNow >= nextEventTime) {\n            sendPeriodicEvent();\n          } else {\n            periodicTimer = setTimeout(sendPeriodicEvent, nextEventTime - timeNow);\n          }\n        } else {\n          // We don't have the ability to cache anything in local storage, so we don't know if we\n          // recently sent an event before this page load, but we would still prefer not to send one\n          // on *every* page load. So, as a rough heuristic, we'll decide semi-randomly.\n          if (Math.floor(Math.random() * initialEventSamplingInterval) === 0) {\n            sendPeriodicEvent();\n          } else {\n            periodicTimer = setTimeout(sendPeriodicEvent, periodicInterval);\n          }\n        }\n      });\n    } else {\n      sendDiagnosticEvent(createInitEvent());\n      periodicTimer = setTimeout(sendPeriodicEvent, periodicInterval);\n    }\n  };\n\n  manager.stop = () => {\n    periodicTimer && clearTimeout(periodicTimer);\n  };\n\n  // Called when streaming mode is turned on or off dynamically.\n  manager.setStreaming = enabled => {\n    streamingEnabled = enabled;\n  };\n\n  return manager;\n}\n\nmodule.exports = {\n  DiagnosticId,\n  DiagnosticsAccumulator,\n  DiagnosticsManager,\n};\n","const messages = require('./messages');\n\n/**\n * Wrap an inspector ensuring that calling its methods are safe.\n * @param {object} inspector Inspector to wrap.\n */\nfunction SafeInspector(inspector, logger) {\n  let errorLogged = false;\n  const wrapper = {\n    type: inspector.type,\n    name: inspector.name,\n    synchronous: inspector.synchronous,\n  };\n\n  wrapper.method = (...args) => {\n    try {\n      inspector.method(...args);\n    } catch {\n      // If something goes wrong in an inspector we want to log that something\n      // went wrong. We don't want to flood the logs, so we only log something\n      // the first time that something goes wrong.\n      // We do not include the exception in the log, because we do not know what\n      // kind of data it may contain.\n      if (!errorLogged) {\n        errorLogged = true;\n        logger.warn(messages.inspectorMethodError(wrapper.type, wrapper.name));\n      }\n      // Prevent errors.\n    }\n  };\n\n  return wrapper;\n}\n\nmodule.exports = SafeInspector;\n","const messages = require('./messages');\nconst SafeInspector = require('./SafeInspector');\nconst { onNextTick } = require('./utils');\n\n/**\n * The types of supported inspectors.\n */\nconst InspectorTypes = {\n  flagUsed: 'flag-used',\n  flagDetailsChanged: 'flag-details-changed',\n  flagDetailChanged: 'flag-detail-changed',\n  clientIdentityChanged: 'client-identity-changed',\n};\n\nObject.freeze(InspectorTypes);\n\n/**\n * Manages dispatching of inspection data to registered inspectors.\n */\nfunction InspectorManager(inspectors, logger) {\n  const manager = {};\n\n  /**\n   * Collection of inspectors keyed by type.\n   *\n   * Inspectors are async by default.\n   *\n   * @type {{[type: string]: object[]}}\n   */\n  const inspectorsByType = {\n    [InspectorTypes.flagUsed]: [],\n    [InspectorTypes.flagDetailsChanged]: [],\n    [InspectorTypes.flagDetailChanged]: [],\n    [InspectorTypes.clientIdentityChanged]: [],\n  };\n  /**\n   * Collection synchronous of inspectors keyed by type.\n   *\n   * @type {{[type: string]: object[]}}\n   */\n  const synchronousInspectorsByType = {\n    [InspectorTypes.flagUsed]: [],\n    [InspectorTypes.flagDetailsChanged]: [],\n    [InspectorTypes.flagDetailChanged]: [],\n    [InspectorTypes.clientIdentityChanged]: [],\n  };\n\n  const safeInspectors = inspectors && inspectors.map(inspector => SafeInspector(inspector, logger));\n\n  safeInspectors &&\n    safeInspectors.forEach(safeInspector => {\n      // Only add inspectors of supported types.\n      if (Object.prototype.hasOwnProperty.call(inspectorsByType, safeInspector.type) && !safeInspector.synchronous) {\n        inspectorsByType[safeInspector.type].push(safeInspector);\n      } else if (\n        Object.prototype.hasOwnProperty.call(synchronousInspectorsByType, safeInspector.type) &&\n        safeInspector.synchronous\n      ) {\n        synchronousInspectorsByType[safeInspector.type].push(safeInspector);\n      } else {\n        logger.warn(messages.invalidInspector(safeInspector.type, safeInspector.name));\n      }\n    });\n\n  /**\n   * Check if there is an inspector of a specific type registered.\n   *\n   * @param {string} type The type of the inspector to check.\n   * @returns True if there are any inspectors of that type registered.\n   */\n  manager.hasListeners = type =>\n    (inspectorsByType[type] && inspectorsByType[type].length) ||\n    (synchronousInspectorsByType[type] && synchronousInspectorsByType[type].length);\n\n  /**\n   * Notify registered inspectors of a flag being used.\n   *\n   * The notification itself will be dispatched asynchronously.\n   *\n   * @param {string} flagKey The key for the flag.\n   * @param {Object} detail The LDEvaluationDetail for the flag.\n   * @param {Object} context The LDContext for the flag.\n   */\n  manager.onFlagUsed = (flagKey, detail, context) => {\n    const type = InspectorTypes.flagUsed;\n    if (synchronousInspectorsByType[type].length) {\n      synchronousInspectorsByType[type].forEach(inspector => inspector.method(flagKey, detail, context));\n    }\n    if (inspectorsByType[type].length) {\n      onNextTick(() => {\n        inspectorsByType[type].forEach(inspector => inspector.method(flagKey, detail, context));\n      });\n    }\n  };\n\n  /**\n   * Notify registered inspectors that the flags have been replaced.\n   *\n   * The notification itself will be dispatched asynchronously.\n   *\n   * @param {Record<string, Object>} flags The current flags as a Record<string, LDEvaluationDetail>.\n   */\n  manager.onFlags = flags => {\n    const type = InspectorTypes.flagDetailsChanged;\n    if (synchronousInspectorsByType[type].length) {\n      synchronousInspectorsByType[type].forEach(inspector => inspector.method(flags));\n    }\n    if (inspectorsByType[type].length) {\n      onNextTick(() => {\n        inspectorsByType[type].forEach(inspector => inspector.method(flags));\n      });\n    }\n  };\n\n  /**\n   * Notify registered inspectors that a flag value has changed.\n   *\n   * The notification itself will be dispatched asynchronously.\n   *\n   * @param {string} flagKey The key for the flag that changed.\n   * @param {Object} flag An `LDEvaluationDetail` for the flag.\n   */\n  manager.onFlagChanged = (flagKey, flag) => {\n    const type = InspectorTypes.flagDetailChanged;\n    if (synchronousInspectorsByType[type].length) {\n      synchronousInspectorsByType[type].forEach(inspector => inspector.method(flagKey, flag));\n    }\n    if (inspectorsByType[type].length) {\n      onNextTick(() => {\n        inspectorsByType[type].forEach(inspector => inspector.method(flagKey, flag));\n      });\n    }\n  };\n\n  /**\n   * Notify the registered inspectors that the context identity has changed.\n   *\n   * The notification itself will be dispatched asynchronously.\n   *\n   * @param {Object} context The `LDContext` which is now identified.\n   */\n  manager.onIdentityChanged = context => {\n    const type = InspectorTypes.clientIdentityChanged;\n    if (synchronousInspectorsByType[type].length) {\n      synchronousInspectorsByType[type].forEach(inspector => inspector.method(context));\n    }\n    if (inspectorsByType[type].length) {\n      onNextTick(() => {\n        inspectorsByType[type].forEach(inspector => inspector.method(context));\n      });\n    }\n  };\n\n  return manager;\n}\n\nmodule.exports = { InspectorTypes, InspectorManager };\n","const { LDTimeoutError } = require('./errors');\n\n/**\n * Returns a promise which errors after t seconds.\n *\n * @param t Timeout in seconds.\n * @param taskName Name of task being timed for logging and error reporting.\n */\nfunction timedPromise(t, taskName) {\n  return new Promise((_res, reject) => {\n    setTimeout(() => {\n      const e = `${taskName} timed out after ${t} seconds.`;\n      reject(new LDTimeoutError(e));\n    }, t * 1000);\n  });\n}\nmodule.exports = timedPromise;\n","const EventProcessor = require('./EventProcessor');\nconst EventEmitter = require('./EventEmitter');\nconst EventSender = require('./EventSender');\nconst InitializationStateTracker = require('./InitializationState');\nconst PersistentFlagStore = require('./PersistentFlagStore');\nconst PersistentStorage = require('./PersistentStorage');\nconst Stream = require('./Stream');\nconst Requestor = require('./Requestor');\nconst Identity = require('./Identity');\nconst AnonymousContextProcessor = require('./AnonymousContextProcessor');\nconst configuration = require('./configuration');\nconst diagnostics = require('./diagnosticEvents');\nconst { commonBasicLogger } = require('./loggers');\nconst utils = require('./utils');\nconst errors = require('./errors');\nconst messages = require('./messages');\nconst { checkContext, getContextKeys } = require('./context');\nconst { InspectorTypes, InspectorManager } = require('./InspectorManager');\nconst timedPromise = require('./timedPromise');\n\nconst changeEvent = 'change';\nconst internalChangeEvent = 'internal-change';\nconst highTimeoutThreshold = 5;\n\n// This is called by the per-platform initialize functions to create the base client object that we\n// may also extend with additional behavior. It returns an object with these properties:\n//   client: the actual client object\n//   options: the configuration (after any appropriate defaults have been applied)\n// If we need to give the platform-specific clients access to any internals here, we should add those\n// as properties of the return object, not public properties of the client.\n//\n// For definitions of the API in the platform object, see stubPlatform.js in the test code.\n\nfunction initialize(env, context, specifiedOptions, platform, extraOptionDefs) {\n  const logger = createLogger();\n  const emitter = EventEmitter(logger);\n  const initializationStateTracker = InitializationStateTracker(emitter);\n  const options = configuration.validate(specifiedOptions, emitter, extraOptionDefs, logger);\n  const inspectorManager = InspectorManager(options.inspectors, logger);\n  const sendEvents = options.sendEvents;\n  let environment = env;\n  let hash = options.hash;\n\n  const persistentStorage = PersistentStorage(platform.localStorage, logger);\n\n  const eventSender = EventSender(platform, environment, options);\n\n  const diagnosticsEnabled = options.sendEvents && !options.diagnosticOptOut;\n  const diagnosticId = diagnosticsEnabled ? diagnostics.DiagnosticId(environment) : null;\n  const diagnosticsAccumulator = diagnosticsEnabled ? diagnostics.DiagnosticsAccumulator(new Date().getTime()) : null;\n  const diagnosticsManager = diagnosticsEnabled\n    ? diagnostics.DiagnosticsManager(\n        platform,\n        persistentStorage,\n        diagnosticsAccumulator,\n        eventSender,\n        environment,\n        options,\n        diagnosticId\n      )\n    : null;\n\n  const stream = Stream(platform, options, environment, diagnosticsAccumulator);\n\n  const events =\n    options.eventProcessor ||\n    EventProcessor(platform, options, environment, diagnosticsAccumulator, emitter, eventSender);\n\n  const requestor = Requestor(platform, options, environment);\n\n  let flags = {};\n  let useLocalStorage;\n  let streamActive;\n  let streamForcedState = options.streaming;\n  let subscribedToChangeEvents;\n  let inited = false;\n  let closed = false;\n  let firstEvent = true;\n\n  // The \"stateProvider\" object is used in the Electron SDK, to allow one client instance to take partial\n  // control of another. If present, it has the following contract:\n  // - getInitialState() returns the initial client state if it is already available. The state is an\n  //   object whose properties are \"environment\", \"context\", and \"flags\".\n  // - on(\"init\", listener) triggers an event when the initial client state becomes available, passing\n  //   the state object to the listener.\n  // - on(\"update\", listener) triggers an event when flag values change and/or the current context changes.\n  //   The parameter is an object that *may* contain \"context\" and/or \"flags\".\n  // - enqueueEvent(event) accepts an analytics event object and returns true if the stateProvider will\n  //   be responsible for delivering it, or false if we still should deliver it ourselves.\n  const stateProvider = options.stateProvider;\n\n  const ident = Identity(null, onIdentifyChange);\n  const anonymousContextProcessor = new AnonymousContextProcessor(persistentStorage);\n  const persistentFlagStore = persistentStorage.isEnabled()\n    ? PersistentFlagStore(persistentStorage, environment, hash, ident, logger)\n    : null;\n\n  function createLogger() {\n    if (specifiedOptions && specifiedOptions.logger) {\n      return specifiedOptions.logger;\n    }\n    return (extraOptionDefs && extraOptionDefs.logger && extraOptionDefs.logger.default) || commonBasicLogger('warn');\n  }\n\n  function readFlagsFromBootstrap(data) {\n    // If the bootstrap data came from an older server-side SDK, we'll have just a map of keys to values.\n    // Newer SDKs that have an allFlagsState method will provide an extra \"$flagsState\" key that contains\n    // the rest of the metadata we want. We do it this way for backward compatibility with older JS SDKs.\n    const keys = Object.keys(data);\n    const metadataKey = '$flagsState';\n    const validKey = '$valid';\n    const metadata = data[metadataKey];\n    if (!metadata && keys.length) {\n      logger.warn(messages.bootstrapOldFormat());\n    }\n    if (data[validKey] === false) {\n      logger.warn(messages.bootstrapInvalid());\n    }\n    const ret = {};\n    keys.forEach(key => {\n      if (key !== metadataKey && key !== validKey) {\n        let flag = { value: data[key] };\n        if (metadata && metadata[key]) {\n          flag = utils.extend(flag, metadata[key]);\n        } else {\n          flag.version = 0;\n        }\n        ret[key] = flag;\n      }\n    });\n    return ret;\n  }\n\n  function shouldEnqueueEvent() {\n    return sendEvents && !closed && !platform.isDoNotTrack();\n  }\n\n  function enqueueEvent(event) {\n    if (!environment) {\n      // We're in paired mode and haven't been initialized with an environment or context yet\n      return;\n    }\n    if (stateProvider && stateProvider.enqueueEvent && stateProvider.enqueueEvent(event)) {\n      return; // it'll be handled elsewhere\n    }\n\n    if (!event.context) {\n      if (firstEvent) {\n        logger.warn(messages.eventWithoutContext());\n        firstEvent = false;\n      }\n      return;\n    }\n    firstEvent = false;\n\n    if (shouldEnqueueEvent()) {\n      logger.debug(messages.debugEnqueueingEvent(event.kind));\n      events.enqueue(event);\n    }\n  }\n\n  function notifyInspectionFlagUsed(key, detail) {\n    if (inspectorManager.hasListeners(InspectorTypes.flagUsed)) {\n      inspectorManager.onFlagUsed(key, detail, ident.getContext());\n    }\n  }\n\n  function notifyInspectionIdentityChanged() {\n    if (inspectorManager.hasListeners(InspectorTypes.clientIdentityChanged)) {\n      inspectorManager.onIdentityChanged(ident.getContext());\n    }\n  }\n\n  function notifyInspectionFlagChanged(data, newFlag) {\n    if (inspectorManager.hasListeners(InspectorTypes.flagDetailChanged)) {\n      inspectorManager.onFlagChanged(data.key, getFlagDetail(newFlag));\n    }\n  }\n\n  function notifyInspectionFlagsChanged() {\n    if (inspectorManager.hasListeners(InspectorTypes.flagDetailsChanged)) {\n      inspectorManager.onFlags(\n        Object.entries(flags)\n          .map(([key, value]) => ({ key, detail: getFlagDetail(value) }))\n          .reduce((acc, cur) => {\n            // eslint-disable-next-line no-param-reassign\n            acc[cur.key] = cur.detail;\n            return acc;\n          }, {})\n      );\n    }\n  }\n\n  function onIdentifyChange(context) {\n    sendIdentifyEvent(context);\n    notifyInspectionIdentityChanged();\n  }\n\n  function sendIdentifyEvent(context) {\n    if (stateProvider) {\n      // In paired mode, the other client is responsible for sending identify events\n      return;\n    }\n    if (context) {\n      enqueueEvent({\n        kind: 'identify',\n        context,\n        creationDate: new Date().getTime(),\n      });\n    }\n  }\n\n  function sendFlagEvent(key, detail, defaultValue, includeReason) {\n    const context = ident.getContext();\n    const now = new Date();\n    const value = detail ? detail.value : null;\n\n    const event = {\n      kind: 'feature',\n      key: key,\n      context,\n      value: value,\n      variation: detail ? detail.variationIndex : null,\n      default: defaultValue,\n      creationDate: now.getTime(),\n    };\n    const flag = flags[key];\n    if (flag) {\n      event.version = flag.flagVersion ? flag.flagVersion : flag.version;\n      event.trackEvents = flag.trackEvents;\n      event.debugEventsUntilDate = flag.debugEventsUntilDate;\n    }\n    if ((includeReason || (flag && flag.trackReason)) && detail) {\n      event.reason = detail.reason;\n    }\n\n    enqueueEvent(event);\n  }\n\n  function verifyContext(context) {\n    // The context will already have been processed to have a string key, so we\n    // do not need to allow for legacy keys in the check.\n    if (checkContext(context, false)) {\n      return Promise.resolve(context);\n    } else {\n      return Promise.reject(new errors.LDInvalidUserError(messages.invalidContext()));\n    }\n  }\n\n  function identify(context, newHash, onDone) {\n    if (closed) {\n      return utils.wrapPromiseCallback(Promise.resolve({}), onDone);\n    }\n    if (stateProvider) {\n      // We're being controlled by another client instance, so only that instance is allowed to change the context\n      logger.warn(messages.identifyDisabled());\n      return utils.wrapPromiseCallback(Promise.resolve(utils.transformVersionedValuesToValues(flags)), onDone);\n    }\n    const clearFirst = useLocalStorage && persistentFlagStore ? persistentFlagStore.clearFlags() : Promise.resolve();\n    return utils.wrapPromiseCallback(\n      clearFirst\n        .then(() => anonymousContextProcessor.processContext(context))\n        .then(verifyContext)\n        .then(validatedContext =>\n          requestor\n            .fetchFlagSettings(validatedContext, newHash)\n            // the following then() is nested within this one so we can use realUser from the previous closure\n            .then(requestedFlags => {\n              const flagValueMap = utils.transformVersionedValuesToValues(requestedFlags);\n              ident.setContext(validatedContext);\n              hash = newHash;\n              if (requestedFlags) {\n                return replaceAllFlags(requestedFlags).then(() => flagValueMap);\n              } else {\n                return flagValueMap;\n              }\n            })\n        )\n        .then(flagValueMap => {\n          if (streamActive) {\n            connectStream();\n          }\n          return flagValueMap;\n        })\n        .catch(err => {\n          emitter.maybeReportError(err);\n          return Promise.reject(err);\n        }),\n      onDone\n    );\n  }\n\n  function getContext() {\n    return ident.getContext();\n  }\n\n  function flush(onDone) {\n    return utils.wrapPromiseCallback(sendEvents ? events.flush() : Promise.resolve(), onDone);\n  }\n\n  function variation(key, defaultValue) {\n    return variationDetailInternal(key, defaultValue, true, false, false).value;\n  }\n\n  function variationDetail(key, defaultValue) {\n    return variationDetailInternal(key, defaultValue, true, true, false);\n  }\n\n  function variationDetailInternal(key, defaultValue, sendEvent, includeReasonInEvent, isAllFlags) {\n    let detail;\n\n    if (flags && utils.objectHasOwnProperty(flags, key) && flags[key] && !flags[key].deleted) {\n      const flag = flags[key];\n      detail = getFlagDetail(flag);\n      if (flag.value === null || flag.value === undefined) {\n        detail.value = defaultValue;\n      }\n    } else {\n      detail = { value: defaultValue, variationIndex: null, reason: { kind: 'ERROR', errorKind: 'FLAG_NOT_FOUND' } };\n    }\n\n    if (sendEvent) {\n      sendFlagEvent(key, detail, defaultValue, includeReasonInEvent);\n    }\n\n    // For the all flags case `onFlags` will be called instead.\n    if (!isAllFlags) {\n      notifyInspectionFlagUsed(key, detail);\n    }\n\n    return detail;\n  }\n\n  function getFlagDetail(flag) {\n    return {\n      value: flag.value,\n      variationIndex: flag.variation === undefined ? null : flag.variation,\n      reason: flag.reason || null,\n    };\n    // Note, the logic above ensures that variationIndex and reason will always be null rather than\n    // undefined if we don't have values for them. That's just to avoid subtle errors that depend on\n    // whether an object was JSON-encoded with null properties omitted or not.\n  }\n\n  function allFlags() {\n    const results = {};\n\n    if (!flags) {\n      return results;\n    }\n\n    for (const key in flags) {\n      if (utils.objectHasOwnProperty(flags, key) && !flags[key].deleted) {\n        results[key] = variationDetailInternal(key, null, !options.sendEventsOnlyForVariation, false, true).value;\n      }\n    }\n\n    return results;\n  }\n\n  function userContextKind(user) {\n    return user.anonymous ? 'anonymousUser' : 'user';\n  }\n\n  function track(key, data, metricValue) {\n    if (typeof key !== 'string') {\n      emitter.maybeReportError(new errors.LDInvalidEventKeyError(messages.unknownCustomEventKey(key)));\n      return;\n    }\n    if (metricValue !== undefined && typeof metricValue !== 'number') {\n      logger.warn(messages.invalidMetricValue(typeof metricValue));\n    }\n\n    // The following logic was used only for the JS browser SDK (js-client-sdk) and\n    // is no longer needed as of version 2.9.13 of that SDK. The other client-side\n    // JS-based SDKs did not define customEventFilter, and now none of them do. We\n    // can remove this in the next major version of the common code, when it's OK to\n    // make breaking changes to our internal API contracts.\n    if (platform.customEventFilter && !platform.customEventFilter(key)) {\n      logger.warn(messages.unknownCustomEventKey(key));\n    }\n\n    const context = ident.getContext();\n    const e = {\n      kind: 'custom',\n      key: key,\n      context,\n      url: platform.getCurrentUrl(),\n      creationDate: new Date().getTime(),\n    };\n    if (context && context.anonymous) {\n      e.contextKind = userContextKind(context);\n    }\n    // Note, check specifically for null/undefined because it is legal to set these fields to a falsey value.\n    if (data !== null && data !== undefined) {\n      e.data = data;\n    }\n    if (metricValue !== null && metricValue !== undefined) {\n      e.metricValue = metricValue;\n    }\n    enqueueEvent(e);\n  }\n\n  function connectStream() {\n    streamActive = true;\n    if (!ident.getContext()) {\n      return;\n    }\n    const tryParseData = jsonData => {\n      try {\n        return JSON.parse(jsonData);\n      } catch (err) {\n        emitter.maybeReportError(new errors.LDInvalidDataError(messages.invalidData()));\n        return undefined;\n      }\n    };\n    stream.connect(ident.getContext(), hash, {\n      ping: function() {\n        logger.debug(messages.debugStreamPing());\n        const contextAtTimeOfPingEvent = ident.getContext();\n        requestor\n          .fetchFlagSettings(contextAtTimeOfPingEvent, hash)\n          .then(requestedFlags => {\n            // Check whether the current context is still the same - we don't want to overwrite the flags if\n            // the application has called identify() while this request was in progress\n            if (utils.deepEquals(contextAtTimeOfPingEvent, ident.getContext())) {\n              replaceAllFlags(requestedFlags || {});\n            }\n          })\n          .catch(err => {\n            emitter.maybeReportError(new errors.LDFlagFetchError(messages.errorFetchingFlags(err)));\n          });\n      },\n      put: function(e) {\n        const data = tryParseData(e.data);\n        if (!data) {\n          return;\n        }\n        logger.debug(messages.debugStreamPut());\n        replaceAllFlags(data);\n        // Don't wait for this Promise to be resolved; note that replaceAllFlags is guaranteed\n        // never to have an unhandled rejection\n      },\n      patch: function(e) {\n        const data = tryParseData(e.data);\n        if (!data) {\n          return;\n        }\n        // If both the flag and the patch have a version property, then the patch version must be\n        // greater than the flag version for us to accept the patch.  If either one has no version\n        // then the patch always succeeds.\n        const oldFlag = flags[data.key];\n        if (!oldFlag || !oldFlag.version || !data.version || oldFlag.version < data.version) {\n          logger.debug(messages.debugStreamPatch(data.key));\n          const mods = {};\n          const newFlag = utils.extend({}, data);\n          delete newFlag['key'];\n          flags[data.key] = newFlag;\n          const newDetail = getFlagDetail(newFlag);\n          if (oldFlag) {\n            mods[data.key] = { previous: oldFlag.value, current: newDetail };\n          } else {\n            mods[data.key] = { current: newDetail };\n          }\n          notifyInspectionFlagChanged(data, newFlag);\n          handleFlagChanges(mods); // don't wait for this Promise to be resolved\n        } else {\n          logger.debug(messages.debugStreamPatchIgnored(data.key));\n        }\n      },\n      delete: function(e) {\n        const data = tryParseData(e.data);\n        if (!data) {\n          return;\n        }\n        if (!flags[data.key] || flags[data.key].version < data.version) {\n          logger.debug(messages.debugStreamDelete(data.key));\n          const mods = {};\n          if (flags[data.key] && !flags[data.key].deleted) {\n            mods[data.key] = { previous: flags[data.key].value };\n          }\n          flags[data.key] = { version: data.version, deleted: true };\n          notifyInspectionFlagChanged(data, flags[data.key]);\n          handleFlagChanges(mods); // don't wait for this Promise to be resolved\n        } else {\n          logger.debug(messages.debugStreamDeleteIgnored(data.key));\n        }\n      },\n    });\n  }\n\n  function disconnectStream() {\n    if (streamActive) {\n      stream.disconnect();\n      streamActive = false;\n    }\n  }\n\n  // Returns a Promise which will be resolved when we have completely updated the internal flags state,\n  // dispatched all change events, and updated local storage if appropriate. This Promise is guaranteed\n  // never to have an unhandled rejection.\n  function replaceAllFlags(newFlags) {\n    const changes = {};\n\n    if (!newFlags) {\n      return Promise.resolve();\n    }\n\n    for (const key in flags) {\n      if (utils.objectHasOwnProperty(flags, key) && flags[key]) {\n        if (newFlags[key] && !utils.deepEquals(newFlags[key].value, flags[key].value)) {\n          changes[key] = { previous: flags[key].value, current: getFlagDetail(newFlags[key]) };\n        } else if (!newFlags[key] || newFlags[key].deleted) {\n          changes[key] = { previous: flags[key].value };\n        }\n      }\n    }\n    for (const key in newFlags) {\n      if (utils.objectHasOwnProperty(newFlags, key) && newFlags[key] && (!flags[key] || flags[key].deleted)) {\n        changes[key] = { current: getFlagDetail(newFlags[key]) };\n      }\n    }\n\n    flags = { ...newFlags };\n\n    notifyInspectionFlagsChanged();\n\n    return handleFlagChanges(changes).catch(() => {}); // swallow any exceptions from this Promise\n  }\n\n  // Returns a Promise which will be resolved when we have dispatched all change events and updated\n  // local storage if appropriate.\n  function handleFlagChanges(changes) {\n    const keys = Object.keys(changes);\n\n    if (keys.length > 0) {\n      const changeEventParams = {};\n      keys.forEach(key => {\n        const current = changes[key].current;\n        const value = current ? current.value : undefined;\n        const previous = changes[key].previous;\n        emitter.emit(changeEvent + ':' + key, value, previous);\n        changeEventParams[key] = current ? { current: value, previous: previous } : { previous: previous };\n      });\n\n      emitter.emit(changeEvent, changeEventParams);\n      emitter.emit(internalChangeEvent, flags);\n\n      // By default, we send feature evaluation events whenever we have received new flag values -\n      // the client has in effect evaluated these flags just by receiving them. This can be suppressed\n      // by setting \"sendEventsOnlyForVariation\". Also, if we have a stateProvider, we don't send these\n      // events because we assume they have already been sent by the other client that gave us the flags\n      // (when it received them in the first place).\n      if (!options.sendEventsOnlyForVariation && !stateProvider) {\n        keys.forEach(key => {\n          sendFlagEvent(key, changes[key].current);\n        });\n      }\n    }\n\n    if (useLocalStorage && persistentFlagStore) {\n      return persistentFlagStore.saveFlags(flags);\n    } else {\n      return Promise.resolve();\n    }\n  }\n\n  function on(event, handler, context) {\n    if (isChangeEventKey(event)) {\n      subscribedToChangeEvents = true;\n      if (inited) {\n        updateStreamingState();\n      }\n      emitter.on(event, handler, context);\n    } else {\n      emitter.on(...arguments);\n    }\n  }\n\n  function off(event) {\n    emitter.off(...arguments);\n    if (isChangeEventKey(event)) {\n      let haveListeners = false;\n      emitter.getEvents().forEach(key => {\n        if (isChangeEventKey(key) && emitter.getEventListenerCount(key) > 0) {\n          haveListeners = true;\n        }\n      });\n      if (!haveListeners) {\n        subscribedToChangeEvents = false;\n        if (streamActive && streamForcedState === undefined) {\n          disconnectStream();\n        }\n      }\n    }\n  }\n\n  function setStreaming(state) {\n    const newState = state === null ? undefined : state;\n    if (newState !== streamForcedState) {\n      streamForcedState = newState;\n      updateStreamingState();\n    }\n  }\n\n  function updateStreamingState() {\n    const shouldBeStreaming = streamForcedState || (subscribedToChangeEvents && streamForcedState === undefined);\n    if (shouldBeStreaming && !streamActive) {\n      connectStream();\n    } else if (!shouldBeStreaming && streamActive) {\n      disconnectStream();\n    }\n    if (diagnosticsManager) {\n      diagnosticsManager.setStreaming(shouldBeStreaming);\n    }\n  }\n\n  function isChangeEventKey(event) {\n    return event === changeEvent || event.substr(0, changeEvent.length + 1) === changeEvent + ':';\n  }\n\n  if (typeof options.bootstrap === 'string' && options.bootstrap.toUpperCase() === 'LOCALSTORAGE') {\n    if (persistentFlagStore) {\n      useLocalStorage = true;\n    } else {\n      logger.warn(messages.localStorageUnavailable());\n    }\n  }\n\n  if (typeof options.bootstrap === 'object') {\n    // Set the flags as soon as possible before we get into any async code, so application code can read\n    // them even if the ready event has not yet fired.\n    flags = readFlagsFromBootstrap(options.bootstrap);\n  }\n\n  if (stateProvider) {\n    // The stateProvider option is used in the Electron SDK, to allow a client instance in the main process\n    // to control another client instance (i.e. this one) in the renderer process. We can't predict which\n    // one will start up first, so the initial state may already be available for us or we may have to wait\n    // to receive it.\n    const state = stateProvider.getInitialState();\n    if (state) {\n      initFromStateProvider(state);\n    } else {\n      stateProvider.on('init', initFromStateProvider);\n    }\n    stateProvider.on('update', updateFromStateProvider);\n  } else {\n    finishInit().catch(signalFailedInit);\n  }\n\n  function finishInit() {\n    if (!env) {\n      return Promise.reject(new errors.LDInvalidEnvironmentIdError(messages.environmentNotSpecified()));\n    }\n    return anonymousContextProcessor\n      .processContext(context)\n      .then(verifyContext)\n      .then(validatedContext => {\n        ident.setContext(validatedContext);\n        if (typeof options.bootstrap === 'object') {\n          // flags have already been set earlier\n          return signalSuccessfulInit();\n        } else if (useLocalStorage) {\n          return finishInitWithLocalStorage();\n        } else {\n          return finishInitWithPolling();\n        }\n      });\n  }\n\n  function finishInitWithLocalStorage() {\n    return persistentFlagStore.loadFlags().then(storedFlags => {\n      if (storedFlags === null || storedFlags === undefined) {\n        flags = {};\n        return requestor\n          .fetchFlagSettings(ident.getContext(), hash)\n          .then(requestedFlags => replaceAllFlags(requestedFlags || {}))\n          .then(signalSuccessfulInit)\n          .catch(err => {\n            const initErr = new errors.LDFlagFetchError(messages.errorFetchingFlags(err));\n            signalFailedInit(initErr);\n          });\n      } else {\n        // We're reading the flags from local storage. Signal that we're ready,\n        // then update localStorage for the next page load. We won't signal changes or update\n        // the in-memory flags unless you subscribe for changes\n        flags = storedFlags;\n        utils.onNextTick(signalSuccessfulInit);\n\n        return requestor\n          .fetchFlagSettings(ident.getContext(), hash)\n          .then(requestedFlags => replaceAllFlags(requestedFlags))\n          .catch(err => emitter.maybeReportError(err));\n      }\n    });\n  }\n\n  function finishInitWithPolling() {\n    return requestor\n      .fetchFlagSettings(ident.getContext(), hash)\n      .then(requestedFlags => {\n        flags = requestedFlags || {};\n\n        notifyInspectionFlagsChanged();\n        // Note, we don't need to call updateSettings here because local storage and change events are not relevant\n        signalSuccessfulInit();\n      })\n      .catch(err => {\n        flags = {};\n        signalFailedInit(err);\n      });\n  }\n\n  function initFromStateProvider(state) {\n    environment = state.environment;\n    ident.setContext(state.context);\n    flags = { ...state.flags };\n    utils.onNextTick(signalSuccessfulInit);\n  }\n\n  function updateFromStateProvider(state) {\n    if (state.context) {\n      ident.setContext(state.context);\n    }\n    if (state.flags) {\n      replaceAllFlags(state.flags); // don't wait for this Promise to be resolved\n    }\n  }\n\n  function signalSuccessfulInit() {\n    logger.info(messages.clientInitialized());\n    inited = true;\n    updateStreamingState();\n    initializationStateTracker.signalSuccess();\n  }\n\n  function signalFailedInit(err) {\n    initializationStateTracker.signalFailure(err);\n  }\n\n  function start() {\n    if (sendEvents) {\n      if (diagnosticsManager) {\n        diagnosticsManager.start();\n      }\n      events.start();\n    }\n  }\n\n  function close(onDone) {\n    if (closed) {\n      return utils.wrapPromiseCallback(Promise.resolve(), onDone);\n    }\n    const finishClose = () => {\n      closed = true;\n      flags = {};\n    };\n    const p = Promise.resolve()\n      .then(() => {\n        disconnectStream();\n        if (diagnosticsManager) {\n          diagnosticsManager.stop();\n        }\n        if (sendEvents) {\n          events.stop();\n          return events.flush();\n        }\n      })\n      .then(finishClose)\n      .catch(finishClose);\n    return utils.wrapPromiseCallback(p, onDone);\n  }\n\n  function getFlagsInternal() {\n    // used by Electron integration\n    return flags;\n  }\n\n  function waitForInitializationWithTimeout(timeout) {\n    if (timeout > highTimeoutThreshold) {\n      logger.warn(\n        'The waitForInitialization function was called with a timeout greater than ' +\n          `${highTimeoutThreshold} seconds. We recommend a timeout of ` +\n          `${highTimeoutThreshold} seconds or less.`\n      );\n    }\n\n    const initPromise = initializationStateTracker.getInitializationPromise();\n    const timeoutPromise = timedPromise(timeout, 'waitForInitialization');\n\n    return Promise.race([timeoutPromise, initPromise]).catch(e => {\n      if (e instanceof errors.LDTimeoutError) {\n        logger.error(`waitForInitialization error: ${e}`);\n      }\n      throw e;\n    });\n  }\n\n  function waitForInitialization(timeout = undefined) {\n    if (timeout !== undefined && timeout !== null) {\n      if (typeof timeout === 'number') {\n        return waitForInitializationWithTimeout(timeout);\n      }\n      logger.warn('The waitForInitialization method was provided with a non-numeric timeout.');\n    }\n    logger.warn(\n      'The waitForInitialization function was called without a timeout specified.' +\n        ' In a future version a default timeout will be applied.'\n    );\n    return initializationStateTracker.getInitializationPromise();\n  }\n\n  const client = {\n    waitForInitialization,\n    waitUntilReady: () => initializationStateTracker.getReadyPromise(),\n    identify: identify,\n    getContext: getContext,\n    variation: variation,\n    variationDetail: variationDetail,\n    track: track,\n    on: on,\n    off: off,\n    setStreaming: setStreaming,\n    flush: flush,\n    allFlags: allFlags,\n    close: close,\n  };\n\n  return {\n    client: client, // The client object containing all public methods.\n    options: options, // The validated configuration object, including all defaults.\n    emitter: emitter, // The event emitter which can be used to log errors or trigger events.\n    ident: ident, // The Identity object that manages the current context.\n    logger: logger, // The logging abstraction.\n    requestor: requestor, // The Requestor object.\n    start: start, // Starts the client once the environment is ready.\n    enqueueEvent: enqueueEvent, // Puts an analytics event in the queue, if event sending is enabled.\n    getFlagsInternal: getFlagsInternal, // Returns flag data structure with all details.\n    getEnvironmentId: () => environment, // Gets the environment ID (this may have changed since initialization, if we have a state provider)\n    internalChangeEventName: internalChangeEvent, // This event is triggered whenever we have new flag state.\n  };\n}\n\nmodule.exports = {\n  initialize,\n  commonBasicLogger,\n  errors,\n  messages,\n  utils,\n  getContextKeys,\n};\n","const { commonBasicLogger } = require('launchdarkly-js-sdk-common');\n\nfunction basicLogger(options) {\n  return commonBasicLogger({ destination: console.log, ...options });\n}\n\nmodule.exports = {\n  basicLogger,\n};\n","function isSyncXhrSupported() {\n  // This is temporary logic to disable synchronous XHR in Chrome 73 and above. In all other browsers,\n  // we will assume it is supported. See https://github.com/launchdarkly/js-client-sdk/issues/147\n  const userAgent = window.navigator && window.navigator.userAgent;\n  if (userAgent) {\n    const chromeMatch = userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n    if (chromeMatch) {\n      const version = parseInt(chromeMatch[2], 10);\n      return version < 73;\n    }\n  }\n  return true;\n}\n\nconst emptyResult = { promise: Promise.resolve({ status: 200, header: () => null, body: null }) };\n\nexport default function newHttpRequest(method, url, headers, body, pageIsClosing) {\n  if (pageIsClosing) {\n    // When the page is about to close, we have to use synchronous XHR (until we migrate to sendBeacon).\n    // But not all browsers support this.\n    if (!isSyncXhrSupported()) {\n      return emptyResult;\n      // Note that we return a fake success response, because we don't want the request to be retried in this case.\n    }\n  }\n\n  const xhr = new window.XMLHttpRequest();\n  xhr.open(method, url, !pageIsClosing);\n  for (const key in headers || {}) {\n    if (Object.prototype.hasOwnProperty.call(headers, key)) {\n      xhr.setRequestHeader(key, headers[key]);\n    }\n  }\n  if (pageIsClosing) {\n    try {\n      xhr.send(body); // We specified synchronous mode when we called xhr.open\n    } catch (e) {\n      // do nothing intentionally to suppress noise for now\n    }\n    return emptyResult; // Again, we never want a request to be retried in this case, so we must say it succeeded.\n  } else {\n    let cancelled;\n    const p = new Promise((resolve, reject) => {\n      xhr.addEventListener('load', () => {\n        if (cancelled) {\n          return;\n        }\n        resolve({\n          status: xhr.status,\n          header: (key) => xhr.getResponseHeader(key),\n          body: xhr.responseText,\n        });\n      });\n      xhr.addEventListener('error', () => {\n        if (cancelled) {\n          return;\n        }\n        reject(new Error());\n      });\n      xhr.send(body);\n    });\n    const cancel = () => {\n      cancelled = true;\n      xhr.abort();\n    };\n    return { promise: p, cancel: cancel };\n  }\n}\n","'use strict';\n\nmodule.exports = string => {\n\tif (typeof string !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\t// Escape characters with special meaning either inside or outside character sets.\n\t// Use a simple backslash escape when it’s always valid, and a \\unnnn escape when the simpler form would be disallowed by Unicode patterns’ stricter grammar.\n\treturn string\n\t\t.replace(/[|\\\\{}()[\\]^$+*?.]/g, '\\\\$&')\n\t\t.replace(/-/g, '\\\\x2d');\n};\n","import escapeStringRegexp from 'escape-string-regexp';\n\nexport function doesUrlMatch(matcher, href, search, hash) {\n  const keepHash = (matcher.kind === 'substring' || matcher.kind === 'regex') && hash.includes('/');\n  const canonicalUrl = (keepHash ? href : href.replace(hash, '')).replace(search, '');\n\n  let regex;\n  let testUrl;\n\n  switch (matcher.kind) {\n    case 'exact':\n      testUrl = href;\n      regex = new RegExp('^' + escapeStringRegexp(matcher.url) + '/?$');\n      break;\n    case 'canonical':\n      testUrl = canonicalUrl;\n      regex = new RegExp('^' + escapeStringRegexp(matcher.url) + '/?$');\n      break;\n    case 'substring':\n      testUrl = canonicalUrl;\n      regex = new RegExp('.*' + escapeStringRegexp(matcher.substring) + '.*$');\n      break;\n    case 'regex':\n      testUrl = canonicalUrl;\n      regex = new RegExp(matcher.pattern);\n      break;\n    default:\n      return false;\n  }\n  return regex.test(testUrl);\n}\n\nfunction findGoalsForClick(event, clickGoals) {\n  const matches = [];\n\n  for (let i = 0; i < clickGoals.length; i++) {\n    let target = event.target;\n    const goal = clickGoals[i];\n    const selector = goal.selector;\n    const elements = document.querySelectorAll(selector);\n    while (target && elements.length > 0) {\n      for (let j = 0; j < elements.length; j++) {\n        if (target === elements[j]) {\n          matches.push(goal);\n        }\n      }\n      target = target.parentNode;\n    }\n  }\n\n  return matches;\n}\n\nexport default function GoalTracker(goals, onEvent) {\n  const tracker = {};\n  let listenerFn = null;\n\n  const clickGoals = [];\n\n  for (let i = 0; i < goals.length; i++) {\n    const goal = goals[i];\n    const urls = goal.urls || [];\n\n    for (let j = 0; j < urls.length; j++) {\n      if (doesUrlMatch(urls[j], window.location.href, window.location.search, window.location.hash)) {\n        if (goal.kind === 'pageview') {\n          onEvent('pageview', goal);\n        } else {\n          clickGoals.push(goal);\n          onEvent('click_pageview', goal);\n        }\n        break;\n      }\n    }\n  }\n\n  if (clickGoals.length > 0) {\n    listenerFn = function (event) {\n      const goals = findGoalsForClick(event, clickGoals);\n      for (let i = 0; i < goals.length; i++) {\n        onEvent('click', goals[i]);\n      }\n    };\n\n    document.addEventListener('click', listenerFn);\n  }\n\n  tracker.dispose = function () {\n    document.removeEventListener('click', listenerFn);\n  };\n\n  return tracker;\n}\n","import * as common from 'launchdarkly-js-sdk-common';\nimport GoalTracker from './GoalTracker';\n\nconst locationWatcherInterval = 300;\n\nexport default function GoalManager(clientVars, readyCallback) {\n  let goals;\n  let goalTracker;\n\n  const ret = {};\n\n  function getGoalsPath() {\n    return '/sdk/goals/' + clientVars.getEnvironmentId();\n  }\n\n  function refreshGoalTracker() {\n    if (goalTracker) {\n      goalTracker.dispose();\n    }\n    if (goals && goals.length) {\n      goalTracker = GoalTracker(goals, sendGoalEvent);\n    }\n  }\n\n  function sendGoalEvent(kind, goal) {\n    const context = clientVars.ident.getContext();\n    const event = {\n      kind: kind,\n      key: goal.key,\n      data: null,\n      url: window.location.href,\n      creationDate: new Date().getTime(),\n      context: context,\n    };\n\n    if (kind === 'click') {\n      event.selector = goal.selector;\n    }\n\n    return clientVars.enqueueEvent(event);\n  }\n\n  function watchLocation(interval, callback) {\n    let previousUrl = window.location.href;\n    let currentUrl;\n\n    function checkUrl() {\n      currentUrl = window.location.href;\n\n      if (currentUrl !== previousUrl) {\n        previousUrl = currentUrl;\n        callback();\n      }\n    }\n\n    function poll(fn, interval) {\n      fn();\n      setTimeout(() => {\n        poll(fn, interval);\n      }, interval);\n    }\n\n    poll(checkUrl, interval);\n\n    if (window.history && window.history.pushState) {\n      window.addEventListener('popstate', checkUrl);\n    } else {\n      window.addEventListener('hashchange', checkUrl);\n    }\n  }\n\n  clientVars.requestor\n    .fetchJSON(getGoalsPath())\n    .then((g) => {\n      if (g && g.length > 0) {\n        goals = g;\n        goalTracker = GoalTracker(goals, sendGoalEvent);\n        watchLocation(locationWatcherInterval, refreshGoalTracker);\n      }\n      readyCallback();\n    })\n    .catch((err) => {\n      clientVars.emitter.maybeReportError(\n        new common.errors.LDUnexpectedResponseError('Error fetching goals: ' + (err && err.message) ? err.message : err)\n      );\n      readyCallback();\n    });\n\n  return ret;\n}\n","import * as common from 'launchdarkly-js-sdk-common';\nimport * as importBasicLogger from './basicLogger';\nimport browserPlatform from './browserPlatform';\nimport GoalManager from './GoalManager';\n\nconst goalsEvent = 'goalsReady';\nconst extraOptionDefs = {\n  fetchGoals: { default: true },\n  hash: { type: 'string' },\n  eventProcessor: { type: 'object' }, // used only in tests\n  eventUrlTransformer: { type: 'function' },\n  disableSyncEventPost: { default: false },\n};\n\n// Pass our platform object to the common code to create the browser version of the client\nexport function initialize(env, user, options = {}) {\n  const platform = browserPlatform(options);\n  const clientVars = common.initialize(env, user, options, platform, extraOptionDefs);\n\n  const client = clientVars.client;\n  const validatedOptions = clientVars.options;\n  const emitter = clientVars.emitter;\n\n  const goalsPromise = new Promise((resolve) => {\n    const onGoals = emitter.on(goalsEvent, () => {\n      emitter.off(goalsEvent, onGoals);\n      resolve();\n    });\n  });\n  client.waitUntilGoalsReady = () => goalsPromise;\n\n  if (validatedOptions.fetchGoals) {\n    GoalManager(clientVars, () => emitter.emit(goalsEvent));\n    // Don't need to save a reference to the GoalManager - its constructor takes care of setting\n    // up the necessary event wiring\n  } else {\n    emitter.emit(goalsEvent);\n  }\n\n  if (document.readyState !== 'complete') {\n    window.addEventListener('load', clientVars.start);\n  } else {\n    clientVars.start();\n  }\n\n  const syncFlush = () => {\n    // Synchronous events are not available in all browsers, but where they\n    // are we should attempt to use them. This increases the chance of the events\n    // being delivered.\n    platform.synchronousFlush = true;\n    client.flush().catch(() => {});\n    platform.synchronousFlush = false;\n  };\n\n  // When the visibility of the page changes to hidden we want to flush any pending events.\n  //\n  // This is handled with visibility, instead of beforeunload/unload\n  // because those events are not compatible with the bfcache and are unlikely\n  // to be called in many situations. For more information see: https://developer.chrome.com/blog/page-lifecycle-api/\n  //\n  // Redundancy is included by using both the visibilitychange handler as well as\n  // pagehide, because different browsers, and versions have different bugs with each.\n  // This also may provide more opportunity for the events to get flushed.\n  //\n  const handleVisibilityChange = () => {\n    if (document.visibilityState === 'hidden') {\n      syncFlush();\n    }\n  };\n\n  document.addEventListener('visibilitychange', handleVisibilityChange);\n  window.addEventListener('pagehide', syncFlush);\n\n  return client;\n}\n\nexport const basicLogger = importBasicLogger.basicLogger;\n\nexport const createConsoleLogger = common.createConsoleLogger;\n\nexport const version = VERSION;\n\nfunction deprecatedInitialize(env, user, options = {}) {\n  console && console.warn && console.warn(common.messages.deprecated('default export', 'named LDClient export')); // eslint-disable-line no-console\n  return initialize(env, user, options);\n}\n\nexport default { initialize: deprecatedInitialize, version };\n","import newHttpRequest from './httpRequest';\n\nexport default function makeBrowserPlatform(options) {\n  const ret = {\n    userAgentHeaderName: 'X-LaunchDarkly-User-Agent',\n  };\n\n  ret.synchronousFlush = false; // this will be set to true by index.js if the page is hidden\n\n  // XMLHttpRequest may not exist if we're running in a server-side rendering context\n  if (window.XMLHttpRequest) {\n    const disableSyncFlush = options && options.disableSyncEventPost;\n    ret.httpRequest = (method, url, headers, body) => {\n      const syncFlush = ret.synchronousFlush & !disableSyncFlush;\n      ret.synchronousFlush = false;\n      return newHttpRequest(method, url, headers, body, syncFlush);\n    };\n  }\n\n  let hasCors;\n  ret.httpAllowsPost = () => {\n    // We compute this lazily because calling XMLHttpRequest() at initialization time can disrupt tests\n    if (hasCors === undefined) {\n      hasCors = window.XMLHttpRequest ? 'withCredentials' in new window.XMLHttpRequest() : false;\n    }\n    return hasCors;\n  };\n\n  // Image-based mechanism for sending events if POST isn't available\n  ret.httpFallbackPing = (url) => {\n    const img = new window.Image();\n    img.src = url;\n  };\n\n  const eventUrlTransformer = options && options.eventUrlTransformer;\n  ret.getCurrentUrl = () => (eventUrlTransformer ? eventUrlTransformer(window.location.href) : window.location.href);\n\n  ret.isDoNotTrack = () => {\n    let flag;\n    if (window.navigator && window.navigator.doNotTrack !== undefined) {\n      flag = window.navigator.doNotTrack; // FF, Chrome\n    } else if (window.navigator && window.navigator.msDoNotTrack !== undefined) {\n      flag = window.navigator.msDoNotTrack; // IE 9/10\n    } else {\n      flag = window.doNotTrack; // IE 11+, Safari\n    }\n    return flag === 1 || flag === true || flag === '1' || flag === 'yes';\n  };\n\n  try {\n    if (window.localStorage) {\n      ret.localStorage = {\n        get: (key) =>\n          new Promise((resolve) => {\n            resolve(window.localStorage.getItem(key));\n          }),\n        set: (key, value) =>\n          new Promise((resolve) => {\n            window.localStorage.setItem(key, value);\n            resolve();\n          }),\n        clear: (key) =>\n          new Promise((resolve) => {\n            window.localStorage.removeItem(key);\n            resolve();\n          }),\n      };\n    }\n  } catch (e) {\n    // In some browsers (such as Chrome), even looking at window.localStorage at all will cause a\n    // security error if the feature is disabled.\n    ret.localStorage = null;\n  }\n\n  // The browser built-in EventSource implementations do not support setting the method used for\n  // the request. When useReport is true, we ensure sending the user in the body of a REPORT request\n  // rather than in the URL path. If a polyfill for EventSource that supports setting the request\n  // method is provided (currently, launchdarkly-eventsource is the only polyfill that both supports\n  // it and gives us a way to *know* that it supports it), we use the polyfill to connect to a flag\n  // stream that will provide evaluated flags for the specific user. Otherwise, when useReport is\n  // true, we fall back to a generic  'ping' stream that informs the SDK to make a separate REPORT\n  // request for the user's flag evaluations whenever the flag definitions have been updated.\n  let eventSourceConstructor;\n  const useReport = options && options.useReport;\n  if (\n    useReport &&\n    typeof window.EventSourcePolyfill === 'function' &&\n    window.EventSourcePolyfill.supportedOptions &&\n    window.EventSourcePolyfill.supportedOptions.method\n  ) {\n    ret.eventSourceAllowsReport = true;\n    eventSourceConstructor = window.EventSourcePolyfill;\n  } else {\n    ret.eventSourceAllowsReport = false;\n    eventSourceConstructor = window.EventSource;\n  }\n\n  // If EventSource does not exist, the absence of eventSourceFactory will make us not try to open streams\n  if (window.EventSource) {\n    const timeoutMillis = 300000; // this is only used by polyfills - see below\n\n    ret.eventSourceFactory = (url, options) => {\n      // The standard EventSource constructor doesn't take any options, just a URL. However, some\n      // EventSource polyfills allow us to specify a timeout interval, and in some cases they will\n      // default to a too-short timeout if we don't specify one. So, here, we are setting the\n      // timeout properties that are used by several popular polyfills.\n      // Also, the skipDefaultHeaders property (if supported) tells the polyfill not to add the\n      // Cache-Control header that can cause CORS problems in browsers.\n      // See: https://github.com/launchdarkly/js-eventsource\n      const defaultOptions = {\n        heartbeatTimeout: timeoutMillis,\n        silentTimeout: timeoutMillis,\n        skipDefaultHeaders: true,\n      };\n\n      const esOptions = { ...defaultOptions, ...options };\n\n      return new eventSourceConstructor(url, esOptions);\n    };\n\n    ret.eventSourceIsActive = (es) =>\n      es.readyState === window.EventSource.OPEN || es.readyState === window.EventSource.CONNECTING;\n  }\n\n  ret.userAgent = 'JSClient';\n  ret.version = VERSION;\n\n  ret.diagnosticSdkData = {\n    name: 'js-client-sdk',\n    version: VERSION,\n  };\n\n  ret.diagnosticPlatformData = {\n    name: 'JS',\n  };\n\n  ret.diagnosticUseCombinedEvent = true; // the browser SDK uses the \"diagnostic-combined\" event format\n\n  return ret;\n}\n","const DEFAULT_SCRIPT_ID = 'reactjs-heap';\n\n/**\n * Provides the Heap script to inject.\n */\nconst getHeapScript = (id: string | number) => `\n  window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=document.createElement(\"script\");r.type=\"text/javascript\",r.async=!0,r.src=\"https://cdn.heapanalytics.com/js/heap-\"+e+\".js\";var a=document.getElementsByTagName(\"script\")[0];a.parentNode.insertBefore(r,a);for(var n=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=[\"addEventProperties\",\"addUserProperties\",\"clearEventProperties\",\"identify\",\"resetIdentity\",\"removeEventProperty\",\"setEventProperties\",\"track\",\"unsetEventProperty\"],o=0;o<p.length;o++)heap[p[o]]=n(p[o])};\n  heap.load(\"${id}\");\n`;\n\n/**\n * Initializes Heap tracking.\n */\nconst initialize = (id: string | number) => {\n  if (!id) {\n    throw new Error('You need to provide your Heap Analytics ID.');\n  }\n\n  if (!document) {\n    return;\n  }\n\n  const hasScript = !!document.getElementById(DEFAULT_SCRIPT_ID);\n\n  if (hasScript) {\n    return;\n  }\n\n  const script = document.createElement('script');\n\n  script.innerHTML = getHeapScript(id);\n  script.id = DEFAULT_SCRIPT_ID;\n  script.async = true;\n\n  document.body.appendChild(script);\n};\n\n/**\n * Object for manipulating Heap Analytics.\n */\nconst ReactHeap = {\n  initialize,\n};\n\nexport default ReactHeap;\n"],"names":["createCustomError","name","CustomError","message","code","Error","captureStackTrace","this","constructor","prototype","LDUnexpectedResponseError","LDInvalidEnvironmentIdError","LDInvalidUserError","LDInvalidEventKeyError","LDInvalidArgumentError","LDFlagFetchError","errors","LDInvalidDataError","LDTimeoutError","isHttpErrorRecoverable","status","byteLength_1","b64","lens","getLens","validLen","placeHoldersLen","toByteArray_1","tmp","i","arr","Arr","_byteLength","curByte","len","revLookup","charCodeAt","fromByteArray_1","uint8","length","extraBytes","parts","maxChunkLength","len2","push","encodeChunk","lookup","join","Uint8Array","Array","indexOf","start","end","num","output","isArray","keyList","Object","keys","hasProp","hasOwnProperty","fastDeepEqual","equal","a","b","key","arrA","arrB","dateA","Date","dateB","getTime","regexpA","RegExp","regexpB","toString","call","userAttrsToStringify","btoa","s","escaped","unescape","encodeURIComponent","base64","fromByteArray","stringToBytes","objectHasOwnProperty","object","getRandomValues","utils","appendUrlPath","baseUrl","path","endsWith","substring","startsWith","base64URLEncode","replace","clone","obj","JSON","parse","stringify","deepEquals","extend","objects","reduce","acc","getLDUserAgentString","platform","version","userAgent","onNextTick","cb","setTimeout","sanitizeContext","context","newContext","kind","undefined","forEach","attr","value","String","transformValuesToVersionedValues","flags","ret","transformVersionedValuesToValues","flagsState","wrapPromiseCallback","promise","callback","then","error","Promise","reject","rnds8","rng","crypto","bind","msCrypto","REGEX","validate","uuid","test","_nodeId","_clockseq","byteToHex","substr","offset","arguments","toLowerCase","TypeError","_lastMSecs","_lastNSecs","v","parseInt","slice","v35","hashfunc","generateUUID","namespace","buf","str","bytes","set","err","DNS","URL","getOutputLength","inputLength8","safeAdd","x","y","lsw","md5cmn","q","t","cnt","md5ff","c","d","md5gg","md5hh","md5ii","v3","msg","input","length32","hexTab","hex","charAt","md5ToHexEncodedArray","olda","oldb","oldc","oldd","wordsToMd5","length8","Uint32Array","bytesToWords","v3$1","f","z","ROTL","n","v5","K","H","l","N","Math","ceil","M","_i","j","pow","floor","_i2","W","_t","e","_t2","T","v5$1","options","node","clockseq","seedBytes","random","msecs","now","nsecs","dt","tl","tmh","rnds","logLevels","loggers","commonBasicLogger","formatFn","destination","toConsole","methodName","line","console","destinations","prependLevelToMessage","prefix","minLevel","level","write","levelIndex","levelName","args","fullPrefix","tempArgs","log","logger","validateLogger","errorString","docLink","messages","bootstrapInvalid","bootstrapOldFormat","clientInitialized","clientNotReady","debugEnqueueingEvent","debugPostingDiagnosticEvent","event","debugPostingEvents","count","debugStreamDelete","debugStreamDeleteIgnored","debugStreamPatch","debugStreamPatchIgnored","debugStreamPing","debugPolling","url","debugStreamPut","deprecated","oldName","newName","environmentNotFound","environmentNotSpecified","errorFetchingFlags","eventCapacityExceeded","eventWithoutContext","httpErrorMessage","retryMessage","httpUnavailable","identifyDisabled","inspectorMethodError","type","invalidContentType","contentType","invalidData","invalidInspector","invalidKey","invalidMetricValue","badType","invalidContext","invalidTagValue","localStorageUnavailable","networkError","optionBelowMinimum","minimum","streamClosing","streamConnecting","streamError","streamReconnectDelay","tagValueTooLong","unknownCustomEventKey","unknownOption","contextNotSpecified","unrecoverableStreamError","wrongOptionType","expectedType","actualType","wrongOptionTypeBoolean","require$$0","baseOptionDefs","default","streamUrl","eventsUrl","sendEvents","streaming","sendLDHeaders","requestHeaderTransform","sendEventsOnlyForVariation","useReport","evaluationReasons","eventCapacity","flushInterval","samplingInterval","allAttributesPrivate","privateAttributes","bootstrap","diagnosticRecordingInterval","diagnosticOptOut","wrapperName","wrapperVersion","stateProvider","application","validator","validated","id","validateTagValue","inspectors","allowedTagCharacters","canonicalizeUrl","tagValue","match","warn","configuration","emitter","extraOptionDefs","optionDefs","deprecatedOptions","reportArgumentError","maybeReportError","config","opts","checkDeprecatedOptions","applyDefaults","typeDescForValue","optionDef","allowedTypes","split","validateTypesAndNames","getTags","tags","headers","getLDHeaders","h","userAgentHeaderName","tagKeys","sort","map","flattened","item","concat","transformHeaders","v1","uuidv1","require$$1","EventSender_1","environmentId","baseHeaders","sender","events","isDiagnostic","httpRequest","resolve","jsonBody","payloadId","doPostRequest","canRetry","result","dateStr","header","time","serverTime","getResponseInfo","catch","validKind","encodeKey","includes","checkContext","allowLegacyKey","kindValid","keyValid","kinds","filter","every","contextKey","getContextKeys","user","entries","getContextKinds","getCanonicalKey","EventSummarizer_1","es","startDate","endDate","counters","contextKinds","summarizeEvent","counterKey","variation","counterVal","Set","contextKeys","getKinds","add","creationDate","getSummary","flagsOut","empty","values","flag","counterOut","unknown","features","clearSummary","processEscapeCharacters","getComponents","reference","component","isLiteral","compare","aIsLiteral","bIsLiteral","bComponents","aComponents","literalToReference","literal","attributeReference","cloneExcluding","target","references","stack","cloned","excluded","ptr","source","parent","visited","pop","some","ContextFilter_1","protectedAttributes","legacyTopLevelCopyAttributes","filterSingleKind","redactAnonymous","AttributeReference","anonymous","_meta","protectedAttr","getAttributesToFilter","redactedAttributes","filtered","custom","privateAttributeNames","legacyToSingleKind","filteredContext","filterMultiKind","EventProcessor_1","diagnosticsAccumulator","processor","eventSender","EventSender","mainEventsUrl","summarizer","EventSummarizer","contextFilter","ContextFilter","flushTimer","queue","lastKnownPastTime","disabled","exceededCapacity","shouldSampleEvent","makeOutputEvent","addToOutbox","incrementDroppedEvents","enqueue","addFullEvent","addDebugEvent","trackEvents","debugEventsUntilDate","debugEvent","flush","eventsToSend","summary","setEventsInLastBatch","debug","responseInfo","flushTick","stop","clearTimeout","EventEmitter_1","on","handler","off","emit","copiedHandlers","apply","getEvents","getEventListenerCount","readyEvent","successEvent","failureEvent","InitializationState","eventEmitter","succeeded","failed","failureValue","initializationPromise","readyPromise","onReady","getInitializationPromise","onSuccess","onFailure","getReadyPromise","signalSuccess","signalFailure","PersistentFlagStore_1","storage","environment","hash","ident","store","getFlagsKey","getContext","loadFlags","get","dataStr","data","schema","$schema","ex","clearFlags","saveFlags","clear","PersistentStorage_1","localStorageProvider","loggedError","logError","isEnabled","require$$2","Stream_1","stream","evalUrlPrefix","withReasons","baseReconnectDelay","connectionAttemptStartTime","firstConnectionErrorLogged","reconnectTimeoutReference","handlers","retryCount","getNextRetryDelay","delay","computedDelayMillis","backoff","trunc","handleError","closeConnection","logConnectionResult","tryConnect","openConnection","query","readTimeoutMillis","eventSourceFactory","eventSourceAllowsReport","method","body","info","addEventListener","onerror","onopen","close","success","recordStreamInit","connect","newHash","newHandlers","disconnect","isConnected","eventSourceIsActive","promiseCoalescer_1","finallyFn","currentPromise","currentCancelFn","finalResolve","finalReject","coalescer","p","cancelFn","resultPromise","jsonContentType","Requestor_1","requestor","activeRequests","fetchJSON","endpoint","promiseCoalescer","req","statusText","getResponseError","addPromise","cancel","fetchFlagSettings","Identity_1","initialContext","onChange","setContext","AnonymousContextProcessor_1","persistentStorage","getContextKeyIdString","processSingleKindContext","getCachedContextKey","cachedId","setCachedContextKey","processContext","processedContext","all","diagnosticEvents","DiagnosticId","sdkKey","diagnosticId","sdkKeySuffix","DiagnosticsAccumulator","startTime","dataSinceDate","droppedEvents","eventsInLastBatch","streamInits","reset","getProps","setProps","props","timestamp","durationMillis","DiagnosticsManager","accumulator","combinedMode","diagnosticUseCombinedEvent","localStorageKey","diagnosticEventsUrl","periodicInterval","eventSentTime","periodicTimer","streamingEnabled","manager","makeInitProperties","sdk","makeSdkData","makeConfigData","diagnosticPlatformData","sendDiagnosticEvent","sendPeriodicEvent","currentTime","createPeriodicEventAndReset","saveProperties","sdkData","diagnosticSdkData","customBaseURI","customStreamURI","customEventsURI","eventsCapacity","eventsFlushIntervalMillis","reconnectTimeMillis","streamingDisabled","diagnosticRecordingIntervalMillis","usingSecureMode","bootstrapMode","fetchGoalsDisabled","fetchGoals","loadProperties","localStorageAvailable","nextEventTime","timeNow","setStreaming","enabled","SafeInspector_1","inspector","errorLogged","wrapper","synchronous","InspectorTypes","flagUsed","flagDetailsChanged","flagDetailChanged","clientIdentityChanged","freeze","InspectorManager_1","InspectorManager","inspectorsByType","synchronousInspectorsByType","safeInspectors","SafeInspector","safeInspector","hasListeners","onFlagUsed","flagKey","detail","onFlags","onFlagChanged","onIdentityChanged","timedPromise_1","taskName","_res","changeEvent","internalChangeEvent","src","initialize","env","specifiedOptions","createLogger","EventEmitter","initializationStateTracker","InitializationStateTracker","inspectorManager","PersistentStorage","localStorage","diagnosticsEnabled","diagnostics","diagnosticsManager","Stream","eventProcessor","EventProcessor","Requestor","useLocalStorage","streamActive","subscribedToChangeEvents","streamForcedState","inited","closed","firstEvent","Identity","enqueueEvent","sendIdentifyEvent","anonymousContextProcessor","AnonymousContextProcessor","persistentFlagStore","PersistentFlagStore","isDoNotTrack","notifyInspectionFlagChanged","newFlag","getFlagDetail","notifyInspectionFlagsChanged","cur","sendFlagEvent","defaultValue","includeReason","variationIndex","flagVersion","trackReason","reason","verifyContext","variationDetailInternal","sendEvent","includeReasonInEvent","isAllFlags","deleted","errorKind","notifyInspectionFlagUsed","connectStream","tryParseData","jsonData","ping","contextAtTimeOfPingEvent","requestedFlags","replaceAllFlags","put","patch","oldFlag","mods","newDetail","previous","current","handleFlagChanges","delete","disconnectStream","newFlags","changes","changeEventParams","updateStreamingState","shouldBeStreaming","isChangeEventKey","toUpperCase","metadataKey","validKey","metadata","readFlagsFromBootstrap","state","getInitialState","initFromStateProvider","validatedContext","signalSuccessfulInit","storedFlags","signalFailedInit","finishInit","client","waitForInitialization","timeout","initPromise","timeoutPromise","timedPromise","race","waitForInitializationWithTimeout","waitUntilReady","identify","onDone","clearFirst","flagValueMap","variationDetail","track","metricValue","customEventFilter","getCurrentUrl","contextKind","haveListeners","newState","allFlags","results","finishClose","getFlagsInternal","getEnvironmentId","internalChangeEventName","_objectSpread","emptyResult","newHttpRequest","pageIsClosing","window","navigator","chromeMatch","isSyncXhrSupported","xhr","XMLHttpRequest","open","setRequestHeader","send","cancelled","getResponseHeader","responseText","abort","escapeStringRegexp","string","doesUrlMatch","matcher","href","search","regex","testUrl","canonicalUrl","pattern","GoalTracker","goals","onEvent","tracker","listenerFn","clickGoals","goal","urls","location","matches","selector","elements","document","querySelectorAll","parentNode","findGoalsForClick","dispose","removeEventListener","locationWatcherInterval","GoalManager","clientVars","readyCallback","goalTracker","refreshGoalTracker","sendGoalEvent","g","interval","currentUrl","previousUrl","checkUrl","poll","fn","history","pushState","watchLocation","common","goalsEvent","eventUrlTransformer","disableSyncEventPost","hasCors","disableSyncFlush","syncFlush","synchronousFlush","httpAllowsPost","httpFallbackPing","Image","eventSourceConstructor","doNotTrack","msDoNotTrack","getItem","setItem","removeItem","EventSourcePolyfill","supportedOptions","EventSource","timeoutMillis","esOptions","defaultOptions","heartbeatTimeout","silentTimeout","skipDefaultHeaders","readyState","OPEN","CONNECTING","browserPlatform","validatedOptions","goalsPromise","onGoals","waitUntilGoalsReady","visibilityState","basicLogger","importBasicLogger","createConsoleLogger","index"],"sourceRoot":""}